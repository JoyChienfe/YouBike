import{K as De,Q as S,b5 as et,b6 as tt,bN as at,b8 as lt,I as nt,G as he,M as it,O as Be,al as ot,aB as st,r as w,Y as rt,am as ut,aC as L,z as te,ao as dt,T as ct,bO as ft,f as z,a3 as ge,aJ as be,ap as ye,aq as we,bP as _e,bQ as mt,ab as H,ac as vt,_ as Me,i as G,o as Y,c as J,b as o,d as r,L as ve,w as p,bh as Ce,e as f,N as Ne,bR as $e,h as W,j as O,F as ae,s as ke,t as Se,k as le,y as pt,u as ht,P as gt,b3 as bt,x as yt,bS as wt,bT as _t}from"./index-51f79bed.js";import{A as Re}from"./AlertCircle-82fe316e.js";import{a as Ee,N as F}from"./FormItem-6e0d57eb.js";import{N as Te}from"./Modal-eb29b06a.js";import{N as xt}from"./DataTable-69ff6a12.js";import"./Warning-ae8d3e19.js";import"./get-slot-1efb97e5.js";const Vt=De({name:"Remove",render(){return S("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},S("line",{x1:"400",y1:"256",x2:"112",y2:"256",style:`
        fill: none;
        stroke: currentColor;
        stroke-linecap: round;
        stroke-linejoin: round;
        stroke-width: 32px;
      `}))}}),It=e=>{const{textColorDisabled:v}=e;return{iconColorDisabled:v}},Dt=et({name:"InputNumber",common:tt,peers:{Button:at,Input:lt},self:It}),Bt=Dt;function Mt(e){return e==null||typeof e=="string"&&e.trim()===""?null:Number(e)}function Ct(e){return e.includes(".")&&(/^(-)?\d+.*(\.|0)$/.test(e)||/^\.\d+$/.test(e))}function fe(e){return e==null?!0:!Number.isNaN(e)}function xe(e,v){return e==null?"":v===void 0?String(e):e.toFixed(v)}function me(e){if(e===null)return null;if(typeof e=="number")return e;{const v=Number(e);return Number.isNaN(v)?null:v}}const Nt=nt([he("input-number-suffix",`
 display: inline-block;
 margin-right: 10px;
 `),he("input-number-prefix",`
 display: inline-block;
 margin-left: 10px;
 `)]),Ve=800,Ie=100,$t=Object.assign(Object.assign({},Be.props),{autofocus:Boolean,loading:{type:Boolean,default:void 0},placeholder:String,defaultValue:{type:Number,default:null},value:Number,step:{type:[Number,String],default:1},min:[Number,String],max:[Number,String],size:String,disabled:{type:Boolean,default:void 0},validator:Function,bordered:{type:Boolean,default:void 0},showButton:{type:Boolean,default:!0},buttonPlacement:{type:String,default:"right"},readonly:Boolean,clearable:Boolean,keyboard:{type:Object,default:{}},updateValueOnInput:{type:Boolean,default:!0},parse:Function,format:Function,precision:Number,status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onFocus:[Function,Array],onBlur:[Function,Array],onClear:[Function,Array],onChange:[Function,Array]}),Ae=De({name:"InputNumber",props:$t,setup(e){const{mergedBorderedRef:v,mergedClsPrefixRef:c,mergedRtlRef:h}=it(e),g=Be("InputNumber","-input-number",Nt,Bt,e,c),{localeRef:a}=ot("InputNumber"),k=st(e),{mergedSizeRef:B,mergedDisabledRef:N,mergedStatusRef:R}=k,x=w(null),M=w(null),$=w(null),I=w(e.defaultValue),P=rt(e,"value"),C=ut(P,I),D=w(""),y=t=>{const n=String(t).split(".")[1];return n?n.length:0},d=t=>{const n=[e.min,e.max,e.step,t].map(m=>m===void 0?0:y(m));return Math.max(...n)},u=L(()=>{const{placeholder:t}=e;return t!==void 0?t:a.value.placeholder}),i=L(()=>{const t=me(e.step);return t!==null?t===0?1:Math.abs(t):1}),l=L(()=>{const t=me(e.min);return t!==null?t:null}),s=L(()=>{const t=me(e.max);return t!==null?t:null}),b=t=>{const{value:n}=C;if(t===n){E();return}const{"onUpdate:value":m,onUpdateValue:_,onChange:T}=e,{nTriggerFormInput:A,nTriggerFormChange:j}=k;T&&H(T,t),_&&H(_,t),m&&H(m,t),I.value=t,A(),j()},V=({offset:t,doUpdateIfValid:n,fixPrecision:m,isInputing:_})=>{const{value:T}=D;if(_&&Ct(T))return!1;const A=(e.parse||Mt)(T);if(A===null)return n&&b(null),null;if(fe(A)){const j=y(A),{precision:Q}=e;if(Q!==void 0&&Q<j&&!m)return!1;let U=parseFloat((A+t).toFixed(Q??d(A)));if(fe(U)){const{value:de}=s,{value:ce}=l;if(de!==null&&U>de){if(!n||_)return!1;U=de}if(ce!==null&&U<ce){if(!n||_)return!1;U=ce}return e.validator&&!e.validator(U)?!1:(n&&b(U),U)}}return!1},E=()=>{const{value:t}=C;if(fe(t)){const{format:n,precision:m}=e;n?D.value=n(t):t===null||m===void 0||y(t)>m?D.value=xe(t,void 0):D.value=xe(t,m)}else D.value=String(t)};E();const X=L(()=>V({offset:0,doUpdateIfValid:!1,isInputing:!1,fixPrecision:!1})===!1),ne=L(()=>{const{value:t}=C;if(e.validator&&t===null)return!1;const{value:n}=i;return V({offset:-n,doUpdateIfValid:!1,isInputing:!1,fixPrecision:!1})!==!1}),ie=L(()=>{const{value:t}=C;if(e.validator&&t===null)return!1;const{value:n}=i;return V({offset:+n,doUpdateIfValid:!1,isInputing:!1,fixPrecision:!1})!==!1});function Fe(t){const{onFocus:n}=e,{nTriggerFormFocus:m}=k;n&&H(n,t),m()}function Pe(t){var n,m;if(t.target===((n=x.value)===null||n===void 0?void 0:n.wrapperElRef))return;const _=V({offset:0,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0});if(_!==!1){const j=(m=x.value)===null||m===void 0?void 0:m.inputElRef;j&&(j.value=String(_||"")),C.value===_&&E()}else E();const{onBlur:T}=e,{nTriggerFormBlur:A}=k;T&&H(T,t),A(),vt(()=>{E()})}function Le(t){const{onClear:n}=e;n&&H(n,t)}function oe(){const{value:t}=ie;if(!t){ue();return}const{value:n}=C;if(n===null)e.validator||b(pe());else{const{value:m}=i;V({offset:m,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})}}function se(){const{value:t}=ne;if(!t){re();return}const{value:n}=C;if(n===null)e.validator||b(pe());else{const{value:m}=i;V({offset:-m,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})}}const ze=Fe,je=Pe;function pe(){if(e.validator)return null;const{value:t}=l,{value:n}=s;return t!==null?Math.max(0,t):n!==null?Math.min(0,n):0}function He(t){Le(t),b(null)}function Ye(t){var n,m,_;!((n=$.value)===null||n===void 0)&&n.$el.contains(t.target)&&t.preventDefault(),!((m=M.value)===null||m===void 0)&&m.$el.contains(t.target)&&t.preventDefault(),(_=x.value)===null||_===void 0||_.activate()}let q=null,K=null,Z=null;function re(){Z&&(window.clearTimeout(Z),Z=null),q&&(window.clearInterval(q),q=null)}function ue(){ee&&(window.clearTimeout(ee),ee=null),K&&(window.clearInterval(K),K=null)}function Ge(){re(),Z=window.setTimeout(()=>{q=window.setInterval(()=>{se()},Ie)},Ve),be("mouseup",document,re,{once:!0})}let ee=null;function We(){ue(),ee=window.setTimeout(()=>{K=window.setInterval(()=>{oe()},Ie)},Ve),be("mouseup",document,ue,{once:!0})}const qe=()=>{K||oe()},Ke=()=>{q||se()};function Qe(t){var n,m;if(t.key==="Enter"){if(t.target===((n=x.value)===null||n===void 0?void 0:n.wrapperElRef))return;V({offset:0,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})!==!1&&((m=x.value)===null||m===void 0||m.deactivate())}else if(t.key==="ArrowUp"){if(!ie.value||e.keyboard.ArrowUp===!1)return;t.preventDefault(),V({offset:0,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})!==!1&&oe()}else if(t.key==="ArrowDown"){if(!ne.value||e.keyboard.ArrowDown===!1)return;t.preventDefault(),V({offset:0,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})!==!1&&se()}}function Je(t){D.value=t,e.updateValueOnInput&&!e.format&&!e.parse&&e.precision===void 0&&V({offset:0,doUpdateIfValid:!0,isInputing:!0,fixPrecision:!1})}te(C,()=>{E()});const Xe={focus:()=>{var t;return(t=x.value)===null||t===void 0?void 0:t.focus()},blur:()=>{var t;return(t=x.value)===null||t===void 0?void 0:t.blur()}},Ze=dt("InputNumber",h,c);return Object.assign(Object.assign({},Xe),{rtlEnabled:Ze,inputInstRef:x,minusButtonInstRef:M,addButtonInstRef:$,mergedClsPrefix:c,mergedBordered:v,uncontrolledValue:I,mergedValue:C,mergedPlaceholder:u,displayedValueInvalid:X,mergedSize:B,mergedDisabled:N,displayedValue:D,addable:ie,minusable:ne,mergedStatus:R,handleFocus:ze,handleBlur:je,handleClear:He,handleMouseDown:Ye,handleAddClick:qe,handleMinusClick:Ke,handleAddMousedown:We,handleMinusMousedown:Ge,handleKeyDown:Qe,handleUpdateDisplayedValue:Je,mergedTheme:g,inputThemeOverrides:{paddingSmall:"0 8px 0 10px",paddingMedium:"0 8px 0 12px",paddingLarge:"0 8px 0 14px"},buttonThemeOverrides:ct(()=>{const{self:{iconColorDisabled:t}}=g.value,[n,m,_,T]=ft(t);return{textColorTextDisabled:`rgb(${n}, ${m}, ${_})`,opacityDisabled:`${T}`}})})},render(){const{mergedClsPrefix:e,$slots:v}=this,c=()=>S(_e,{text:!0,disabled:!this.minusable||this.mergedDisabled||this.readonly,focusable:!1,theme:this.mergedTheme.peers.Button,themeOverrides:this.mergedTheme.peerOverrides.Button,builtinThemeOverrides:this.buttonThemeOverrides,onClick:this.handleMinusClick,onMousedown:this.handleMinusMousedown,ref:"minusButtonInstRef"},{icon:()=>ye(v["minus-icon"],()=>[S(we,{clsPrefix:e},{default:()=>S(Vt,null)})])}),h=()=>S(_e,{text:!0,disabled:!this.addable||this.mergedDisabled||this.readonly,focusable:!1,theme:this.mergedTheme.peers.Button,themeOverrides:this.mergedTheme.peerOverrides.Button,builtinThemeOverrides:this.buttonThemeOverrides,onClick:this.handleAddClick,onMousedown:this.handleAddMousedown,ref:"addButtonInstRef"},{icon:()=>ye(v["add-icon"],()=>[S(we,{clsPrefix:e},{default:()=>S(mt,null)})])});return S("div",{class:[`${e}-input-number`,this.rtlEnabled&&`${e}-input-number--rtl`]},S(z,{ref:"inputInstRef",autofocus:this.autofocus,status:this.mergedStatus,bordered:this.mergedBordered,loading:this.loading,value:this.displayedValue,onUpdateValue:this.handleUpdateDisplayedValue,theme:this.mergedTheme.peers.Input,themeOverrides:this.mergedTheme.peerOverrides.Input,builtinThemeOverrides:this.inputThemeOverrides,size:this.mergedSize,placeholder:this.mergedPlaceholder,disabled:this.mergedDisabled,readonly:this.readonly,textDecoration:this.displayedValueInvalid?"line-through":void 0,onFocus:this.handleFocus,onBlur:this.handleBlur,onKeydown:this.handleKeyDown,onMousedown:this.handleMouseDown,onClear:this.handleClear,clearable:this.clearable,internalLoadingBeforeSuffix:!0},{prefix:()=>{var g;return this.showButton&&this.buttonPlacement==="both"?[c(),ge(v.prefix,a=>a?S("span",{class:`${e}-input-number-prefix`},a):null)]:(g=v.prefix)===null||g===void 0?void 0:g.call(v)},suffix:()=>{var g;return this.showButton?[ge(v.suffix,a=>a?S("span",{class:`${e}-input-number-suffix`},a):null),this.buttonPlacement==="right"?c():null,h()]:(g=v.suffix)===null||g===void 0?void 0:g.call(v)}}))}});const Oe=e=>(ke("data-v-45405a0f"),e=e(),Se(),e),kt={class:"fw-bold"},St=Oe(()=>f("div",{class:"row fs-4 mb-3"},[f("div",{class:"col"},"新增狀態")],-1)),Rt={class:"row"},Et={class:"col-6"},Tt={class:"col-6"},At=Oe(()=>f("span",{style:{"font-weight":"700"}},[O("未保養狀態 => 天"),f("br"),O("其他 => 分鐘")],-1)),Ot={class:"row"},Ut={class:"col-12 mb-3"},Ft={class:"col-12"},Pt={class:"row"},Lt={class:"col text-center"},zt={__name:"AddComponent",props:{Modal:{type:Boolean},title:{type:String},city:{type:String}},emits:["closeAddModal","submit"],setup(e,{emit:v}){const c=e,h=G("$swal");async function g(y){h({icon:"success",title:`${y}`,showConfirmButton:!1})}const a=w({time:null,textareaValue:null}),k={time:{validator(y,d){return d===null?new Error("分鐘/天 不能為空"):d<=0?new Error("分鐘/天 必須大於0"):!0},type:"number",trigger:["blur","input"]},textareaValue:{required:!0,validator(y,d){if(!d)return new Error("電子郵件不能為空");let u=!0,i=null;return d.split(`
`).forEach((s,b)=>{(s.charAt(s.length-1)!==","||s.indexOf("@")===-1)&&(i=b,u=!1)}),u?!0:new Error(`第${i+1}行格式錯誤`)},trigger:["blur","input"]}},B=w(!1);async function N(y){try{B.value=!0;const d="https://report.youbike.com.tw/mail/status";await le.post(d,y)}catch{throw new Error("新增狀態失敗")}finally{B.value=!1}}function R(){return{city:c.city,title:c.title,time:a.value.time,textareaValue:a.value.textareaValue.split(",").filter(d=>d).map(d=>d.replace(/\n/g,""))}}async function x(){try{return await $.value.validate(),"驗證成功"}catch{throw new Error("驗證失敗")}}const M=G("getData"),$=w(null);async function I(){try{await x();const y=R();await N(y),g("新增成功"),await M(),D()}catch(y){console.log(y)}}function P(){const i=a.value.textareaValue.split(`
`).map(l=>l.trim()).join(`
`);a.value.textareaValue=i}function C(){a.value.time=null,a.value.textareaValue=null}function D(){C(),v("closeAddModal")}return(y,d)=>(Y(),J(ae,null,[o(r(ve),{active:B.value,"onUpdate:active":d[0]||(d[0]=u=>B.value=u),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),o(r(Te),{show:c.Modal,"onUpdate:show":d[5]||(d[5]=u=>c.Modal=u)},{default:p(()=>[o(r(Ce),{size:"medium",preset:"dialog"},{default:p(()=>[o(r(Ee),{ref_key:"formRef",ref:$,model:a.value,rules:k},{default:p(()=>[f("div",kt,[St,f("div",Rt,[f("div",Et,[o(r(F),{label:"系統:","label-style":"font-weight: 700; font-size:16px"},{default:p(()=>[o(r(z),{value:c.title,"onUpdate:value":d[1]||(d[1]=u=>c.title=u),disabled:!0},null,8,["value"])]),_:1})]),f("div",Tt,[o(r(F),{label:"城市:","label-style":"font-weight: 700; font-size:16px"},{default:p(()=>[o(r(z),{value:c.city,"onUpdate:value":d[2]||(d[2]=u=>c.city=u),disabled:!0},null,8,["value"])]),_:1})])]),o(r(Ne),{trigger:"hover"},{trigger:p(()=>[o(r($e),{size:"20",color:"#0e7a0d"},{default:p(()=>[o(r(Re))]),_:1})]),default:p(()=>[At]),_:1}),f("div",Ot,[f("div",Ut,[o(r(F),{path:"time",label:"分鐘 / 天","label-style":"font-weight: 700; font-size:16px",rules:"rules.time"},{default:p(()=>[o(r(Ae),{value:a.value.time,"onUpdate:value":d[3]||(d[3]=u=>a.value.time=u),placeholder:"請輸入數字","show-button":!1},null,8,["value"])]),_:1})]),f("div",Ft,[o(r(F),{path:"textareaValue",label:"Email","label-style":"font-weight: 700; font-size:16px",rules:"rules.textareaValue"},{default:p(()=>[o(r(z),{size:"large",value:a.value.textareaValue,"onUpdate:value":d[4]||(d[4]=u=>a.value.textareaValue=u),onChange:P,placeholder:`IloveYouBike@gmail.com,
YouLoveYouBike@gmail.com,
WeLoveYouBike@gmail.com,
`,type:"textarea"},null,8,["value"])]),_:1})])])]),f("div",Pt,[f("div",Lt,[o(r(W),{type:"info",class:"me-3",onClick:I},{default:p(()=>[O("新增")]),_:1}),o(r(W),{type:"error",onClick:D},{default:p(()=>[O("取消")]),_:1})])])]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])],64))}},jt=Me(zt,[["__scopeId","data-v-45405a0f"]]);const Ue=e=>(ke("data-v-44f6ef3b"),e=e(),Se(),e),Ht={class:"fw-bold"},Yt=Ue(()=>f("div",{class:"row fs-4 mb-3"},[f("div",{class:"col"},"編輯狀態")],-1)),Gt={class:"row"},Wt={class:"col-6"},qt={class:"col-6"},Kt=Ue(()=>f("span",{style:{"font-weight":"700"}},[O("未保養狀態 => 天"),f("br"),O("其他 => 分鐘")],-1)),Qt={class:"row"},Jt={class:"col-12 mb-3"},Xt={class:"col-12"},Zt={class:"row"},ea={class:"col text-center"},ta={__name:"editComponent",props:{Modal:{type:Boolean},editData:{type:Object}},emits:["closeEditModal","submit"],setup(e,{emit:v}){const c=e,h=G("$swal");async function g(u){h({icon:"success",title:`${u}`,showConfirmButton:!1})}const a=w({time:null,textareaValue:null}),k={time:{validator(u,i){return i===null?new Error("分鐘/天 不能為空"):i<=0?new Error("分鐘/天 必須大於0"):!0},type:"number",trigger:["blur","input"]},textareaValue:{required:!0,validator(u,i){if(!i)return new Error("電子郵件不能為空");let l=!0,s=null;return i.split(`
`).forEach((V,E)=>{(V.charAt(V.length-1)!==","||V.indexOf("@")===-1)&&(s=E,l=!1)}),l?!0:new Error(`第${s+1}行格式錯誤`)},trigger:["blur","input"]}},B=w(!1);async function N(u){try{B.value=!0;const i="https://report.youbike.com.tw/mail/status";console.log(u),await le.put(i,u)}catch{throw new Error("新增狀態失敗")}finally{B.value=!1}}function R(){return{newObj:{city:c.editData.city,title:c.editData.type,min:a.value.time,email:a.value.textareaValue.split(",").filter(i=>i).map(i=>i.replace(/\n/g,""))},oldData:d.value}}const x=w(null);async function M(){try{return await x.value.validate(),"驗證成功"}catch{throw new Error("驗證失敗")}}const $=G("getData");async function I(){try{await M();const u=R();await N(u),g("編輯成功"),await $(),D()}catch(u){console.log(u)}}function P(){const s=a.value.textareaValue.split(`
`).map(b=>b.trim()).join(`
`);a.value.textareaValue=s}function C(){a.value.time=null,a.value.textareaValue=null}function D(){C(),v("closeEditModal")}function y(u){let i="";return u.forEach((l,s)=>{console.log(l),s===u.length-1?i+=`${l},`:i+=`${l},
`}),i===","?null:i}const d=w();return te(()=>c.editData,()=>{d.value={city:c.editData.city,title:c.editData.type,min:parseInt(c.editData.min),mail:c.editData.mail},a.value.time=parseInt(c.editData.min),a.value.textareaValue=y(c.editData.mail)},{deep:!0}),(u,i)=>(Y(),J(ae,null,[o(r(ve),{active:B.value,"onUpdate:active":i[0]||(i[0]=l=>B.value=l),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),o(r(Te),{show:c.Modal,"onUpdate:show":i[5]||(i[5]=l=>c.Modal=l)},{default:p(()=>[o(r(Ce),{size:"medium",preset:"dialog"},{default:p(()=>[o(r(Ee),{ref_key:"formRef",ref:x,model:a.value,rules:k},{default:p(()=>[f("div",Ht,[Yt,f("div",Gt,[f("div",Wt,[o(r(F),{label:"系統:","label-style":"font-weight: 700; font-size:16px"},{default:p(()=>[o(r(z),{value:c.editData.type,"onUpdate:value":i[1]||(i[1]=l=>c.editData.type=l),disabled:!0},null,8,["value"])]),_:1})]),f("div",qt,[o(r(F),{label:"城市:","label-style":"font-weight: 700; font-size:16px"},{default:p(()=>[o(r(z),{value:c.editData.city,"onUpdate:value":i[2]||(i[2]=l=>c.editData.city=l),disabled:!0},null,8,["value"])]),_:1})])]),o(r(Ne),{trigger:"hover"},{trigger:p(()=>[o(r($e),{size:"20",color:"#0e7a0d"},{default:p(()=>[o(r(Re))]),_:1})]),default:p(()=>[Kt]),_:1}),f("div",Qt,[f("div",Jt,[o(r(F),{path:"time",label:"分鐘 / 天","label-style":"font-weight: 700; font-size:16px",rules:"rules.time"},{default:p(()=>[o(r(Ae),{value:a.value.time,"onUpdate:value":i[3]||(i[3]=l=>a.value.time=l),placeholder:"請輸入數字","show-button":!1},null,8,["value"])]),_:1})]),f("div",Xt,[o(r(F),{path:"textareaValue",label:"Email","label-style":"font-weight: 700; font-size:16px",rules:"rules.textareaValue"},{default:p(()=>[o(r(z),{size:"large",value:a.value.textareaValue,"onUpdate:value":i[4]||(i[4]=l=>a.value.textareaValue=l),onChange:P,placeholder:`IloveYouBike@gmail.com,
YouLoveYouBike@gmail.com,
WeLoveYouBike@gmail.com,
`,type:"textarea"},null,8,["value"])]),_:1})])])]),f("div",Zt,[f("div",ea,[o(r(W),{type:"info",class:"me-3",onClick:I},{default:p(()=>[O("更新")]),_:1}),o(r(W),{type:"error",onClick:D},{default:p(()=>[O("取消")]),_:1})])])]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])],64))}},aa=Me(ta,[["__scopeId","data-v-44f6ef3b"]]),la={class:"row"},na={class:"col-3 mb-3"},ia={class:"row mb-2"},oa={class:"col"},sa={class:"row pb-7"},ra={class:"col text-center"},ua={__name:"SendComponent",props:{maildata:{type:Array},city:{type:String}},setup(e){const v=e,c=G("getData"),h=G("$swal");async function g(l){(await h({title:"確定刪除嗎?",text:"刪除將不可復原",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"刪除",cancelButtonText:"取消"})).isConfirmed&&(await k(l),await c(),await h.fire({title:"刪除成功",icon:"success"}))}const a=w(!1);async function k(l){try{a.value=!0;const s=`https://report.youbike.com.tw/mail/status?city=${l.city}&time=${l.time}&type=${l.type}`;await le.delete(s)}catch{throw new Error("刪除狀態失敗")}finally{a.value=!1}}const B=[{label:"低電量狀態",value:"低電量狀態"},{label:"斷線狀態",value:"斷線狀態"},{label:"未保養狀態",value:"未保養狀態"}],N=w("低電量狀態"),R=w([]),x=[{title:"系統",key:"type",align:"center"},{title:"分鐘 / 天",key:"min",align:"center"},{title:"操作",key:"edit",align:"center",render(l){return l.btn.map(b=>S(W,{style:{marginRight:"6px"},type:`${b.color}`,bordered:!1,onClick:()=>b.name==="編輯"?y(l):M(l)},{default:()=>b.name}))}}];async function M(l){console.log(l);const s={type:l.type,time:parseInt(l.min),city:v.city};await g(s)}function $(){const l=[];v.maildata.forEach((s,b)=>{let V=!1;b!==0&&l.forEach((E,X)=>{E.type_name===s.type_name&&E.time===s.time&&(l[X].mail.push(s.mail),V=!0)}),V||l.push({city_name:s.city_name,type_name:s.type_name,time:s.time,mail:[s.mail]})}),R.value=[],l.sort((s,b)=>s.time-b.time).forEach(s=>{s.type_name===N.value&&R.value.push({type:s.type_name,min:s.time.toString(),btn:[{name:"編輯",color:"info"},{name:"刪除",color:"error"}],mail:s.mail})})}const I=w(!1);function P(){I.value=!0}function C(){I.value=!1}const D=w({});function y(l){u(),D.value={mail:l.mail,type:l.type,min:l.min,city:v.city}}const d=w(!1);function u(){d.value=!0}function i(){d.value=!1}return te([()=>N.value,()=>v.maildata],()=>{$()},{deep:!0}),$(),(l,s)=>(Y(),J(ae,null,[o(r(ve),{active:a.value,"onUpdate:active":s[0]||(s[0]=b=>a.value=b),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),f("div",la,[f("div",na,[o(r(pt),{value:N.value,"onUpdate:value":s[1]||(s[1]=b=>N.value=b),options:B,style:{"max-width":"200px"}},null,8,["value"])])]),f("div",ia,[f("div",oa,[o(r(xt),{class:"fw-bold",columns:x,data:R.value,pagination:{pageSize:100},"paginate-single-page":!1,size:"small"},null,8,["data"])])]),f("div",sa,[f("div",ra,[o(r(W),{type:"info",onClick:P},{default:p(()=>[O("+")]),_:1})])]),o(jt,{Modal:I.value,onCloseAddModal:C,title:N.value,city:e.city},null,8,["Modal","title","city"]),o(aa,{Modal:d.value,onCloseEditModal:i,editData:D.value},null,8,["Modal","editData"])],64))}},da={class:"contanier"},ca=f("div",{class:"row mx-0"},[f("h1",{class:"report-h1 fw-bold"},"異常通知")],-1),ya={__name:"SendmailView",setup(e){const v={"min-width":"80px","font-weight":"900"},h=ht().citys,g=w(null),a=w([]);let k=[];function B(){h.includes(2)&&a.value.push("台北市"),h.includes(3)&&a.value.push("新北市"),h.includes(4)&&a.value.push("桃園市"),h.includes(5)&&a.value.push("新竹市"),h.includes(6)&&a.value.push("新竹縣"),h.includes(20)&&a.value.push("竹科"),h.includes(7)&&a.value.push("苗栗縣"),h.includes(8)&&a.value.push("台中市"),h.includes(12)&&a.value.push("嘉義市"),h.includes(13)&&a.value.push("嘉義縣"),h.includes(14)&&a.value.push("台南市"),h.includes(15)&&a.value.push("高雄市"),h.includes(16)&&a.value.push("屏東縣")}gt("getData",N);async function N(){try{const M="https://report.youbike.com.tw/mail/mailcontent";k=(await le.get(M)).data.data,x()}catch(M){console.log(M)}}const R=w([]);function x(){R.value=k.filter(M=>M.city_name===g.value)}return te(g,()=>{x()}),(async()=>(B(),a.value.length!==0&&(g.value=a.value[0],await N())))(),(M,$)=>(Y(),J("div",da,[ca,o(r(_t),{value:g.value,"onUpdate:value":$[0]||($[0]=I=>g.value=I),type:"card","tab-style":v,size:"large"},{default:p(()=>[(Y(!0),J(ae,null,bt(a.value,I=>(Y(),yt(r(wt),{key:I,name:I},{default:p(()=>[o(ua,{maildata:R.value,city:g.value},null,8,["maildata","city"])]),_:2},1032,["name"]))),128))]),_:1},8,["value"])]))}};export{ya as default};
