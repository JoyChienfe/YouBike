import{i as E,r,o as m,c as M,b as h,d as o,e as l,l as U,v as P,n as j,x as b,m as q,L as A,q as O,k}from"./index-9c026bac.js";import{_ as R}from"./OutputExcel-850e7656.js";import{N as x}from"./DataTable-a8e5321a.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const F={class:"container-fluid px-0"},G=l("div",{class:"row mx-0"},[l("h1",{class:"report-h1 fw-bold"},"經營日報")],-1),H={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},I=l("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"類別:",-1),J={class:"col-md-auto px-0"},K=l("option",{selected:"",disabled:""},"請選擇",-1),Q=l("option",{value:"TurnoverData"},"上線周轉率排序",-1),W=l("option",{value:"TurnoverTaiwanData"},"實際周轉率排序(台灣)",-1),X=l("option",{value:"TotalData"},"詳細資訊(台灣)",-1),Y=[K,Q,W,X],Z={class:"row mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},ee={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},ie={__name:"OperateReport",setup(ae){const w=E("ischange"),B=E("$swal");async function D(a){B({icon:"error",title:`${a}`,showConfirmButton:!1})}const v="https://report.youbike.com.tw/isauth/gcpfun",c=r(!1),u=r(null),d=r("請選擇"),i=r(),n=r([]),s=r(null);let f=[],p="",_=[];const T=r([{key:"city",align:"center",fixed:"left",title:"城市"},{key:"num1",align:"center",title:"騎乘次數"},{key:"num2",align:"center",title:"周轉率"}]),z=r([{key:"city",align:"center",fixed:"left",title:"城市"},{key:"num1",align:"center",title:"實際營運車輛數"},{key:"num2",align:"center",title:"周轉率"}]),N=r([{key:"city",align:"center",fixed:"left",title:"城市"},{key:"num1",align:"center",title:"騎乘次數"},{key:"num2",align:"center",title:"場站數"},{key:"num3",align:"center",title:"上線車輛數"},{key:"num4",align:"center",title:"上線周轉率"},{key:"num5",align:"center",title:"月累計騎乘次數"}]),y=(a,t,e)=>{f=[],p="",_=[],f=[...a],p=e,t.forEach(g=>{_.push(g.title)})},C=a=>{const t=new Date(a),e=new Date,g=new Date(e.getTime()-24*60*60*1e3);return t<new Date("2023-01-01")||t>g},V=async()=>{try{const a={dataset_id:"founder_report",table_id:"daily_turnover_rank",date:i.value,city:["all"]};(await k.get(v,{params:a})).data.data.forEach(e=>{n.value.push({city:e.city,num1:e.rent_number,num2:e.turnover})}),y(n.value,T.value,"上線周轉率排序"),s.value.page&&s.value.page(1),c.value=!1}catch(a){console.log(a)}},S=async()=>{try{const a={dataset_id:"founder_report",table_id:"daily_turnover_rank_real",date:i.value,city:["all"]};(await k.get(v,{params:a})).data.data.forEach(e=>{n.value.push({city:e.city,num1:e.rent_number,num2:e.turnover})}),y(n.value,z.value,"實際周轉率排序(台灣)"),s.value.page&&s.value.page(1),c.value=!1}catch(a){console.log(a)}},$=async()=>{try{const a={dataset_id:"founder_report",table_id:"daily_summary_Taiwan",begin_date:i.value,end_date:i.value,city:["all"]};(await k.get(v,{params:a})).data.data.forEach(e=>{n.value.push({city:e.city,num1:e.rent_number,num2:e.current_station,num3:e.bike_number,num4:e.turnover,num5:e.monthly_rent_number})}),y(n.value,N.value,"詳細資訊(台灣)"),s.value.page&&s.value.page(1),c.value=!1}catch(a){console.log(a)}},L=()=>{if(n.value==="請選擇"){D("請選擇系統別");return}else if(!i.value){D("日期不能為空");return}switch(n.value=[],c.value=!0,d.value){case"TurnoverData":u.value=1,V();break;case"TurnoverTaiwanData":u.value=2,S();break;case"TotalData":u.value=3,$();break}};return(a,t)=>(m(),M("div",F,[h(o(A),{active:c.value,"onUpdate:active":t[0]||(t[0]=e=>c.value=e),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),G,l("form",{class:j(["row mx-0",{"report-header":!o(w),"report-header-dark":o(w)}])},[l("div",H,[I,l("div",J,[U(l("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":t[1]||(t[1]=e=>d.value=e)},Y,512),[[P,d.value]])])]),l("div",Z,[h(o(O),{class:"px-0","formatted-value":i.value,"onUpdate:formattedValue":t[2]||(t[2]=e=>i.value=e),type:"date",actions:null,disabled:d.value==="請選擇","update-value-on-close":"","is-date-disabled":C,"value-format":"yyyy-MM-dd"},null,8,["formatted-value","disabled"])]),l("div",ee,[l("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:L}," 搜尋 "),h(R,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:o(f),name:o(p),header:o(_)},null,8,["data","name","header"])])],2),u.value==1?(m(),b(o(x),{key:0,ref_key:"dataTable",ref:s,size:"small",columns:T.value,data:n.value,pagination:{pageSize:15},"max-height":600,"scroll-x":300,bordered:!1,"single-line":!1,striped:""},null,8,["columns","data"])):u.value==2?(m(),b(o(x),{key:1,ref_key:"dataTable",ref:s,data:n.value,size:"small",columns:z.value,pagination:{pageSize:15},"max-height":600,"scroll-x":300,bordered:!1,"single-line":!1,striped:""},null,8,["data","columns"])):u.value==3?(m(),b(o(x),{key:2,ref_key:"dataTable",ref:s,size:"small",columns:N.value,data:n.value,pagination:{pageSize:15},"max-height":600,"scroll-x":300,bordered:!1,"single-line":!1,striped:""},null,8,["columns","data"])):q("",!0)]))}};export{ie as default};
