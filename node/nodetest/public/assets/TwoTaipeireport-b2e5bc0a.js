/* empty css                     */import{u as J,r as m,i as $,z as K,o as r,c,b as p,d as o,e as i,l as O,v as Q,m as d,w as W,n as Z,k as T,E as X,L as ee,j as te,A as ae,y as le,q as j}from"./index-cbe31fc3.js";import{u as b,w as oe}from"./xlsx-bd534488.js";import{N as se}from"./Result-07ca3b21.js";import"./Warning-a21de1ed.js";const ie={class:"container-fluid px-0"},ne=i("div",{class:"row mx-0"},[i("h1",{class:"report-h1 fw-bold"},"見車率統計日報")],-1),re={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},ce=i("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"城市:",-1),ue={class:"col-md-auto px-0"},de=i("option",{selected:"",disabled:""},"請選擇",-1),me={key:0,value:"台北市"},ve={key:1,value:"新北市"},pe={key:2,value:"桃園市"},ye={key:3,value:"新竹市"},_e={key:4,value:"新竹縣"},ge={key:5,value:"竹科"},fe={key:6,value:"苗栗縣"},he={key:7,value:"台中市"},ke={key:8,value:"嘉義市"},we={key:9,value:"嘉義縣"},xe={key:10,value:"台南市"},be={key:11,value:"高雄市"},De={key:12,value:"屏東縣"},Ve={class:"row col-md-auto col-12 my-auto pt-2"},Ee={class:"row col-md-auto col-12 mx-auto mx-md-0"},Ne=i("div",{class:"row mx-0 ms-md-0 align-items-center col-md-auto col-12"},[i("label",{class:"col-md-auto ms-md-0 col-form-label px-0 px-md-2 fw-bolder"},"類型:")],-1),Ce={class:"row col-md-2 align-items-center mx-0 ps-md-0"},He={class:"row ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},Se={class:"row ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},Be={__name:"TwoTaipeireport",setup(Ue){const u=J().citys,k=m(!1),C=$("ischange"),z=$("$swal"),f=m("請選擇");async function y(l){z({icon:"error",title:`${l}`,showConfirmButton:!1})}let H=[];const A=m([{key:"item1",align:"center",fixed:"left",title:"date",width:100},{key:"item2",align:"center",title:"責任區",width:60},{key:"item3",align:"center",title:"場站代號",width:100},{key:"item4",align:"center",title:"站名",width:250},{key:"item5",align:"center",title:"狀態",width:60},{key:"item6",align:"center",title:"項目",width:70},{key:"item7",align:"center",title:"0"},{key:"item8",align:"center",title:"1"},{key:"item9",align:"center",title:"2"},{key:"item10",align:"center",title:"3"},{key:"item11",align:"center",title:"4"},{key:"item12",align:"center",title:"5"},{key:"item13",align:"center",title:"6"},{key:"item14",align:"center",title:"7"},{key:"item15",align:"center",title:"8"},{key:"item16",align:"center",title:"9"},{key:"item17",align:"center",title:"10"},{key:"item18",align:"center",title:"11"},{key:"item19",align:"center",title:"12"},{key:"item20",align:"center",title:"13"},{key:"item21",align:"center",title:"14"},{key:"item22",align:"center",title:"15"},{key:"item23",align:"center",title:"16"},{key:"item24",align:"center",title:"17"},{key:"item25",align:"center",title:"18"},{key:"item26",align:"center",title:"19"},{key:"item27",align:"center",title:"20"},{key:"item28",align:"center",title:"21"},{key:"item29",align:"center",title:"22"},{key:"item30",align:"center",title:"23"},{key:"item31",align:"center",title:"總計",width:50}]),S=m([]),w=m([]),_=m(),g=m();function B(l){var a=new Date(l),s=a.getFullYear(),e=("0"+(a.getMonth()+1)).slice(-2),n=("0"+a.getDate()).slice(-2),t=s+"-"+e+"-"+n;return t}function L(l){const a=g.value,s=new Date;if(s.setHours(0,0,0,0),a){const e=new Date(a);e.setHours(0,0,0,0);const n=new Date(e);n.setDate(n.getDate()-30);const t=new Date(l);if(t.setHours(0,0,0,0),t<n||t>e||t>s)return!0}else{const e=new Date(l);if(e.setHours(0,0,0,0),e>s)return!0}}let F=[{label:"無車",value:"無車"},{label:"無位",value:"無位"},{label:"見車率",value:"見車率"},{label:"見位率",value:"見位率"}],x=[],D="",V=[];const q=(l,a,s)=>{if(x=[],V=[],D="",x=[...l],D=s,a.forEach(e=>{V.push(e.title)}),x.length){const e=b.book_new(),n=b.json_to_sheet(x);b.book_append_sheet(e,n,"sheet1"),b.sheet_add_aoa(n,[V],{origin:"A1"}),oe(e,`${D}.xlsx`)}else return y("空資料不能匯出")};function I(l){const a=_.value,s=new Date;if(s.setHours(0,0,0,0),a){const e=new Date(a);if(e.setHours(0,0,0,0),e>s)return!0;const n=new Date(e);n.setDate(n.getDate()+30);const t=new Date(l);if(t.setHours(0,0,0,0),t<e||t>n||t>s)return!0}else{const e=new Date(l);if(e.setHours(0,0,0,0),e>s)return!0}}function P(){_.value=null,g.value=null}const R=async()=>{const l={station:h.value===!0?["all"]:v.value.map(t=>parseInt(t.split("-")[0])),dataset_id:"data_analysis",table_id:"daily_empty_full",begin_date:_.value,end_date:g.value,city:[f.value],status:w.value};console.log(l),k.value=!0;const a="https://report.youbike.com.tw/isauth/gcpfun",s=await T.get(a,{params:l});k.value=!1;const e=s.data.data;let n=[];e.forEach(t=>{let M=[];M={item1:B(t.date),item2:t.responsible_area,item3:t.s_no,item4:t.s_name,item5:t.item,item6:t.status,item7:t.r0,item8:t.r1,item9:t.r2,item10:t.r3,item11:t.r4,item12:t.r5,item13:t.r6,item14:t.r7,item15:t.r8,item16:t.r9,item17:t.r10,item18:t.r11,item19:t.r12,item20:t.r13,item21:t.r14,item22:t.r15,item23:t.r16,item24:t.r17,item25:t.r18,item26:t.r19,item27:t.r20,item28:t.r21,item29:t.r22,item30:t.r23,item31:t.total},n.push({...M})}),S.value=[...n],q(S.value,A.value,"見車率統計日報")},Y=async()=>{if(f.value==="請選擇")return y("請選擇城市");if(v.value.length===0&&!h.value){y("請選擇場站");return}else if(w.value.length===0){y("請選擇類型");return}else if(_.value==null){y("請選擇結束日期");return}else if(g.value==null){y("請選擇結束日期");return}try{await R()}catch(l){console.log(l)}},E=m([]),v=m([]),N=m(!1),h=m(!0);function U(l){if(l.length===0){E.value=[],v.value=[];return}N.value=!0,setTimeout(()=>{N.value=!1;const a=[];H.forEach(e=>{l.includes(e.city)&&a.push({label:e.s_name_tw,value:`${e.s_no}-${e.city}`})});const s=v.value.filter(e=>l.includes(e.split("-")[1]));v.value=[...s],E.value=[...a]},200)}K(f,l=>{U(l)});async function G(){try{const l="https://report.youbike.com.tw/isauth/gcpfun",a={dataset_id:"yb2",table_id:"station"},s=await T.get(l,{params:a});console.log(s),H=[...s.data.data]}catch(l){console.log(l)}}return(async()=>await G())(),(l,a)=>{const s=X;return r(),c("div",ie,[p(o(ee),{active:k.value,"onUpdate:active":a[0]||(a[0]=e=>k.value=e),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),ne,i("form",{class:Z(["row mx-0",{"report-header":!o(C),"report-header-dark":o(C)}])},[i("div",re,[ce,i("div",ue,[O(i("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":a[1]||(a[1]=e=>f.value=e)},[de,o(u).includes(2)?(r(),c("option",me," 台北市 ")):d("",!0),o(u).includes(3)?(r(),c("option",ve," 新北市 ")):d("",!0),o(u).includes(4)?(r(),c("option",pe," 桃園市 ")):d("",!0),o(u).includes(5)?(r(),c("option",ye," 新竹市 ")):d("",!0),o(u).includes(6)?(r(),c("option",_e," 新竹縣 ")):d("",!0),o(u).includes(20)?(r(),c("option",ge,"竹科")):d("",!0),o(u).includes(7)?(r(),c("option",fe," 苗栗縣 ")):d("",!0),o(u).includes(8)?(r(),c("option",he," 台中市 ")):d("",!0),o(u).includes(12)?(r(),c("option",ke," 嘉義市 ")):d("",!0),o(u).includes(13)?(r(),c("option",we," 嘉義縣 ")):d("",!0),o(u).includes(14)?(r(),c("option",xe," 台南市 ")):d("",!0),o(u).includes(15)?(r(),c("option",be," 高雄市 ")):d("",!0),o(u).includes(16)?(r(),c("option",De," 屏東縣 ")):d("",!0)],512),[[Q,f.value]])])]),i("div",Ve,[p(o(ae),{checked:h.value,"onUpdate:checked":a[2]||(a[2]=e=>h.value=e),size:"large"},{default:W(()=>[te("場站全選")]),_:1},8,["checked"])]),i("div",Ee,[p(s,{disabled:h.value,modelValue:v.value,"onUpdate:modelValue":a[3]||(a[3]=e=>v.value=e),filterable:"",options:E.value,placeholder:"請選擇場站名稱","remote-method":U,loading:N.value,class:"text-light mt-3 mt-md-0 px-0 mt-md-1 w240",multiple:"","collapse-tags":"","collapse-tags-tooltip":"",clearable:""},null,8,["disabled","modelValue","options","loading"])]),Ne,i("div",Ce,[p(o(le),{class:"px-0",value:w.value,"onUpdate:value":a[4]||(a[4]=e=>w.value=e),placeholder:"請選擇",multiple:"",options:o(F),"max-tag-count":1,size:"medium"},null,8,["value","options"])]),i("div",He,[p(o(j),{class:"px-0","formatted-value":_.value,"onUpdate:formattedValue":a[5]||(a[5]=e=>_.value=e),type:"date",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"開始日期","value-format":"yyyy-MM-dd","is-date-disabled":L},null,8,["formatted-value"])]),i("div",Se,[p(o(j),{class:"px-0","formatted-value":g.value,"onUpdate:formattedValue":a[6]||(a[6]=e=>g.value=e),type:"date",actions:null,"input-readonly":!0,"is-date-disabled":I,"update-value-on-close":!0,placeholder:"結束日期","value-format":"yyyy-MM-dd"},null,8,["formatted-value"])]),i("div",{class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},[i("button",{type:"button",class:"btn btn-info text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:P}," 清空日期 ")]),i("div",{class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},[i("button",{type:"button",class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:Y}," 搜尋匯出 ")])],2),p(o(se),{class:"mt-5",status:"info",title:"此頁面只供下載EXCEL"})])}}};export{Be as default};
