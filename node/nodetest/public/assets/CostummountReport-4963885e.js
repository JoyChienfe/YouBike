import{_ as L,i as $,u as R,r,o as i,c as u,b as g,d as a,e as l,l as Y,v as j,m as d,n as z,x as F,L as M,q as P,s as q,t as A,k as H}from"./index-2bed0a42.js";import{_ as K}from"./OutputExcel-3a33b057.js";import{N as G}from"./DataTable-04116403.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const b=m=>(q("data-v-827bc8ce"),m=m(),A(),m),J={class:"container-fluid px-0"},O=b(()=>l("div",{class:"row mx-0"},[l("h1",{class:"report-h1 fw-bold"},"客服每月話務報")],-1)),Q={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},W=b(()=>l("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"城市:",-1)),X={class:"col-md-auto px-0"},Z=b(()=>l("option",{selected:"",disabled:""},"請選擇",-1)),ee={key:0,value:"Taipei_NewTaipei"},te={key:1,value:"Taoyuan_Hsinchu_Miaoli"},ae={key:2,value:"Taichung"},se={key:3,value:"Chiayi"},oe={key:4,value:"Tainan_Kaohsiung_Pingtung"},le={class:"row mx-0 mx-md-2 align-items-center col-md-2 col-12 mt-3 mt-md-0"},ne={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},ce={__name:"CostummountReport",setup(m){const k=$("ischange"),o=R().citys,N=$("$swal");async function w(t){N({icon:"error",title:`${t}`,showConfirmButton:!1})}const T=t=>{const e=new Date(t).getFullYear(),c=new Date().getFullYear();return e<2023||e>c},D=r(null),p=r("請選擇"),_=r(!1),f=r([]),C=r([]),v=r();let h=[],y="",x=[];const B=(t,s)=>{h=[],y="",x=[],h=t.filter((e,n)=>n!==0),y=s;for(let e=1;e<=34;e++)x.push(t[0][`item${e}`])},I=()=>{const t=[];t.push({key:"item1",align:"center",title:"",fixed:"left",width:100});for(let s=1;s<=31;s++)t.push({key:`item${s+1}`,align:"center",title:""});t.push({key:"item33",align:"center",title:""}),t.push({key:"item34",align:"center",title:""}),C.value=[...t]},S=t=>{const s=[];t.forEach(e=>{let n={item1:e.item};for(let c=1;c<=33;c++)c===32?n[`item${c+1}`]=e.total:c===33?n[`item${c+1}`]=e.percent===".00%"?"0%":e.percent:n[`item${c+1}`]=e[`date${c}`];s.push(n)}),f.value=[...s]},V=async()=>{try{const t="https://report.youbike.com.tw/isauth/gcpfun",s={dataset_id:"report",table_id:"CTI_monthly_report",date:v.value,city:p.value};_.value=!0;const e=await H.get(t,{params:s});console.log(e),_.value=!1;const n=e.data.data;I(n[0]),S(n),B(f.value,"客服每月話務報")}catch(t){console.log(t)}},U=async()=>{if(p.value=="請選擇")return w("請選擇城市");if(!v.value)return w("請選擇日期");V()},E=t=>{if(t.item1==="日期")return"too-old"};return(t,s)=>(i(),u("div",J,[g(a(M),{active:_.value,"onUpdate:active":s[0]||(s[0]=e=>_.value=e),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),O,l("form",{class:z(["row mx-0",{"report-header":!a(k),"report-header-dark":a(k)}])},[l("div",Q,[W,l("div",X,[Y(l("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":s[1]||(s[1]=e=>p.value=e)},[Z,a(o).includes(2)&&a(o).includes(3)?(i(),u("option",ee," 雙北 ")):d("",!0),a(o).includes(5)&&a(o).includes(6)&&a(o).includes(20)&&a(o).includes(4)&&a(o).includes(7)?(i(),u("option",te," 桃竹苗 ")):d("",!0),a(o).includes(8)?(i(),u("option",ae," 台中市 ")):d("",!0),a(o).includes(12)?(i(),u("option",se," 嘉義市 ")):d("",!0),a(o).includes(14)&&a(o).includes(15)&&a(o).includes(16)?(i(),u("option",oe," 南高屏 ")):d("",!0)],512),[[j,p.value]])])]),l("div",le,[g(a(P),{class:"px-0","formatted-value":v.value,"onUpdate:formattedValue":s[2]||(s[2]=e=>v.value=e),type:"year",actions:null,"input-readonly":!0,"is-date-disabled":T,placeholder:"請選擇日期","value-format":"yyyy"},null,8,["formatted-value"])]),l("div",ne,[l("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:U}," 搜尋 "),g(K,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:a(h),name:a(y),header:a(x)},null,8,["data","name","header"])])],2),f.value.length?(i(),F(a(G),{key:0,size:"small",ref_key:"table",ref:D,"row-class-name":E,columns:C.value,data:f.value,"scroll-x":2e3,bordered:!1,"single-line":!1,striped:""},null,8,["columns","data"])):d("",!0)]))}},_e=L(ce,[["__scopeId","data-v-827bc8ce"]]);export{_e as default};
