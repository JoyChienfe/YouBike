import{u as $,i as D,r as u,o as t,c as a,b,d as e,e as s,l as N,v as M,F as P,m as l,n as E,x as z,L as F,q as I,k as H}from"./index-7ad65401.js";import{_ as K}from"./OutputExcel-41bca93a.js";import{N as j}from"./DataTable-c0cf6f94.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const q={class:"container-fluid px-0"},A=s("div",{class:"row mx-0"},[s("h1",{class:"report-h1 fw-bold"},"電話掛斷通數統計表")],-1),R={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Y=s("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"系統別:",-1),G={class:"col-md-auto px-0"},J=s("option",{selected:"",disabled:""},"請選擇",-1),O=s("option",{value:"1.0"},"1.0",-1),Q=s("option",{value:"2.0"},"2.0",-1),W=[J,O,Q],X={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Z=s("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"城市:",-1),ee={class:"col-md-auto px-0"},te=s("option",{selected:"",disabled:""},"請選擇",-1),oe={key:0,value:"TP_two"},ae={key:1,value:"NTP_two"},se={key:2,value:"Taoyuan_two"},le={key:3,value:"Hsinchu_two"},ne={key:4,value:"HsinchuCountry"},ie={key:5,value:"Miaoli_two"},ce={key:6,value:"Taichung_two"},ue={key:7,value:"Chiayi"},re={key:8,value:"Tainan"},de={key:9,value:"Kaohsiung"},me={key:10,value:"Pingtung"},_e={key:0,value:"NTP_one"},pe={key:1,value:"Taoyuan"},ve={key:2,value:"Miaoli"},he={key:3,value:"Taichung_one"},ye={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},fe={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},De={__name:"CostumdayReporttelout",setup(ge){const n=$().citys,w=D("ischange"),S=D("$swal");async function y(c){S({icon:"error",title:`${c}`,showConfirmButton:!1})}const f=u(null),m=u("請選擇"),r=u("請選擇"),p=u(!1),v=u([]),h=u(),V=c=>{const o=new Date(c),i=new Date,d=new Date(i.getFullYear(),i.getMonth(),i.getDate());return o<new Date(2023,7,8)||o>=d},T=u([{key:"item1",align:"center",title:"來電號碼"},{key:"item2",align:"center",title:"要求技能"},{key:"item3",align:"center",title:"來電時間"},{key:"item4",align:"center",title:"掛斷時間"},{key:"item5",align:"center",title:"諮詢客服小組"}]);let g=[],k="",x=[];const B=(c,o,i)=>{g=[],k="",x=[],g=[...c],k=i,o.forEach(d=>{x.push(d.title)})},L=async()=>{try{const c="https://report.youbike.com.tw/isauth/gcpfun";let o={dataset_id:"report",table_id:"CTI_hangup_detail",date:h.value,city:m.value,sys:r.value};p.value=!0;const d=(await H.get(c,{params:o})).data.data;console.log(d,o);const C=[];d.forEach(_=>{C.push({item1:_.mobile,item2:_.SKILLS,item3:_.income,item4:_.hang_up,item5:_.PID})}),v.value=[...C],B(v.value,T.value,"電話掛斷通數統計表"),f.value&&f.value.page(1),p.value=!1}catch(c){console.log(c)}},U=async()=>{if(r.value==="請選擇")return y("請選擇系統別");if(m.value==="請選擇")return y("請選擇城市");if(!h.value)return y("請選擇日期");await L()};return(c,o)=>(t(),a("div",q,[b(e(F),{active:p.value,"onUpdate:active":o[0]||(o[0]=i=>p.value=i),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),A,s("form",{class:E(["row mx-0",{"report-header":!e(w),"report-header-dark":e(w)}])},[s("div",R,[Y,s("div",G,[N(s("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":o[1]||(o[1]=i=>r.value=i),onChange:o[2]||(o[2]=i=>m.value="請選擇")},W,544),[[M,r.value]])])]),s("div",X,[Z,s("div",ee,[N(s("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":o[3]||(o[3]=i=>m.value=i)},[te,r.value==2?(t(),a(P,{key:0},[e(n).includes(2)?(t(),a("option",oe," 台北市 ")):l("",!0),e(n).includes(3)?(t(),a("option",ae," 新北市 ")):l("",!0),e(n).includes(4)?(t(),a("option",se," 桃園市 ")):l("",!0),e(n).includes(5)?(t(),a("option",le," 新竹市 ")):l("",!0),e(n).includes(6)?(t(),a("option",ne," 新竹縣 ")):l("",!0),e(n).includes(7)?(t(),a("option",ie," 苗栗縣 ")):l("",!0),e(n).includes(8)?(t(),a("option",ce," 台中市 ")):l("",!0),e(n).includes(12)?(t(),a("option",ue," 嘉義市 ")):l("",!0),e(n).includes(14)?(t(),a("option",re," 台南市 ")):l("",!0),e(n).includes(15)?(t(),a("option",de," 高雄市 ")):l("",!0),e(n).includes(16)?(t(),a("option",me," 屏東縣 ")):l("",!0)],64)):r.value==1?(t(),a(P,{key:1},[e(n).includes(3)?(t(),a("option",_e," 新北市 ")):l("",!0),e(n).includes(4)?(t(),a("option",pe," 桃園縣 ")):l("",!0),e(n).includes(7)?(t(),a("option",ve," 苗栗縣 ")):l("",!0),e(n).includes(8)?(t(),a("option",he," 台中市 ")):l("",!0)],64)):l("",!0)],512),[[M,m.value]])]),s("div",ye,[b(e(I),{class:"px-0","formatted-value":h.value,"onUpdate:formattedValue":o[4]||(o[4]=i=>h.value=i),type:"date",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"請選擇日期","value-format":"yyyy-MM-dd","is-date-disabled":V},null,8,["formatted-value"])])]),s("div",fe,[s("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:U}," 搜尋 "),b(K,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:e(g),name:e(k),header:e(x)},null,8,["data","name","header"])])],2),v.value.length>=1?(t(),z(e(j),{key:0,ref_key:"dataTable",ref:f,size:"small",pagination:{pageSize:17},columns:T.value,data:v.value,"max-height":600,"scroll-x":700,bordered:!1,"single-line":!1,striped:""},null,8,["columns","data"])):l("",!0)]))}};export{De as default};
