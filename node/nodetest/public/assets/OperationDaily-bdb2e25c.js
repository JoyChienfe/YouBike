import{_ as J,u as Q,i as V,r as m,o as t,c as o,b as f,d as e,e as c,l as N,v as M,F as $,m as s,n as R,p as W,L as X,q,s as Y,t as Z,k as ee}from"./index-986760c3.js";import{_ as te}from"./OutputExcel-1cacabe0.js";import{N as oe}from"./DataTable-ff678a73.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const _=k=>(Y("data-v-ccd7388a"),k=k(),Z(),k),se={class:"container-fluid px-0"},ae=_(()=>c("div",{class:"row mx-0"},[c("h1",{class:"report-h1 fw-bold"},"營運管理日報")],-1)),le={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},ne=_(()=>c("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"系統別:",-1)),ie={class:"col-md-auto px-0"},ue=_(()=>c("option",{selected:"",disabled:""},"請選擇",-1)),ce=_(()=>c("option",{value:"daily_report_query1"},"1.0",-1)),de=_(()=>c("option",{value:"daily_report_query2"},"2.0",-1)),re=_(()=>c("option",{value:"daily_report_query2E"},"2.0E",-1)),me=[ue,ce,de,re],_e={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},pe=_(()=>c("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"城市:",-1)),ve={class:"col-md-auto px-0"},ye=_(()=>c("option",{selected:"",disabled:""},"請選擇",-1)),he={key:0,selected:"",value:"Taipei"},fe={key:1,selected:"",value:"Newtaipei"},ke={key:2,selected:"",value:"Taoyuan"},ge={key:3,selected:"",value:"Hsinchu"},xe={key:4,selected:"",value:"Miaoli"},De={key:5,selected:"",value:"Taichung"},be={key:0,value:"Taipei2"},Ee={key:1,value:"Newtaipei2"},we={key:2,value:"Taoyuan2"},Ce={key:3,value:"Hsinchu2"},Te={key:4,value:"Hsinchu_Country2"},He={key:5,value:"HsinchuScience2"},Ne={key:6,value:"Miaoli2"},$e={key:7,value:"Taichung2"},Se={key:8,value:"Chiayi2"},Ve={key:9,value:"Chiayi_Country2"},Me={key:10,value:"Tainan2"},qe={key:11,value:"Kaohsiung2"},Ue={key:12,value:"Pingtung2"},Be={key:13,value:"Taitung2"},Ie={key:0,value:"Taipei2E"},ze={key:1,value:"Newtaipei2E"},Le={key:2,value:"Taoyuan2E"},Oe={key:3,value:"Hsinchu_Country2E"},Pe={key:4,value:"HsinchuScience2E"},Fe={key:5,value:"Miaoli2E"},Ke={key:6,value:"Taichung2E"},je={key:7,value:"Chiayi2E"},Ae={key:8,value:"Chiayi_Country2E"},Ge={key:9,value:"Tainan2E"},Je={key:10,value:"Kaohsiung2E"},Qe={key:11,selected:"",value:"Pingtung2E"},Re={key:12,value:"Taitung2E"},We={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},Xe={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},Ye={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Ze={__name:"OperationDaily",setup(k){const a=Q().citys,S=V("ischange"),U=V("$swal");async function g(l){U({icon:"error",title:`${l}`,showConfirmButton:!1})}const v=m(),y=m(),p=m("請選擇"),h=m("請選擇"),x=m(!1),B=m(null),D=m([{}]),w=m();let C=[],T="",H=[];const I=(l,i,n)=>{C=[],T="",H=[],C=[...l],T=n,i.forEach(u=>{H.push(u.title)})},z=l=>{const i=[];l.forEach((n,u)=>{u===0?i.push({key:`item${u+1}`,align:"center",fixed:"left",title:`${n[2]}`,width:150}):i.push({key:`item${u+1}`,align:"center",title:`${n[2]}`})}),w.value=[...i]},L=l=>{const i=y.value,n=new Date;if(n.setHours(0,0,0,0),i){const u=new Date(i);u.setHours(0,0,0,0);const r=new Date(u);r.setDate(r.getDate()-30);const d=new Date(l);if(d.setHours(0,0,0,0),d<r||d>u||d>=n)return!0}else{const u=new Date(l);if(u.setHours(0,0,0,0),u>=n)return!0}},O=l=>{const i=v.value,n=new Date;if(n.setHours(0,0,0,0),i){const u=new Date(i);if(u.setHours(0,0,0,0),u>n)return!0;const r=new Date(u);r.setDate(r.getDate()+30);const d=new Date(l);if(d.setHours(0,0,0,0),d<u||d>r||d>=n)return!0}else{const u=new Date(l);if(u.setHours(0,0,0,0),u>=n)return!0}},P=async()=>{const l="https://report.youbike.com.tw/isauth/gcpfun",i={dataset_id:"report",table_id:p.value,begin_date:v.value,end_date:y.value,city:[h.value]};try{x.value=!0;const u=(await ee.get(l,{params:i})).data.data;console.log(u),z(u),x.value=!1;let r=u[0].length-2,d=[];for(let b=1;b<=r;b++)d.push({});u.forEach((b,A)=>{b.forEach((G,E)=>{E===0||E===1||E===2||(d[E-3][`item${A+1}`]=G)})}),D.value=[...d],I(D.value,w.value,"營運管理日報")}catch(n){console.log(n)}},F=()=>{if(p.value=="請選擇")return g("請選擇系統");if(h.value=="請選擇")return g("請選擇城市");if(v.value==null)return g("請選擇開始日期");if(y.value==null)return g("請選擇結束日期");P()},K=()=>{v.value=null,y.value=null},j=l=>{if(l.item1==="場站資訊"||l.item1==="租借資訊"||l.item1==="收入資訊"||l.item1==="妥善率資訊"||l.item1==="票卡資訊"||l.item1==="租借資訊"||l.item1==="各時段使用資訊"||l.item1==="租賃收入明細"||l.item1==="當日租借車次"&&!l.item2||l.item1==="營運資訊"||l.item1==="租賃時間使用資訊"||l.item1==="調度管理"||l.item1==="騎乘距離分析"||l.item1==="維護管理"||l.item1==="註冊票卡淨增加數"&&!l.item2&&l.item2!==0)return"too-old"};return(l,i)=>(t(),o("div",se,[f(e(X),{active:x.value,"onUpdate:active":i[0]||(i[0]=n=>x.value=n),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),ae,c("form",{class:R(["row mx-0",{"report-header":!e(S),"report-header-dark":e(S)}])},[c("div",le,[ne,c("div",ie,[N(c("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":i[1]||(i[1]=n=>p.value=n),onChange:i[2]||(i[2]=n=>h.value="請選擇")},me,544),[[M,p.value]])])]),c("div",_e,[pe,c("div",ve,[N(c("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":i[3]||(i[3]=n=>h.value=n)},[ye,p.value=="daily_report_query1"?(t(),o($,{key:0},[e(a).includes(2)?(t(),o("option",he," 台北市 ")):s("",!0),e(a).includes(3)?(t(),o("option",fe," 新北市 ")):s("",!0),e(a).includes(4)?(t(),o("option",ke," 桃園市 ")):s("",!0),e(a).includes(5)?(t(),o("option",ge," 新竹市 ")):s("",!0),e(a).includes(7)?(t(),o("option",xe," 苗栗縣 ")):s("",!0),e(a).includes(8)?(t(),o("option",De," 台中市 ")):s("",!0)],64)):p.value=="daily_report_query2"?(t(),o($,{key:1},[e(a).includes(2)?(t(),o("option",be," 台北市 ")):s("",!0),e(a).includes(3)?(t(),o("option",Ee," 新北市 ")):s("",!0),e(a).includes(4)?(t(),o("option",we," 桃園市 ")):s("",!0),e(a).includes(5)?(t(),o("option",Ce," 新竹市 ")):s("",!0),e(a).includes(6)?(t(),o("option",Te," 新竹縣 ")):s("",!0),e(a).includes(20)?(t(),o("option",He," 竹科 ")):s("",!0),e(a).includes(7)?(t(),o("option",Ne," 苗栗縣 ")):s("",!0),e(a).includes(8)?(t(),o("option",$e," 台中市 ")):s("",!0),e(a).includes(12)?(t(),o("option",Se," 嘉義市 ")):s("",!0),e(a).includes(13)?(t(),o("option",Ve," 嘉義縣 ")):s("",!0),e(a).includes(14)?(t(),o("option",Me," 台南市 ")):s("",!0),e(a).includes(15)?(t(),o("option",qe," 高雄市 ")):s("",!0),e(a).includes(16)?(t(),o("option",Ue," 屏東縣 ")):s("",!0),e(a).includes(19)?(t(),o("option",Be," 台東縣 ")):s("",!0)],64)):p.value=="daily_report_query2E"?(t(),o($,{key:2},[e(a).includes(2)?(t(),o("option",Ie," 台北市 ")):s("",!0),e(a).includes(3)?(t(),o("option",ze," 新北市 ")):s("",!0),e(a).includes(4)?(t(),o("option",Le," 桃園市 ")):s("",!0),e(a).includes(6)?(t(),o("option",Oe," 新竹縣 ")):s("",!0),e(a).includes(20)?(t(),o("option",Pe," 竹科 ")):s("",!0),e(a).includes(7)?(t(),o("option",Fe," 苗栗縣 ")):s("",!0),e(a).includes(8)?(t(),o("option",Ke," 台中市 ")):s("",!0),e(a).includes(12)?(t(),o("option",je," 嘉義市 ")):s("",!0),e(a).includes(13)?(t(),o("option",Ae," 嘉義縣 ")):s("",!0),e(a).includes(14)?(t(),o("option",Ge," 台南市 ")):s("",!0),e(a).includes(15)?(t(),o("option",Je," 高雄市 ")):s("",!0),e(a).includes(16)?(t(),o("option",Qe," 屏東縣 ")):s("",!0),e(a).includes(19)?(t(),o("option",Re," 台東縣 ")):s("",!0)],64)):s("",!0)],512),[[M,h.value]])]),c("div",We,[f(e(q),{class:"px-0","formatted-value":v.value,"onUpdate:formattedValue":i[4]||(i[4]=n=>v.value=n),type:"date",actions:null,"input-readonly":!0,"update-value-on-close":!0,"default-time":"2023-06-20",placeholder:"開始日期","value-format":"yyyy-MM-dd","is-date-disabled":L},null,8,["formatted-value"])]),c("div",Xe,[f(e(q),{class:"px-0","formatted-value":y.value,"onUpdate:formattedValue":i[5]||(i[5]=n=>y.value=n),type:"date",actions:null,"input-readonly":!0,"is-date-disabled":O,"update-value-on-close":!0,placeholder:"結束日期","value-format":"yyyy-MM-dd"},null,8,["formatted-value"])])]),c("div",Ye,[c("button",{type:"button",class:"btn btn-info text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:K}," 清空日期 "),c("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:F}," 搜尋 "),f(te,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:e(C),name:e(T),header:e(H)},null,8,["data","name","header"])])],2),N(f(e(oe),{ref_key:"dataTable",ref:B,size:"small",columns:w.value,data:D.value,"row-class-name":j,pagination:{pageSize:100},"max-height":600,"scroll-x":1e3,bordered:!1,"single-line":!1,striped:""},null,8,["columns","data"]),[[W,"item2"in D.value[0]]])]))}},nt=J(Ze,[["__scopeId","data-v-ccd7388a"]]);export{nt as default};
