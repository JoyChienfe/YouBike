import{i as _,r as d,o as v,c as f,e,l as h,b2 as w,b as k,d as x,k as y,q as g}from"./index-ea6c04ee.js";import{u as c,w as $}from"./xlsx-bd534488.js";const D={class:"container-fluid border border-3 pt-3"},N=e("div",{class:"row mx-0 mb-3"},[e("h1",{class:"report-h1 fw-bold"},"預約查詢")],-1),S={class:"row mx-0 mb-3"},B={class:"col-6"},E=e("label",{for:"Input1",class:"form-label"},"特定門號",-1),I={class:"row mx-0 mb-3"},T={class:"col-6"},V=e("label",{for:"Input1",class:"form-label"},"日期",-1),M={__name:"searchData",setup(j){const m=_("$swal");async function i(o){m({icon:"error",title:`${o}`,showConfirmButton:!1})}const n=d(null),a=d(null);function u(o){const t=new Date(o),s=t.getFullYear(),l=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${s}-${l}-${r}`}function p(o){const t=c.book_new(),s=c.json_to_sheet(o);c.book_append_sheet(t,s,"簡訊日誌"),$(t,"簡訊日誌.xlsx")}const b=async()=>{if(n.value){if(!a.value){i("日期未填寫");return}}else{i("手機未填寫");return}const o=u(a.value[0]),t=u(a.value[1]);try{const s=`https://report.youbike.com.tw/sms/status?number=${n.value}&start=${o}&end=${t}`,l=await y.get(s),{result:r}=l.data;p(r)}catch(s){console.log(s)}};return(o,t)=>(v(),f("div",D,[N,e("div",S,[e("div",B,[E,h(e("input",{type:"email",class:"form-control",id:"Input1",placeholder:"0912345678","onUpdate:modelValue":t[0]||(t[0]=s=>n.value=s)},null,512),[[w,n.value]])])]),e("div",I,[e("div",T,[V,k(x(g),{value:a.value,"onUpdate:value":t[1]||(t[1]=s=>a.value=s),type:"daterange",clearable:""},null,8,["value"])])]),e("div",{class:"row mx-0 mb-3"},[e("div",{class:"col-6"},[e("button",{type:"button",class:"btn btn-primary",onClick:b},"送出")])])]))}};export{M as default};
