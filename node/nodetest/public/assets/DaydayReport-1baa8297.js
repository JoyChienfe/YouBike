import{i as _,r,o as $,c as B,b as d,d as l,e as o,n as E,l as z,p as C,L,q as T,k as V}from"./index-a5eda168.js";import{_ as Y}from"./OutputExcel-9627298f.js";import{N as F}from"./DataTable-2051144f.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const S={class:"container-fluid px-0"},U=o("div",{class:"row mx-0"},[o("h1",{class:"report-h1 fw-bold"}," 各專案N天以上卡數達成率(每月5號更新資料) ")],-1),j={class:"row mx-0 mx-md-2 align-items-center col-md-2 col-12 mt-3 mt-md-0"},q={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},K={__name:"DaydayReport",setup(A){const y=_("$swal");async function w(e){y({icon:"error",title:`${e}`,showConfirmButton:!1})}const g=_("ischange"),c=r(!1),s=r([]),x=r(null),i=r();let p=[],f="",h=[];const b=e=>{const t=new Date(e).getFullYear(),v=new Date().getFullYear();return t<2022||t>v},m=r([]);(()=>{m.value.push({key:"item",align:"center",fixed:"left",title:"項目",width:200});for(let e=1;e<=12;e++)m.value.push({key:`month${e}`,align:"center",title:`${e}月`})})();const k=(e,a,t)=>{p=[],f="",h=[],p=[...e],f=t,a.forEach(n=>{h.push(n.title)})},D=async()=>{try{s.value=[],c.value=!0;const e="https://report.youbike.com.tw/isauth/gcpfun",a={dataset_id:"data_analysis",table_id:"tan_tan_1",date:i.value};(await V.get(e,{params:a})).data.data.forEach((n,v)=>{s.value.push({item:n.item});for(let u=1;u<=12;u++)s.value[v][`month${u}`]=n[`month${u}`]}),k(s.value,m.value,"各專案N天以上卡數達成率"),x.value.page(1),c.value=!1}catch(e){console.log(e)}},N=()=>{if(!i.value)return w("請選擇日期");D()};return(e,a)=>($(),B("div",S,[d(l(L),{active:c.value,"onUpdate:active":a[0]||(a[0]=t=>c.value=t),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),U,o("form",{class:E(["row mx-0",{"report-header":!l(g),"report-header-dark":l(g)}])},[o("div",j,[d(l(T),{class:"px-0","formatted-value":i.value,"onUpdate:formattedValue":a[1]||(a[1]=t=>i.value=t),type:"year",actions:null,"input-readonly":!0,"is-date-disabled":b,placeholder:"請選擇日期","value-format":"yyyy"},null,8,["formatted-value"])]),o("div",q,[o("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:N}," 搜尋 "),d(Y,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:l(p),name:l(f),header:l(h)},null,8,["data","name","header"])])],2),z(d(l(F),{ref_key:"dataTable",ref:x,columns:m.value,data:s.value,pagination:{pageSize:20},"max-height":600,"scroll-x":1300,size:"small",bordered:!1,"single-line":!1,striped:""},null,8,["columns","data"]),[[C,s.value.length>1]])]))}};export{K as default};
