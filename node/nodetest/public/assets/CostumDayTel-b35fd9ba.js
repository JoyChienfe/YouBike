import{i as g,r as d,o as x,c as $,b as h,d as s,e as l,n as E,s as M,l as T,j as V}from"./index-9437428c.js";import{L}from"./index-181255ed.js";import{_ as j}from"./OutputExcel-f22009f0.js";import{N as z}from"./DatePicker-642088af.js";import{N as F}from"./DataTable-d29f5e06.js";import"./xlsx-bd534488.js";import"./Forward-a46dd4c7.js";import"./Input-3a828f95.js";import"./get-slot-1efb97e5.js";const P={class:"container-fluid px-0"},U=l("div",{class:"row mx-0"},[l("h1",{class:"report-h1 fw-bold"},"補償券月報")],-1),Y={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},A={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},q={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},X={__name:"CostumDayTel",setup(G){const v=g("ischange"),_=g("$swal");async function b(t){_({icon:"error",title:`${t}`,showConfirmButton:!1})}const w=d(null),i=d(!1),m=d([]),n=d(),k=t=>{const e=new Date(t),a=e.getFullYear(),r=e.getMonth()+1,c=new Date,o=c.getFullYear(),B=c.getMonth()+1;return a===o&&r>B||a>o||a<2023},y=[{key:"item1",align:"center",fixed:"left",title:"項目"},{key:"item2",align:"center",title:"使用縣市"},{key:"item3",align:"center",title:"車種"},{key:"item4",align:"center",title:"使用次數"},{key:"item5",align:"center",title:"使用金額"}];let u=[],p="",f=[];const N=(t,e,a)=>{u=[],p="",f=[],u=[...t],p=a,e.forEach(r=>{f.push(r.title)})},C=async()=>{try{const t="https://report.youbike.com.tw/isauth/gcpfun";let e={dataset_id:"report",table_id:"refund_report",date:n.value};i.value=!0;const r=(await V.get(t,{params:e})).data.data;let c=[];r.forEach(o=>{c.push({item1:o.item,item2:o.city,item3:o.sys,item4:o.numbers,item5:o.total})}),m.value=[...c],N(m.value,y,`${n.value}補償卷月報`),i.value=!1}catch(t){console.log(t)}},D=async()=>{if(!n.value)return b("請選擇日期");await C()};return(t,e)=>(x(),$("div",P,[h(s(L),{active:i.value,"onUpdate:active":e[0]||(e[0]=a=>i.value=a),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),U,l("form",{class:E(["row mx-0",{"report-header":!s(v),"report-header-dark":s(v)}])},[l("div",Y,[l("div",A,[h(s(z),{class:"px-0","formatted-value":n.value,"onUpdate:formattedValue":e[1]||(e[1]=a=>n.value=a),type:"month",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"請選擇日期","value-format":"yyyy-MM","is-date-disabled":k},null,8,["formatted-value"])])]),l("div",q,[l("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:D}," 搜尋 "),h(j,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:s(u),name:s(p),header:s(f)},null,8,["data","name","header"])])],2),m.value.length>1?(x(),M(s(F),{key:0,ref_key:"dataTable",ref:w,size:"small",columns:y,data:m.value,"scroll-x":500,bordered:!1,"single-line":!1,striped:""},null,8,["data"])):T("",!0)]))}};export{X as default};
