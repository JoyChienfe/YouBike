import{u as S,i as k,r as d,o as L,c as T,b as i,d as o,e as s,n as V,l as F,p as P,L as Y,y as D,q as j,k as q}from"./index-e8db8460.js";import{_ as A}from"./OutputExcel-90b962a8.js";import{N as H}from"./DataTable-a453676c.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const W={class:"container-fluid px-0"},G=s("div",{class:"row mx-0"},[s("h1",{class:"report-h1 fw-bold"},"平日、假日熱門的OD點(每月10號更新資料)")],-1),I=s("div",{class:"row align-items-center col-md-auto col-12 pe-0"},[s("label",{class:"col-md-auto col-form-label fw-bolder pe-0"},"平日/假日:")],-1),J={class:"row mx-0 mx-md-2 align-items-center col-md-2 col-12"},K=s("div",{class:"row align-items-center col-md-auto col-12 pe-0"},[s("label",{class:"col-md-auto col-form-label fw-bolder pe-0"},"城市:")],-1),Q={class:"row mx-0 mx-md-2 align-items-center col-md-3 col-12"},R={class:"row col-md-auto col-12 ps-md-0 pe-md-3 mx-auto mx-md-0"},X={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},oe={__name:"HotODdot",setup(Z){const e=S().citys,x=k("ischange"),r=d(!1),m=d([]),u=d([]),p=d(null),c=d([]),b=d(),N=[{label:"平日",value:"是"},{label:"假日",value:"否"}],z=t=>{const l=new Date(t),a=l.getFullYear(),n=l.getMonth()+1,w=new Date,E=w.getFullYear(),O=w.getMonth()+1;return a<2023||a>E||a===E&&n>=O};let v=[{label:"台北市2.0",value:"台北市2.0",disabled:!e.includes(2)},{label:"新北市",value:"新北市",disabled:!e.includes(3)},{label:"新北市2.0",value:"新北市2.0",disabled:!e.includes(3)},{label:"桃園市",value:"桃園市",disabled:!e.includes(4)},{label:"桃園市2.0",value:"桃園市2.0",disabled:!e.includes(4)},{label:"桃園市2.0E",value:"桃園市2.0E",disabled:!e.includes(4)},{label:"新竹市",value:"新竹市",disabled:!e.includes(5)},{label:"新竹市2.0",value:"新竹市2.0",disabled:!e.includes(5)},{label:"新竹市2.0E",value:"新竹市2.0E",disabled:!e.includes(5)},{label:"新竹縣2.0",value:"新竹縣2.0",disabled:!e.includes(6)},{label:"新竹縣2.0E",value:"新竹縣2.0E",disabled:!e.includes(6)},{label:"竹科",value:"竹科",disabled:!e.includes(20)},{label:"竹科2.0",value:"竹科2.0",disabled:!e.includes(20)},{label:"竹科2.0E",value:"竹科2.0E",disabled:!e.includes(20)},{label:"苗栗縣",value:"苗栗縣",disabled:!e.includes(7)},{label:"苗栗縣2.0",value:"苗栗縣2.0",disabled:!e.includes(7)},{label:"苗栗縣2.0E",value:"苗栗縣2.0E",disabled:!e.includes(7)},{label:"台中市",value:"台中市",disabled:!e.includes(8)},{label:"台中市2.0",value:"台中市2.0",disabled:!e.includes(8)},{label:"台中市2.0E",value:"台中市2.0E",disabled:!e.includes(8)},{label:"嘉義市2.0",value:"嘉義市2.0",disabled:!e.includes(12)},{label:"嘉義市2.0E",value:"嘉義市2.0E",disabled:!e.includes(12)},{label:"台南市2.0",value:"台南市2.0",disabled:!e.includes(14)},{label:"台南市2.0E",value:"台南市2.0E",disabled:!e.includes(14)},{label:"高雄市2.0",value:"高雄市2.0",disabled:!e.includes(15)},{label:"高雄市2.0E",value:"高雄市2.0E",disabled:!e.includes(15)},{label:"屏東縣2.0",value:"屏東縣2.0",disabled:!e.includes(16)},{label:"屏東縣2.0E",value:"屏東縣2.0E",disabled:!e.includes(16)}];(function(){let l=[];v.forEach(a=>{a.disabled||l.push(a)}),v=[...l]})();const C=k("$swal");async function f(t){C({icon:"error",title:`${t}`,showConfirmButton:!1})}const _=[{key:"num1",align:"center",fixed:"left",title:"名次",width:80},{key:"num2",align:"center",title:"平日/假日"},{key:"num3",align:"center",title:"城市"},{key:"num4",align:"center",title:"借車站代碼"},{key:"num5",align:"center",title:"借車站",width:230},{key:"num6",align:"center",title:"還車站代碼"},{key:"num7",align:"center",title:"還車站",width:230},{key:"num8",align:"center",title:"租借次數"}],U=()=>{let t=[];v.forEach(l=>{t.push(l.value)}),c.value=t};let h=[],g="",y=[];const $=(t,l,a)=>{h=[],g="",y=[],h=[...t],g=a,l.forEach(n=>{y.push(n.title)})},B=async()=>{try{r.value=!0,u.value=[];const t={dataset_id:"marketing_report",table_id:"OD_rank",item:m.value,city:c.value,date:`${b.value}-01`},l="https://report.youbike.com.tw/isauth/gcpfun";(await q.get(l,{params:t})).data.data.forEach(n=>{u.value.push({num1:n.rank,num2:n.weekday==="是"?"平日":"假日",num3:n.city,num4:n.rent_s_no,num5:n.rent_s_name,num6:n.s_no,num7:n.s_name,num8:n.times})}),p.value.page&&p.value.page(1),$(u.value,_,"平日、假日熱門的OD點"),r.value=!1}catch(t){console.log(t)}},M=()=>{if(m.value.length=="0")return f("請選擇是否平日");if(c.value.length=="0")return f("請選擇城市");b.value||f("請選擇日期"),B()};return(t,l)=>(L(),T("div",W,[i(o(Y),{active:r.value,"onUpdate:active":l[0]||(l[0]=a=>r.value=a),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),G,s("form",{class:V(["row mx-0",{"report-header":!o(x),"report-header-dark":o(x)}])},[I,s("div",J,[i(o(D),{class:"px-0",value:m.value,"onUpdate:value":l[1]||(l[1]=a=>m.value=a),placeholder:"請選擇",multiple:"",options:N,"max-tag-count":1,size:"medium"},null,8,["value"])]),K,s("div",Q,[i(o(D),{class:"px-0",value:c.value,"onUpdate:value":l[2]||(l[2]=a=>c.value=a),placeholder:"請選擇",multiple:"",options:o(v),"max-tag-count":1,size:"medium"},null,8,["value","options"])]),s("div",{class:"row col-md-auto col-12 ps-md-0 pe-md-3 mx-auto mx-md-0 mb-3 mb-md-0"},[s("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0",onClick:U}," 城市全選 ")]),s("div",R,[i(o(j),{class:"px-0","formatted-value":b.value,"onUpdate:formattedValue":l[3]||(l[3]=a=>b.value=a),type:"month",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"請選擇日期","value-format":"yyyy-MM","is-date-disabled":z},null,8,["formatted-value"])]),s("div",X,[s("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:M}," 搜尋 "),i(A,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:o(h),name:o(g),header:o(y)},null,8,["data","name","header"])])],2),F(i(o(H),{size:"small",data:u.value,ref_key:"dataTable",ref:p,columns:_,pagination:{pageSize:17},"max-height":600,"scroll-x":1300,bordered:!1,"single-line":!1,striped:""},null,8,["data"]),[[P,u.value.length>1]])]))}};export{oe as default};
