import{u as ue,i as M,r as u,o as i,c as r,b as N,d as e,e as n,k as D,v as K,F as $,l as o,n as ye,s as ke,j as de}from"./index-3459458a.js";import{L as pe}from"./index-fcaa1a70.js";import{_ as he}from"./OutputExcel-14eb8bfa.js";import{N as ve}from"./DatePicker-0f56cdd4.js";import{N as fe}from"./DataTable-83b67cc2.js";import"./xlsx-bd534488.js";import"./Forward-c5c87e0a.js";import"./Input-c173e393.js";import"./get-slot-1efb97e5.js";const we={class:"container-fluid px-0"},xe=n("div",{class:"row mx-0"},[n("h1",{class:"report-h1 fw-bold"},"話務統計表")],-1),Te={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},be=n("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"系統別:",-1),Pe={class:"col-md-auto px-0"},Ce=n("option",{selected:"",disabled:""},"請選擇",-1),Ne=n("option",{value:"1.0"},"1.0",-1),He=n("option",{value:"2.0"},"2.0",-1),Me=[Ce,Ne,He],De={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Ke=n("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"城市:",-1),$e={class:"col-md-auto px-0"},Be=n("option",{selected:"",disabled:""},"請選擇",-1),Ve={key:0,value:"TP"},Ee={key:1,value:"NTP2"},Ue={key:2,value:"Taoyuan_two"},Fe={key:3,value:"Hsinchu_two"},Se={key:4,value:"HsinchuCountry"},je={key:5,value:"Taichung_two"},ze={key:6,value:"Chiayi"},Le={key:7,value:"Tainan"},Ye={key:8,value:"Kaohsiung"},Ae={key:9,value:"Pingtung"},Ie={key:0,value:"NTP"},Re={key:1,value:"Taoyuan"},qe={key:2,value:"Miaoli"},Ge={key:3,value:"Taichung_one"},Je={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},Oe={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},ot={__name:"CostumdayReporttotal",setup(Qe){const s=ue().citys,H=M("ischange"),B=M("$swal");async function w(_){B({icon:"error",title:`${_}`,showConfirmButton:!1})}const x=u(null),t=u("請選擇"),y=u("請選擇"),p=u(!1),c=u([]),h=u([]),v=u(),V=_=>{const a=new Date(_),l=new Date,k=new Date(l.getFullYear(),l.getMonth(),l.getDate());return a<new Date(2023,7,8)||a>=k};let g=[];const E=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"台北2.0進線數"},{key:"item5",align:"center",title:"5511專線"},{key:"item6",align:"center",title:"1999專線"},{key:"item7",align:"center",title:"接聽數"},{key:"item8",align:"center",title:"接聽比例"},{key:"item9",align:"center",title:"台北2.0進線數"},{key:"item10",align:"center",title:"5511專線"},{key:"item11",align:"center",title:"1999專線"},{key:"item12",align:"center",title:"平均每人接聽通數"},{key:"item13",align:"center",title:"掛斷數"},{key:"item14",align:"center",title:">6掛斷數"},{key:"item15",align:"center",title:"<=6掛斷數"},{key:"item16",align:"center",title:">6掛斷率"},{key:"item17",align:"center",title:"使用次數"},{key:"item18",align:"center",title:"接聽前平均等待時間"},{key:"item19",align:"center",title:"平均通話時間"}],U=["time_range","total","total_percentage","TP_two_total","TP_5511_total","TP_1999_total","answer","answer_percentage","TP_two_answer","TP_5511_answer","TP_1999_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],F=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"新北2.0"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"新北2.0"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],S=["time_range","total","total_percentage","NTP_two_total","answer","answer_percentage","NTP_two_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],j=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"YB新北"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"YB新北"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],z=["time_range","total","total_percentage","NTP_one_total","answer","answer_percentage","NTP_one_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],L=["time_range","total","total_percentage","Taoyuan_one_total","answer","answer_percentage","Taoyuan_one_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],Y=["time_range","total","total_percentage","Taoyuan_two_total","answer","answer_percentage","Taoyuan_two_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],A=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"桃園2.0"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"桃園2.0"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],I=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"桃園1.0"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"桃園1.0"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],R=["time_range","total","total_percentage","Hsinchu_two_total","answer","answer_percentage","Hsinchu_two_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],q=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"新竹2.0"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"新竹2.0"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],G=["time_range","total","total_percentage","HsinchuCountry_two_total","answer","answer_percentage","HsinchuCountry_two_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],J=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"竹縣2.0"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"竹縣2.0"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],O=["time_range","total","total_percentage","Miaoli_one_total","answer","answer_percentage","Miaoli_one_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],Q=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"苗栗1.0"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"苗栗1.0"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],W=["time_range","total","total_percentage","Chiayi_total","answer","answer_percentage","Chiayi_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],X=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"嘉義2.0"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"嘉義2.0"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],Z=["time_range","total","total_percentage","Taichung_two_total","answer","answer_percentage","Taichung_two_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],ee=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"台中2.0"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"台中2.0"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],te=["time_range","total","total_percentage","Taichung_one_total","answer","answer_percentage","Taichung_one_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],ie=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"台中1.0"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"台中1.0"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],ne=["time_range","total","total_percentage","Tainan_total","answer","answer_percentage","Tainan_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],ae=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"台南2.0"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"台南2.0"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],le=["time_range","total","total_percentage","Kaohsiung_two_total","Kaohsiung_0800_total","answer","answer_percentage","Kaohsiung_two_answer","Kaohsiung_0800_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],re=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"高雄2.0進電數"},{key:"item5",align:"center",title:"0800專線"},{key:"item6",align:"center",title:"接聽數"},{key:"item7",align:"center",title:"接聽比例"},{key:"item8",align:"center",title:"高雄2.0進線數"},{key:"item9",align:"center",title:"0800專線"},{key:"item10",align:"center",title:"平均每人接聽通數"},{key:"item11",align:"center",title:"掛斷數"},{key:"item12",align:"center",title:">6掛斷數"},{key:"item13",align:"center",title:"<=6掛斷數"},{key:"item14",align:"center",title:">6掛斷率"},{key:"item15",align:"center",title:"使用次數"},{key:"item16",align:"center",title:"接聽前平均等待時間"},{key:"item17",align:"center",title:"平均通話時間"}],ce=["time_range","total","total_percentage","Pingtung_total","answer","answer_percentage","Pingtung_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],oe=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"屏東2.0"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"屏東2.0"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],ge=()=>{t.value==="TP"?(g=[...U],c.value=[...E]):t.value==="NTP2"?(g=[...S],c.value=[...F]):t.value==="NTP"?(g=[...z],c.value=[...j]):t.value==="Taoyuan"?(g=[...L],c.value=[...I]):t.value==="Taoyuan_two"?(g=[...Y],c.value=[...A]):t.value==="Hsinchu_two"?(g=[...R],c.value=[...q]):t.value==="HsinchuCountry"?(g=[...G],c.value=[...J]):t.value==="Miaoli"?(g=[...O],c.value=[...Q]):t.value==="Chiayi"?(g=[...W],c.value=[...X]):t.value==="Taichung_two"?(g=[...Z],c.value=[...ee]):t.value==="Taichung_one"?(g=[...te],c.value=[...ie]):t.value==="Kaohsiung"?(g=[...le],c.value=[...re]):t.value==="Tainan"?(g=[...ne],c.value=[...ae]):t.value==="Pingtung"&&(g=[...ce],c.value=[...oe])};let T=[],b="",P=[];const se=(_,a,l)=>{T=[],b="",P=[],T=[..._],b=l,a.forEach(k=>{P.push(k.title)})},_e=async()=>{try{const _="https://report.youbike.com.tw/isauth/gcpfun";let a={dataset_id:"report",table_id:"CTI_final_table",date:v.value,city:t.value,sys:y.value};p.value=!0;const l=await de.get(_,{params:a});console.log(l),p.value=!1;let k=[];l.data.data.forEach(d=>{let f={};g.forEach((m,C)=>{m==="total_percentage"||m==="answer_percentage"||m==="hangup_gt_six_percentage"?f[`item${C+1}`]=d[m]===0||d[m]===null?0:(d[m]*100).toFixed(2)+"%":m==="avg_person_counts"?f[`item${C+1}`]=d[m]===null?0:d[m]:f[`item${C+1}`]=d[m]}),k.push(f)}),h.value=[...k],se(h.value,c.value,"話務統計表"),x.value.page&&x.value.page(1),p.value=!1}catch(_){console.log(_)}},me=async()=>{if(y.value==="請選擇")return w("請選擇系統別");if(t.value==="請選擇")return w("請選擇城市");if(!v.value)return w("請選擇日期");ge(),await _e()};return(_,a)=>(i(),r("div",we,[N(e(pe),{active:p.value,"onUpdate:active":a[0]||(a[0]=l=>p.value=l),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),xe,n("form",{class:ye(["row mx-0",{"report-header":!e(H),"report-header-dark":e(H)}])},[n("div",Te,[be,n("div",Pe,[D(n("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":a[1]||(a[1]=l=>y.value=l),onChange:a[2]||(a[2]=l=>t.value="請選擇")},Me,544),[[K,y.value]])])]),n("div",De,[Ke,n("div",$e,[D(n("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":a[3]||(a[3]=l=>t.value=l)},[Be,y.value==2?(i(),r($,{key:0},[e(s).includes(2)?(i(),r("option",Ve,"台北市")):o("",!0),e(s).includes(3)?(i(),r("option",Ee," 新北市 ")):o("",!0),e(s).includes(4)?(i(),r("option",Ue," 桃園市 ")):o("",!0),e(s).includes(5)?(i(),r("option",Fe," 新竹市 ")):o("",!0),e(s).includes(6)?(i(),r("option",Se," 新竹縣 ")):o("",!0),e(s).includes(8)?(i(),r("option",je," 台中市 ")):o("",!0),e(s).includes(12)?(i(),r("option",ze," 嘉義市 ")):o("",!0),e(s).includes(14)?(i(),r("option",Le," 台南市 ")):o("",!0),e(s).includes(15)?(i(),r("option",Ye," 高雄市 ")):o("",!0),e(s).includes(16)?(i(),r("option",Ae," 屏東縣 ")):o("",!0)],64)):y.value==1?(i(),r($,{key:1},[e(s).includes(3)?(i(),r("option",Ie,"新北市")):o("",!0),e(s).includes(4)?(i(),r("option",Re," 桃園縣 ")):o("",!0),e(s).includes(7)?(i(),r("option",qe," 苗栗縣 ")):o("",!0),e(s).includes(8)?(i(),r("option",Ge," 台中市 ")):o("",!0)],64)):o("",!0)],512),[[K,t.value]])]),n("div",Je,[N(e(ve),{class:"px-0","formatted-value":v.value,"onUpdate:formattedValue":a[4]||(a[4]=l=>v.value=l),type:"date",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"請選擇日期","value-format":"yyyy-MM-dd","is-date-disabled":V},null,8,["formatted-value"])])]),n("div",Oe,[n("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:me}," 搜尋 "),N(he,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:e(T),name:e(b),header:e(P)},null,8,["data","name","header"])])],2),h.value.length>1?(i(),ke(e(fe),{key:0,ref_key:"dataTable",ref:x,size:"small",pagination:{pageSize:17},columns:c.value,data:h.value,"max-height":600,"scroll-x":1e3,bordered:!1,"single-line":!1,striped:""},null,8,["columns","data"])):o("",!0)]))}};export{ot as default};
