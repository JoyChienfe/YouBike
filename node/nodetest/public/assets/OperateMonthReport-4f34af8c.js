import{i as x,r as u,o as B,c as C,b as d,d as n,e as l,n as E,l as z,p as F,L,q as T,k as V}from"./index-1f4bc719.js";import{_ as Y}from"./OutputExcel-4803ad31.js";import{N as P}from"./DataTable-f85d01cc.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const S={class:"container-fluid px-0"},U=l("div",{class:"row mx-0"},[l("h1",{class:"report-h1 fw-bold"},"累積業績")],-1),j={class:"row mx-0 mx-md-2 align-items-center col-md-auto"},q={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},J={__name:"OperateMonthReport",setup(A){const v=x("ischange"),b=x("$swal");async function w(o){b({icon:"error",title:`${o}`,showConfirmButton:!1})}const c=u(!1),f=u(),s=u(null),r=u([]);let h=[],p="",g=[];const k=(o,e,a)=>{h=[],g=[],p="",h=[...o],p=a,e.forEach(t=>{g.push(t.title)})},_=[{key:"month",align:"center",fixed:"left",title:"月份"},{key:"city",align:"center",title:"城市"},{key:"num1",align:"center",title:"單月騎乘次數"},{key:"num2",align:"center",title:"去年同期騎乘次數"},{key:"num3",align:"center",title:"單月最高騎乘次數紀錄"}],D=o=>{const e=new Date(o),a=e.getFullYear(),t=e.getMonth()+1,i=new Date,m=i.getFullYear(),y=i.getMonth()+1;return a<2012||a===2012&&t<8||a>m||a===m&&t>y||a===m&&t>=y},M=async()=>{try{c.value=!0,r.value=[];const o="https://report.youbike.com.tw/isauth/gcpfun";let e={dataset_id:"founder_report",table_id:"monthly_operation_report",date:s.value};(await V.get(o,{params:e})).data.data.forEach(t=>{r.value.push({month:t.month,city:t.city,num1:t.monthly_rent_number,num2:t.last_year_monthly_rent_number,num3:t.max_monthly_rent_number})}),k(r.value,_,"累積業績"),f.value.page&&f.value.page(1),c.value=!1}catch(o){console.log(o)}},$=o=>{const e=new Date,a=e.getFullYear(),t=e.getMonth()+1,i=t<10?`0${t}`:t;`${a}-${i}`!==o&&(s.value=o)},N=()=>{if(!s.value){w("日期不能為空");return}M()};return(o,e)=>(B(),C("div",S,[d(n(L),{active:c.value,"onUpdate:active":e[0]||(e[0]=a=>c.value=a),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),U,l("form",{class:E(["row mx-0",{"report-header":!n(v),"report-header-dark":n(v)}])},[l("div",j,[d(n(T),{class:"px-0","formatted-value":s.value,"onUpdate:formattedValue":e[1]||(e[1]=a=>s.value=a),type:"month",actions:null,"update-value-on-close":"","is-date-disabled":D,"value-format":"yyyy-MM","on-update:formatted-value":$},null,8,["formatted-value"])]),l("div",q,[l("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:N}," 搜尋 "),d(Y,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:n(h),name:n(p),header:n(g)},null,8,["data","name","header"])])],2),z(d(n(P),{ref_key:"dataTable",ref:f,data:r.value,columns:_,pagination:{pageSize:15},"max-height":500,"scroll-x":300,size:"small",bordered:!1,"single-line":!1,striped:""},null,8,["data"]),[[F,r.value.length]])]))}};export{J as default};
