import{_ as J,u as Q,i as V,r as m,o as s,c as o,b as f,d as e,e as u,l as N,v as M,F as $,m as a,n as R,p as W,L as X,q,s as Y,t as Z,k as ee}from"./index-51f79bed.js";import{_ as te}from"./OutputExcel-c7156f1d.js";import{N as se}from"./DataTable-69ff6a12.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const _=k=>(Y("data-v-f8ad257e"),k=k(),Z(),k),oe={class:"container-fluid px-0"},ae=_(()=>u("div",{class:"row mx-0"},[u("h1",{class:"report-h1 fw-bold"},"營運管理日報")],-1)),le={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},ne=_(()=>u("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"系統別:",-1)),ie={class:"col-md-auto px-0"},ce=_(()=>u("option",{selected:"",disabled:""},"請選擇",-1)),ue=_(()=>u("option",{value:"daily_report_query1"},"1.0",-1)),de=_(()=>u("option",{value:"daily_report_query2"},"2.0",-1)),re=_(()=>u("option",{value:"daily_report_query2E"},"2.0E",-1)),me=[ce,ue,de,re],_e={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},pe=_(()=>u("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"城市:",-1)),ve={class:"col-md-auto px-0"},he=_(()=>u("option",{selected:"",disabled:""},"請選擇",-1)),ye={key:0,selected:"",value:"Taipei"},fe={key:1,selected:"",value:"Newtaipei"},ke={key:2,selected:"",value:"Taoyuan"},ge={key:3,selected:"",value:"Hsinchu"},xe={key:4,selected:"",value:"Miaoli"},De={key:5,selected:"",value:"Taichung"},be={key:0,selected:"",value:"Taipei2"},Ee={key:1,selected:"",value:"Newtaipei2"},we={key:2,selected:"",value:"Taoyuan2"},He={key:3,selected:"",value:"Hsinchu2"},Te={key:4,selected:"",value:"Hsinchu_Country2"},Ce={key:5,value:"HsinchuScience2"},Ne={key:6,selected:"",value:"Miaoli2"},$e={key:7,selected:"",value:"Taichung2"},Se={key:8,selected:"",value:"Chiayi2"},Ve={key:9,selected:"",value:"Tainan2"},Me={key:10,selected:"",value:"Kaohsiung2"},qe={key:11,selected:"",value:"Pingtung2"},Ue={key:0,selected:"",value:"Taipei2E"},Be={key:1,selected:"",value:"Newtaipei2E"},Ie={key:2,selected:"",value:"Taoyuan2E"},ze={key:3,selected:"",value:"Hsinchu_Country2E"},Le={key:4,value:"HsinchuScience2E"},Oe={key:5,selected:"",value:"Miaoli2E"},Pe={key:6,selected:"",value:"Taichung2E"},Fe={key:7,selected:"",value:"Chiayi2E"},Ke={key:8,selected:"",value:"Tainan2E"},je={key:9,selected:"",value:"Kaohsiung2E"},Ae={key:10,selected:"",value:"Pingtung2E"},Ge={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},Je={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},Qe={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Re={__name:"OperationDaily",setup(k){const l=Q().citys,S=V("ischange"),U=V("$swal");async function g(t){U({icon:"error",title:`${t}`,showConfirmButton:!1})}const v=m(),h=m(),p=m("請選擇"),y=m("請選擇"),x=m(!1),B=m(null),D=m([{}]),w=m();let H=[],T="",C=[];const I=(t,i,n)=>{H=[],T="",C=[],H=[...t],T=n,i.forEach(c=>{C.push(c.title)})},z=t=>{const i=[];t.forEach((n,c)=>{c===0?i.push({key:`item${c+1}`,align:"center",fixed:"left",title:`${n[2]}`,width:150}):i.push({key:`item${c+1}`,align:"center",title:`${n[2]}`})}),w.value=[...i]},L=t=>{const i=h.value,n=new Date;if(n.setHours(0,0,0,0),i){const c=new Date(i);c.setHours(0,0,0,0);const r=new Date(c);r.setDate(r.getDate()-30);const d=new Date(t);if(d.setHours(0,0,0,0),d<r||d>c||d>=n)return!0}else{const c=new Date(t);if(c.setHours(0,0,0,0),c>=n)return!0}},O=t=>{const i=v.value,n=new Date;if(n.setHours(0,0,0,0),i){const c=new Date(i);if(c.setHours(0,0,0,0),c>n)return!0;const r=new Date(c);r.setDate(r.getDate()+30);const d=new Date(t);if(d.setHours(0,0,0,0),d<c||d>r||d>=n)return!0}else{const c=new Date(t);if(c.setHours(0,0,0,0),c>=n)return!0}},P=async()=>{const t="https://report.youbike.com.tw/isauth/gcpfun",i={dataset_id:"report",table_id:p.value,begin_date:v.value,end_date:h.value,city:[y.value]};try{x.value=!0;const c=(await ee.get(t,{params:i})).data.data;console.log(c),z(c),x.value=!1;let r=c[0].length-2,d=[];for(let b=1;b<=r;b++)d.push({});c.forEach((b,A)=>{b.forEach((G,E)=>{E===0||E===1||E===2||(d[E-3][`item${A+1}`]=G)})}),D.value=[...d],I(D.value,w.value,"營運管理日報")}catch(n){console.log(n)}},F=()=>{if(p.value=="請選擇")return g("請選擇系統");if(y.value=="請選擇")return g("請選擇城市");if(v.value==null)return g("請選擇開始日期");if(h.value==null)return g("請選擇結束日期");P()},K=()=>{v.value=null,h.value=null},j=t=>{if(t.item1==="場站資訊"||t.item1==="租借資訊"||t.item1==="收入資訊"||t.item1==="妥善率資訊"||t.item1==="票卡資訊"||t.item1==="租借資訊"||t.item1==="各時段使用資訊"||t.item1==="租賃收入明細"||t.item1==="當日租借車次"&&!t.item2||t.item1==="營運資訊"||t.item1==="租賃時間使用資訊"||t.item1==="調度管理"||t.item1==="騎乘距離分析"||t.item1==="維護管理"||t.item1==="註冊票卡淨增加數"&&!t.item2&&t.item2!==0)return"too-old"};return(t,i)=>(s(),o("div",oe,[f(e(X),{active:x.value,"onUpdate:active":i[0]||(i[0]=n=>x.value=n),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),ae,u("form",{class:R(["row mx-0",{"report-header":!e(S),"report-header-dark":e(S)}])},[u("div",le,[ne,u("div",ie,[N(u("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":i[1]||(i[1]=n=>p.value=n),onChange:i[2]||(i[2]=n=>y.value="請選擇")},me,544),[[M,p.value]])])]),u("div",_e,[pe,u("div",ve,[N(u("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":i[3]||(i[3]=n=>y.value=n)},[he,p.value=="daily_report_query1"?(s(),o($,{key:0},[e(l).includes(2)?(s(),o("option",ye," 台北市 ")):a("",!0),e(l).includes(3)?(s(),o("option",fe," 新北市 ")):a("",!0),e(l).includes(4)?(s(),o("option",ke," 桃園市 ")):a("",!0),e(l).includes(5)?(s(),o("option",ge," 新竹市 ")):a("",!0),e(l).includes(7)?(s(),o("option",xe," 苗栗縣 ")):a("",!0),e(l).includes(8)?(s(),o("option",De," 台中市 ")):a("",!0)],64)):p.value=="daily_report_query2"?(s(),o($,{key:1},[e(l).includes(2)?(s(),o("option",be," 台北市 ")):a("",!0),e(l).includes(3)?(s(),o("option",Ee," 新北市 ")):a("",!0),e(l).includes(4)?(s(),o("option",we," 桃園市 ")):a("",!0),e(l).includes(5)?(s(),o("option",He," 新竹市 ")):a("",!0),e(l).includes(6)?(s(),o("option",Te," 新竹縣 ")):a("",!0),e(l).includes(20)?(s(),o("option",Ce," 竹科 ")):a("",!0),e(l).includes(7)?(s(),o("option",Ne," 苗栗縣 ")):a("",!0),e(l).includes(8)?(s(),o("option",$e," 台中市 ")):a("",!0),e(l).includes(12)?(s(),o("option",Se," 嘉義市 ")):a("",!0),e(l).includes(14)?(s(),o("option",Ve," 台南市 ")):a("",!0),e(l).includes(15)?(s(),o("option",Me," 高雄市 ")):a("",!0),e(l).includes(16)?(s(),o("option",qe," 屏東縣 ")):a("",!0)],64)):p.value=="daily_report_query2E"?(s(),o($,{key:2},[e(l).includes(2)?(s(),o("option",Ue," 台北市 ")):a("",!0),e(l).includes(3)?(s(),o("option",Be," 新北市 ")):a("",!0),e(l).includes(4)?(s(),o("option",Ie," 桃園市 ")):a("",!0),e(l).includes(6)?(s(),o("option",ze," 新竹縣 ")):a("",!0),e(l).includes(20)?(s(),o("option",Le," 竹科 ")):a("",!0),e(l).includes(7)?(s(),o("option",Oe," 苗栗縣 ")):a("",!0),e(l).includes(8)?(s(),o("option",Pe," 台中市 ")):a("",!0),e(l).includes(12)?(s(),o("option",Fe," 嘉義市 ")):a("",!0),e(l).includes(14)?(s(),o("option",Ke," 台南市 ")):a("",!0),e(l).includes(15)?(s(),o("option",je," 高雄市 ")):a("",!0),e(l).includes(16)?(s(),o("option",Ae," 屏東縣 ")):a("",!0)],64)):a("",!0)],512),[[M,y.value]])]),u("div",Ge,[f(e(q),{class:"px-0","formatted-value":v.value,"onUpdate:formattedValue":i[4]||(i[4]=n=>v.value=n),type:"date",actions:null,"input-readonly":!0,"update-value-on-close":!0,"default-time":"2023-06-20",placeholder:"開始日期","value-format":"yyyy-MM-dd","is-date-disabled":L},null,8,["formatted-value"])]),u("div",Je,[f(e(q),{class:"px-0","formatted-value":h.value,"onUpdate:formattedValue":i[5]||(i[5]=n=>h.value=n),type:"date",actions:null,"input-readonly":!0,"is-date-disabled":O,"update-value-on-close":!0,placeholder:"結束日期","value-format":"yyyy-MM-dd"},null,8,["formatted-value"])])]),u("div",Qe,[u("button",{type:"button",class:"btn btn-info text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:K}," 清空日期 "),u("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:F}," 搜尋 "),f(te,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:e(H),name:e(T),header:e(C)},null,8,["data","name","header"])])],2),N(f(e(se),{ref_key:"dataTable",ref:B,size:"small",columns:w.value,data:D.value,"row-class-name":j,pagination:{pageSize:100},"max-height":600,"scroll-x":1e3,bordered:!1,"single-line":!1,striped:""},null,8,["columns","data"]),[[W,"item2"in D.value[0]]])]))}},st=J(Re,[["__scopeId","data-v-f8ad257e"]]);export{st as default};
