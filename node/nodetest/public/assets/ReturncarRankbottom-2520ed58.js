import{u as S,i as k,r as i,o as L,c as T,b as u,d as n,e as s,n as V,l as F,p as P,L as Y,y as D,q as j,k as q}from"./index-bfe704f8.js";import{_ as A}from"./OutputExcel-bfa1334f.js";import{N as G}from"./DataTable-9584a8e3.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const H={class:"container-fluid px-0"},I=s("div",{class:"row mx-0"},[s("h1",{class:"report-h1 fw-bold"},"借/還車場站排名(倒數)(每月10號更新資料)")],-1),J=s("div",{class:"row align-items-center col-md-auto col-12 pe-0"},[s("label",{class:"col-md-auto col-form-label fw-bolder pe-0"},"借/還:")],-1),K={class:"row mx-0 mx-md-2 align-items-center col-md-2 col-12"},O=s("div",{class:"row align-items-center col-md-auto col-12 pe-0"},[s("label",{class:"col-md-auto col-form-label fw-bolder pe-0"},"城市:")],-1),Q={class:"row mx-0 mx-md-2 align-items-center col-md-3 col-12"},W={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12 mt-3 mt-md-0"},X={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},oe={__name:"ReturncarRankbottom",setup(Z){const e=S().citys,x=k("ischange"),r=i(!1),m=i(),b=i([]),d=i([]),p=i(null),c=i([]),N=k("$swal");async function f(t){N({icon:"error",title:`${t}`,showConfirmButton:!1})}const B=[{label:"借",value:"借"},{label:"還",value:"還"}];let v=[{label:"台北市2.0",value:"台北市2.0",disabled:!e.includes(2)},{label:"新北市",value:"新北市",disabled:!e.includes(3)},{label:"新北市2.0",value:"新北市2.0",disabled:!e.includes(3)},{label:"桃園市",value:"桃園市",disabled:!e.includes(4)},{label:"桃園市2.0",value:"桃園市2.0",disabled:!e.includes(4)},{label:"新竹市",value:"新竹市",disabled:!e.includes(5)},{label:"新竹市2.0",value:"新竹市2.0",disabled:!e.includes(5)},{label:"新竹市2.0E",value:"新竹市2.0E",disabled:!e.includes(5)},{label:"新竹縣2.0",value:"新竹縣2.0",disabled:!e.includes(6)},{label:"新竹縣2.0E",value:"新竹縣2.0E",disabled:!e.includes(6)},{label:"竹科",value:"竹科",disabled:!e.includes(20)},{label:"竹科2.0",value:"竹科2.0",disabled:!e.includes(20)},{label:"竹科2.0E",value:"竹科2.0E",disabled:!e.includes(20)},{label:"苗栗縣",value:"苗栗縣",disabled:!e.includes(7)},{label:"苗栗縣2.0",value:"苗栗縣2.0",disabled:!e.includes(7)},{label:"苗栗縣2.0E",value:"苗栗縣2.0E",disabled:!e.includes(7)},{label:"台中市",value:"台中市",disabled:!e.includes(8)},{label:"台中市2.0",value:"台中市2.0",disabled:!e.includes(8)},{label:"台中市2.0E",value:"台中市2.0E",disabled:!e.includes(8)},{label:"嘉義市2.0",value:"嘉義市2.0",disabled:!e.includes(11)},{label:"嘉義市2.0E",value:"嘉義市2.0E",disabled:!e.includes(11)},{label:"台南市2.0",value:"台南市2.0",disabled:!e.includes(14)},{label:"台南市2.0E",value:"台南市2.0E",disabled:!e.includes(14)},{label:"高雄市2.0",value:"高雄市2.0",disabled:!e.includes(15)},{label:"高雄市2.0E",value:"高雄市2.0E",disabled:!e.includes(15)},{label:"屏東縣2.0",value:"屏東縣2.0",disabled:!e.includes(16)},{label:"屏東縣2.0E",value:"屏東縣2.0E",disabled:!e.includes(16)}];(function(){let l=[];v.forEach(a=>{a.disabled||l.push(a)}),v=[...l]})();const y=[{key:"num1",align:"center",fixed:"left",title:"名次"},{key:"num2",align:"center",title:"借/還 "},{key:"num3",align:"center",title:"城市"},{key:"num4",align:"center",title:"場站代碼 "},{key:"num5",align:"center",title:"場站名稱"},{key:"num6",align:"center",title:"借車/還車次數"}],z=()=>{let t=[];v.forEach(l=>{t.push(l.value)}),c.value=t};let g=[],h="",_=[];const C=(t,l,a)=>{g=[],h="",_=[],g=[...t],h=a,l.forEach(o=>{_.push(o.title)})},U=t=>{const l=new Date(t),a=l.getFullYear(),o=l.getMonth()+1,w=new Date,E=w.getFullYear(),R=w.getMonth()+1;return a<2023||a>E||a===E&&o>=R},$=async()=>{try{r.value=!0,d.value=[];const t={dataset_id:"marketing_report",table_id:"rent_return_rank_bottom",item:b.value,city:c.value,date:`${m.value}-01`},l="http://127.0.0.1:3000/isauth/gcpfun";(await q.get(l,{params:t})).data.data.forEach(o=>{d.value.push({num1:o.rank,num2:o.rent_return,num3:o.city,num4:o.station_no,num5:o.station_name,num6:o.times})}),p.value.page&&p.value.page(1),C(d.value,y,"借還車場站排名(倒數)"),r.value=!1}catch(t){console.log(t)}},M=()=>{if(b.value.length==0)return f("請選擇借/還");if(c.value.length==0)return f("請選擇城市");if(!m.value)return f("請選擇日期");$()};return(t,l)=>(L(),T("div",H,[u(n(Y),{active:r.value,"onUpdate:active":l[0]||(l[0]=a=>r.value=a),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),I,s("form",{class:V(["row mx-0",{"report-header":!n(x),"report-header-dark":n(x)}])},[J,s("div",K,[u(n(D),{class:"px-0",value:b.value,"onUpdate:value":l[1]||(l[1]=a=>b.value=a),placeholder:"請選擇",multiple:"",options:B,"max-tag-count":1,size:"medium"},null,8,["value"])]),O,s("div",Q,[u(n(D),{class:"px-0",value:c.value,"onUpdate:value":l[2]||(l[2]=a=>c.value=a),placeholder:"請選擇",multiple:"",options:n(v),"max-tag-count":1,size:"medium"},null,8,["value","options"])]),s("div",{class:"row col-md-auto col-12 ps-md-0 pe-md-3 mx-auto mx-md-0"},[s("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0",onClick:z}," 城市全選 ")]),s("div",W,[u(n(j),{class:"px-0","formatted-value":m.value,"onUpdate:formattedValue":l[3]||(l[3]=a=>m.value=a),type:"month",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"請選擇日期","value-format":"yyyy-MM","is-date-disabled":U},null,8,["formatted-value"])]),s("div",X,[s("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:M}," 搜尋 "),u(A,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:n(g),name:n(h),header:n(_)},null,8,["data","name","header"])])],2),F(u(n(G),{class:"red",size:"small",data:d.value,ref_key:"dataTable",ref:p,columns:y,pagination:{pageSize:17},"max-height":600,"scroll-x":500,bordered:!1,"single-line":!1,striped:""},null,8,["data"]),[[P,d.value.length>1]])]))}};export{oe as default};
