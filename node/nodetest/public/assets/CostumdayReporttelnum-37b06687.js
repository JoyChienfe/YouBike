import{u as S,i as C,r as d,o as i,c as a,b as w,d as t,e as o,l as D,v as N,F as M,m as n,n as F,x as L,L as A,q as H,k as I}from"./index-7b4e55c1.js";import{_ as P}from"./OutputExcel-bdbd0611.js";import{N as j}from"./DataTable-48a84b8a.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const q={class:"container-fluid px-0"},K=o("div",{class:"row mx-0"},[o("h1",{class:"report-h1 fw-bold"},"接聽通數統計")],-1),R={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Y=o("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"系統別:",-1),G={class:"col-md-auto px-0"},J=o("option",{selected:"",disabled:""},"請選擇",-1),O=o("option",{value:"1.0"},"1.0",-1),Q=o("option",{value:"2.0"},"2.0",-1),W=[J,O,Q],X={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Z=o("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"城市:",-1),ee={class:"col-md-auto px-0"},te=o("option",{selected:"",disabled:""},"請選擇",-1),ie={key:0,value:"Taipei_two"},ae={key:1,value:"NewTaipei_two"},oe={key:2,value:"Taoyuan_two"},se={key:3,value:"Miaoli_two"},ne={key:4,value:"Hsinchu_two"},le={key:5,value:"HsinchuCountry_two"},ce={key:6,value:"Taichung_two"},re={key:7,value:"Chiayi"},ue={key:8,value:"Tainan"},de={key:9,value:"Kaohsiung"},me={key:10,value:"Pingtung"},_e={key:0,value:"NewTaipei_one"},ye={key:1,value:"Taoyuan"},pe={key:2,value:"Miaoli_one"},ve={key:3,value:"Taichung_one"},he={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},ge={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},De={__name:"CostumdayReporttelnum",setup(ke){const l=S().citys,x=C("ischange"),V=C("$swal");async function h(r){V({icon:"error",title:`${r}`,showConfirmButton:!1})}const B=d(null),m=d("請選擇"),u=d("請選擇"),y=d(!1),p=d([]),v=d(),U=r=>{const s=new Date(r),c=new Date,_=new Date(c.getFullYear(),c.getMonth(),c.getDate());return s<new Date(2023,7,8)||s>=_},b=[{key:"item1",align:"center",fixed:"left",title:"員工編號",width:100},{key:"item2",align:"center",title:"姓名",width:100},{key:"item3",align:"center",title:"0-1"},{key:"item4",align:"center",title:"1-2"},{key:"item5",align:"center",title:"2-3"},{key:"item6",align:"center",title:"3-4"},{key:"item7",align:"center",title:"4-5"},{key:"item8",align:"center",title:"5-6"},{key:"item9",align:"center",title:"6-7"},{key:"item10",align:"center",title:"7-8"},{key:"item11",align:"center",title:"8-9"},{key:"item12",align:"center",title:"9-10"},{key:"item13",align:"center",title:"10-11"},{key:"item14",align:"center",title:"11-12"},{key:"item15",align:"center",title:"12-13"},{key:"item16",align:"center",title:"13-14"},{key:"item17",align:"center",title:"14-15"},{key:"item18",align:"center",title:"15-16"},{key:"item19",align:"center",title:"16-17"},{key:"item20",align:"center",title:"17-18"},{key:"item21",align:"center",title:"18-19"},{key:"item22",align:"center",title:"19-20"},{key:"item23",align:"center",title:"20-21"},{key:"item24",align:"center",title:"21-22"},{key:"item25",align:"center",title:"22-23"},{key:"item26",align:"center",title:"23-24"},{key:"item27",align:"center",title:"合計"}];let g=[],k="",f=[];const $=(r,s,c)=>{g=[],k="",f=[],g=[...r],k=c,s.forEach(_=>{f.push(_.title)})},z=async()=>{try{const r="https://report.youbike.com.tw/isauth/gcpfun";let s={dataset_id:"yb2",table_id:"CTI_person_work",date:v.value,city:m.value,sys:u.value};y.value=!0;const _=(await I.get(r,{params:s})).data.data;let T=[];_.forEach(e=>{T.push({item1:e.AID,item2:e.name,item3:e.zero,item4:e.one,item5:e.two,item6:e.three,item7:e.four,item8:e.five,item9:e.six,item10:e.seven,item11:e.eight,item12:e.nine,item13:e.ten,item14:e.eleven,item15:e.twelve,item16:e.thirteen,item17:e.fourteen,item18:e.fifthteen,item19:e.sixteen,item20:e.seventeen,item21:e.eighteen,item22:e.nineteen,item23:e.twenty,item24:e.twenty_one,item25:e.twenty_two,item26:e.twenty_three,item27:e.total})}),p.value=[...T],$(p.value,b,"接聽通數統計"),y.value=!1}catch(r){console.log(r)}},E=async()=>{if(u.value==="請選擇")return h("請選擇系統別");if(m.value==="請選擇")return h("請選擇城市");if(!v.value)return h("請選擇日期");await z()};return(r,s)=>(i(),a("div",q,[w(t(A),{active:y.value,"onUpdate:active":s[0]||(s[0]=c=>y.value=c),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),K,o("form",{class:F(["row mx-0",{"report-header":!t(x),"report-header-dark":t(x)}])},[o("div",R,[Y,o("div",G,[D(o("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":s[1]||(s[1]=c=>u.value=c),onChange:s[2]||(s[2]=c=>m.value="請選擇")},W,544),[[N,u.value]])])]),o("div",X,[Z,o("div",ee,[D(o("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":s[3]||(s[3]=c=>m.value=c)},[te,u.value==2?(i(),a(M,{key:0},[t(l).includes(2)?(i(),a("option",ie," 台北市 ")):n("",!0),t(l).includes(3)?(i(),a("option",ae," 新北市 ")):n("",!0),t(l).includes(4)?(i(),a("option",oe," 桃園市 ")):n("",!0),t(l).includes(7)?(i(),a("option",se," 苗栗縣 ")):n("",!0),t(l).includes(5)?(i(),a("option",ne," 新竹市 ")):n("",!0),t(l).includes(6)?(i(),a("option",le," 新竹縣 ")):n("",!0),t(l).includes(8)?(i(),a("option",ce," 台中市 ")):n("",!0),t(l).includes(12)?(i(),a("option",re," 嘉義市 ")):n("",!0),t(l).includes(14)?(i(),a("option",ue," 台南市 ")):n("",!0),t(l).includes(15)?(i(),a("option",de," 高雄市 ")):n("",!0),t(l).includes(16)?(i(),a("option",me," 屏東縣 ")):n("",!0)],64)):u.value==1?(i(),a(M,{key:1},[t(l).includes(3)?(i(),a("option",_e," 新北市 ")):n("",!0),t(l).includes(4)?(i(),a("option",ye," 桃園縣 ")):n("",!0),t(l).includes(7)?(i(),a("option",pe," 苗栗縣 ")):n("",!0),t(l).includes(8)?(i(),a("option",ve," 台中市 ")):n("",!0)],64)):n("",!0)],512),[[N,m.value]])]),o("div",he,[w(t(H),{class:"px-0","formatted-value":v.value,"onUpdate:formattedValue":s[4]||(s[4]=c=>v.value=c),type:"date",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"請選擇日期","value-format":"yyyy-MM-dd","is-date-disabled":U},null,8,["formatted-value"])])]),o("div",ge,[o("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:E}," 搜尋 "),w(P,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:t(g),name:t(k),header:t(f)},null,8,["data","name","header"])])],2),p.value.length>1?(i(),L(t(j),{key:0,ref_key:"dataTable",ref:B,size:"small",pagination:{pageSize:17},columns:b,data:p.value,"max-height":600,"scroll-x":1200,bordered:!1,"single-line":!1,striped:""},null,8,["data"])):n("",!0)]))}};export{De as default};
