import{i as x,r as u,o as $,c as L,b as d,d as o,e as s,n as M,k as S,m as T,j as B}from"./index-9437428c.js";import{L as E}from"./index-181255ed.js";import{_ as j}from"./OutputExcel-f22009f0.js";import{N as z}from"./DatePicker-642088af.js";import{N as V}from"./DataTable-d29f5e06.js";import"./xlsx-bd534488.js";import"./Forward-a46dd4c7.js";import"./Input-3a828f95.js";import"./get-slot-1efb97e5.js";const A={class:"container-fluid px-0"},F=s("div",{class:"row mx-0"},[s("h1",{class:"report-h1 fw-bold"},"補助款月報")],-1),P={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},U={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},Y={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},X={__name:"SuportmonthMoney",setup(q){const _=x("$swal");async function b(a){_({icon:"error",title:`${a}`,showConfirmButton:!1})}const g=x("ischange"),r=u(),i=u(!1),c=u([]),v=u(null),y=[{key:"num1",align:"center",fixed:"left",title:"專案別"},{key:"num2",align:"center",title:"系統別"},{key:"num3",align:"center",title:"補助款項目"},{key:"num4",align:"center",title:"票卡"},{key:"num5",align:"center",title:"筆數"},{key:"num6",align:"center",title:"補助金額"},{key:"num7",align:"center",title:"單筆補助金額"}];let p=[],f="",h=[];const k=(a,e,n)=>{p=[],f="",h=[],p=[...a],f=n,e.forEach(l=>{h.push(l.title)})},w=a=>{const e=new Date(a),n=e.getFullYear(),l=e.getMonth()+1,t=new Date,m=t.getFullYear(),C=t.getMonth()+1;return n===m&&l>C||n>m||n<2023},N=async()=>{try{c.value=[],i.value=!0;const a="https://report.youbike.com.tw/isauth/gcpfun",e={dataset_id:"financial_report",table_id:"Subsidy",date:`${r.value}-01`},l=[...(await B.get(a,{params:e})).data.data];l.sort((t,m)=>t.rank-m.rank),l.forEach(t=>{c.value.push({num1:t.project,num2:t.sys,num3:t.item,num4:"ALL",num5:t.CNT,num6:t.CNT_money,num7:t.Subsidy})}),k(c.value,y,`${r.value}補助款月報`),v.value.page(1),i.value=!1}catch(a){console.log(a)}},D=()=>{if(!r.value)return b("請選擇日期");N()};return(a,e)=>($(),L("div",A,[d(o(E),{active:i.value,"onUpdate:active":e[0]||(e[0]=n=>i.value=n),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),F,s("form",{class:M(["row mx-0",{"report-header":!o(g),"report-header-dark":o(g)}])},[s("div",P,[s("div",U,[d(o(z),{class:"px-0","formatted-value":r.value,"onUpdate:formattedValue":e[1]||(e[1]=n=>r.value=n),type:"month",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"請選擇日期","value-format":"yyyy-MM","is-date-disabled":w},null,8,["formatted-value"])])]),s("div",Y,[s("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:D}," 搜尋 "),d(j,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:o(p),name:o(f),header:o(h)},null,8,["data","name","header"])])],2),S(d(o(V),{size:"small",data:c.value,ref_key:"dataTable",ref:v,columns:y,pagination:{pageSize:17},"max-height":600,"scroll-x":500,bordered:!1,"single-line":!1,striped:""},null,8,["data"]),[[T,c.value.length>1]])]))}};export{X as default};
