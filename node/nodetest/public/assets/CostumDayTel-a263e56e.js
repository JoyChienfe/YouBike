import{i as x,r as d,o as y,c as $,b as h,d as s,e as o,n as E,x as M,m as T,L as V,q as L,k as z}from"./index-1103b7f9.js";import{_ as F}from"./OutputExcel-6ed9633c.js";import{N as P}from"./DataTable-1e233750.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const U={class:"container-fluid px-0"},Y=o("div",{class:"row mx-0"},[o("h1",{class:"report-h1 fw-bold"},"補償券月報")],-1),j={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},q={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},A={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Q={__name:"CostumDayTel",setup(G){const v=x("ischange"),_=x("$swal");async function b(t){_({icon:"error",title:`${t}`,showConfirmButton:!1})}const w=d(null),i=d(!1),m=d([]),n=d(),k=t=>{const e=new Date(t),a=e.getFullYear(),r=e.getMonth()+1,c=new Date,l=c.getFullYear(),B=c.getMonth()+1;return a===l&&r>B||a>l||a<2023},g=[{key:"item1",align:"center",fixed:"left",title:"項目"},{key:"item2",align:"center",title:"使用縣市"},{key:"item3",align:"center",title:"車種"},{key:"item4",align:"center",title:"使用次數"},{key:"item5",align:"center",title:"使用金額"}];let u=[],f="",p=[];const N=(t,e,a)=>{u=[],f="",p=[],u=[...t],f=a,e.forEach(r=>{p.push(r.title)})},C=async()=>{try{const t="http://127.0.0.1:3000/isauth/gcpfun";let e={dataset_id:"report",table_id:"refund_report",date:n.value};i.value=!0;const r=(await z.get(t,{params:e})).data.data;let c=[];r.forEach(l=>{c.push({item1:l.item,item2:l.city,item3:l.sys,item4:l.numbers,item5:l.total})}),m.value=[...c],N(m.value,g,`${n.value}補償卷月報`),i.value=!1}catch(t){console.log(t)}},D=async()=>{if(!n.value)return b("請選擇日期");await C()};return(t,e)=>(y(),$("div",U,[h(s(V),{active:i.value,"onUpdate:active":e[0]||(e[0]=a=>i.value=a),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),Y,o("form",{class:E(["row mx-0",{"report-header":!s(v),"report-header-dark":s(v)}])},[o("div",j,[o("div",q,[h(s(L),{class:"px-0","formatted-value":n.value,"onUpdate:formattedValue":e[1]||(e[1]=a=>n.value=a),type:"month",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"請選擇日期","value-format":"yyyy-MM","is-date-disabled":k},null,8,["formatted-value"])])]),o("div",A,[o("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:D}," 搜尋 "),h(F,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:s(u),name:s(f),header:s(p)},null,8,["data","name","header"])])],2),m.value.length>1?(y(),M(s(P),{key:0,ref_key:"dataTable",ref:w,size:"small",columns:g,data:m.value,"scroll-x":500,bordered:!1,"single-line":!1,striped:""},null,8,["data"])):T("",!0)]))}};export{Q as default};
