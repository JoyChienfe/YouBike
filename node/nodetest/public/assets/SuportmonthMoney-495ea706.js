import{i as x,r as m,o as $,c as L,b as d,d as l,e as s,n as M,l as S,p as T,L as B,q as E,k as z}from"./index-7ad65401.js";import{_ as V}from"./OutputExcel-41bca93a.js";import{N as j}from"./DataTable-c0cf6f94.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const A={class:"container-fluid px-0"},F=s("div",{class:"row mx-0"},[s("h1",{class:"report-h1 fw-bold"},"補助款月報")],-1),P={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},U={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},Y={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},O={__name:"SuportmonthMoney",setup(q){const _=x("$swal");async function b(a){_({icon:"error",title:`${a}`,showConfirmButton:!1})}const g=x("ischange"),r=m(),i=m(!1),c=m([]),v=m(null),y=[{key:"num1",align:"center",fixed:"left",title:"專案別"},{key:"num2",align:"center",title:"系統別"},{key:"num3",align:"center",title:"補助款項目"},{key:"num4",align:"center",title:"票卡"},{key:"num5",align:"center",title:"筆數"},{key:"num6",align:"center",title:"補助金額"},{key:"num7",align:"center",title:"單筆補助金額"}];let p=[],f="",h=[];const k=(a,e,n)=>{p=[],f="",h=[],p=[...a],f=n,e.forEach(o=>{h.push(o.title)})},w=a=>{const e=new Date(a),n=e.getFullYear(),o=e.getMonth()+1,t=new Date,u=t.getFullYear(),C=t.getMonth()+1;return n===u&&o>C||n>u||n<2023},N=async()=>{try{c.value=[],i.value=!0;const a="https://report.youbike.com.tw/isauth/gcpfun",e={dataset_id:"financial_report",table_id:"Subsidy",date:`${r.value}-01`},o=[...(await z.get(a,{params:e})).data.data];o.sort((t,u)=>t.rank-u.rank),o.forEach(t=>{c.value.push({num1:t.project,num2:t.sys,num3:t.item,num4:"ALL",num5:t.CNT,num6:t.CNT_money,num7:t.Subsidy})}),k(c.value,y,`${r.value}補助款月報`),v.value.page(1),i.value=!1}catch(a){console.log(a)}},D=()=>{if(!r.value)return b("請選擇日期");N()};return(a,e)=>($(),L("div",A,[d(l(B),{active:i.value,"onUpdate:active":e[0]||(e[0]=n=>i.value=n),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),F,s("form",{class:M(["row mx-0",{"report-header":!l(g),"report-header-dark":l(g)}])},[s("div",P,[s("div",U,[d(l(E),{class:"px-0","formatted-value":r.value,"onUpdate:formattedValue":e[1]||(e[1]=n=>r.value=n),type:"month",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"請選擇日期","value-format":"yyyy-MM","is-date-disabled":w},null,8,["formatted-value"])])]),s("div",Y,[s("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:D}," 搜尋 "),d(V,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:l(p),name:l(f),header:l(h)},null,8,["data","name","header"])])],2),S(d(l(j),{size:"small",data:c.value,ref_key:"dataTable",ref:v,columns:y,pagination:{pageSize:17},"max-height":600,"scroll-x":500,bordered:!1,"single-line":!1,striped:""},null,8,["data"]),[[T,c.value.length>1]])]))}};export{O as default};
