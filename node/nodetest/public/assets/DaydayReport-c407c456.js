import{i as _,r,o as $,c as B,b as d,d as l,e as s,n as E,k as z,m as C,j as L}from"./index-3459458a.js";import{L as T}from"./index-fcaa1a70.js";import{_ as V}from"./OutputExcel-14eb8bfa.js";import{N as Y}from"./DatePicker-0f56cdd4.js";import{N as j}from"./DataTable-83b67cc2.js";import"./xlsx-bd534488.js";import"./Forward-c5c87e0a.js";import"./Input-c173e393.js";import"./get-slot-1efb97e5.js";const F={class:"container-fluid px-0"},S=s("div",{class:"row mx-0"},[s("h1",{class:"report-h1 fw-bold"}," 各專案N天以上卡數達成率(每月5號更新資料) ")],-1),U={class:"row mx-0 mx-md-2 align-items-center col-md-2 col-12 mt-3 mt-md-0"},A={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},W={__name:"DaydayReport",setup(P){const y=_("$swal");async function w(e){y({icon:"error",title:`${e}`,showConfirmButton:!1})}const g=_("ischange"),c=r(!1),o=r([]),x=r(null),i=r();let p=[],f="",h=[];const b=e=>{const a=new Date(e).getFullYear(),v=new Date().getFullYear();return a<2022||a>v},m=r([]);(()=>{m.value.push({key:"item",align:"center",fixed:"left",title:"項目",width:200});for(let e=1;e<=12;e++)m.value.push({key:`month${e}`,align:"center",title:`${e}月`})})();const k=(e,t,a)=>{p=[],f="",h=[],p=[...e],f=a,t.forEach(n=>{h.push(n.title)})},N=async()=>{try{o.value=[],c.value=!0;const e="https://report.youbike.com.tw/isauth/gcpfun",t={dataset_id:"data_analysis",table_id:"tan_tan_1",date:i.value};(await L.get(e,{params:t})).data.data.forEach((n,v)=>{o.value.push({item:n.item});for(let u=1;u<=12;u++)o.value[v][`month${u}`]=n[`month${u}`]}),k(o.value,m.value,"各專案N天以上卡數達成率"),x.value.page(1),c.value=!1}catch(e){console.log(e)}},D=()=>{if(!i.value)return w("請選擇日期");N()};return(e,t)=>($(),B("div",F,[d(l(T),{active:c.value,"onUpdate:active":t[0]||(t[0]=a=>c.value=a),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),S,s("form",{class:E(["row mx-0",{"report-header":!l(g),"report-header-dark":l(g)}])},[s("div",U,[d(l(Y),{class:"px-0","formatted-value":i.value,"onUpdate:formattedValue":t[1]||(t[1]=a=>i.value=a),type:"year",actions:null,"input-readonly":!0,"is-date-disabled":b,placeholder:"請選擇日期","value-format":"yyyy"},null,8,["formatted-value"])]),s("div",A,[s("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:D}," 搜尋 "),d(V,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:l(p),name:l(f),header:l(h)},null,8,["data","name","header"])])],2),z(d(l(j),{ref_key:"dataTable",ref:x,columns:m.value,data:o.value,pagination:{pageSize:20},"max-height":600,"scroll-x":1300,size:"small",bordered:!1,"single-line":!1,striped:""},null,8,["columns","data"]),[[C,o.value.length>1]])]))}};export{W as default};
