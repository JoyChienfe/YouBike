import{u as S,i as C,r as d,o as i,c as s,b as w,d as t,e as a,k as D,v as N,F as V,l as n,n as F,s as L,j}from"./index-9437428c.js";import{L as A}from"./index-181255ed.js";import{_ as H}from"./OutputExcel-f22009f0.js";import{N as I}from"./DatePicker-642088af.js";import{N as P}from"./DataTable-d29f5e06.js";import"./xlsx-bd534488.js";import"./Forward-a46dd4c7.js";import"./Input-3a828f95.js";import"./get-slot-1efb97e5.js";const K={class:"container-fluid px-0"},R=a("div",{class:"row mx-0"},[a("h1",{class:"report-h1 fw-bold"},"接聽通數統計")],-1),Y={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},q=a("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"系統別:",-1),G={class:"col-md-auto px-0"},J=a("option",{selected:"",disabled:""},"請選擇",-1),O=a("option",{value:"1.0"},"1.0",-1),Q=a("option",{value:"2.0"},"2.0",-1),W=[J,O,Q],X={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Z=a("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"城市:",-1),ee={class:"col-md-auto px-0"},te=a("option",{selected:"",disabled:""},"請選擇",-1),ie={key:0,value:"Taipei_two"},ae={key:1,value:"NewTaipei_two"},oe={key:2,value:"Taoyuan_two"},se={key:3,value:"Hsinchu_two"},ne={key:4,value:"HsinchuCountry_two"},le={key:5,value:"Taichung_two"},ce={key:6,value:"Chiayi"},re={key:7,value:"Tainan"},ue={key:8,value:"Kaohsiung"},de={key:9,value:"Pingtung"},me={key:0,value:"NewTaipei_one"},ye={key:1,value:"Taoyuan"},_e={key:2,value:"Miaoli_one"},pe={key:3,value:"Taichung_one"},ve={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},ge={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Be={__name:"CostumdayReporttelnum",setup(he){const c=S().citys,x=C("ischange"),B=C("$swal");async function g(r){B({icon:"error",title:`${r}`,showConfirmButton:!1})}const M=d(null),m=d("請選擇"),u=d("請選擇"),_=d(!1),p=d([]),v=d(),U=r=>{const o=new Date(r),l=new Date,y=new Date(l.getFullYear(),l.getMonth(),l.getDate());return o<new Date(2023,7,8)||o>=y},b=[{key:"item1",align:"center",fixed:"left",title:"員工編號",width:100},{key:"item2",align:"center",title:"姓名",width:100},{key:"item3",align:"center",title:"0-1"},{key:"item4",align:"center",title:"1-2"},{key:"item5",align:"center",title:"2-3"},{key:"item6",align:"center",title:"3-4"},{key:"item7",align:"center",title:"4-5"},{key:"item8",align:"center",title:"5-6"},{key:"item9",align:"center",title:"6-7"},{key:"item10",align:"center",title:"7-8"},{key:"item11",align:"center",title:"8-9"},{key:"item12",align:"center",title:"9-10"},{key:"item13",align:"center",title:"10-11"},{key:"item14",align:"center",title:"11-12"},{key:"item15",align:"center",title:"12-13"},{key:"item16",align:"center",title:"13-14"},{key:"item17",align:"center",title:"14-15"},{key:"item18",align:"center",title:"15-16"},{key:"item19",align:"center",title:"16-17"},{key:"item20",align:"center",title:"17-18"},{key:"item21",align:"center",title:"18-19"},{key:"item22",align:"center",title:"19-20"},{key:"item23",align:"center",title:"20-21"},{key:"item24",align:"center",title:"21-22"},{key:"item25",align:"center",title:"22-23"},{key:"item26",align:"center",title:"23-24"},{key:"item27",align:"center",title:"合計"}];let h=[],k="",f=[];const $=(r,o,l)=>{h=[],k="",f=[],h=[...r],k=l,o.forEach(y=>{f.push(y.title)})},z=async()=>{try{const r="https://report.youbike.com.tw/isauth/gcpfun";let o={dataset_id:"yb2",table_id:"CTI_person_work",date:v.value,city:m.value,sys:u.value};_.value=!0;const y=(await j.get(r,{params:o})).data.data;let T=[];y.forEach(e=>{T.push({item1:e.AID,item2:e.name,item3:e.zero,item4:e.one,item5:e.two,item6:e.three,item7:e.four,item8:e.five,item9:e.six,item10:e.seven,item11:e.eight,item12:e.nine,item13:e.ten,item14:e.eleven,item15:e.twelve,item16:e.thirteen,item17:e.fourteen,item18:e.fifthteen,item19:e.sixteen,item20:e.seventeen,item21:e.eighteen,item22:e.nineteen,item23:e.twenty,item24:e.twenty_one,item25:e.twenty_two,item26:e.twenty_three,item27:e.total})}),p.value=[...T],$(p.value,b,"接聽通數統計"),_.value=!1}catch(r){console.log(r)}},E=async()=>{if(u.value==="請選擇")return g("請選擇系統別");if(m.value==="請選擇")return g("請選擇城市");if(!v.value)return g("請選擇日期");await z()};return(r,o)=>(i(),s("div",K,[w(t(A),{active:_.value,"onUpdate:active":o[0]||(o[0]=l=>_.value=l),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),R,a("form",{class:F(["row mx-0",{"report-header":!t(x),"report-header-dark":t(x)}])},[a("div",Y,[q,a("div",G,[D(a("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":o[1]||(o[1]=l=>u.value=l),onChange:o[2]||(o[2]=l=>m.value="請選擇")},W,544),[[N,u.value]])])]),a("div",X,[Z,a("div",ee,[D(a("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":o[3]||(o[3]=l=>m.value=l)},[te,u.value==2?(i(),s(V,{key:0},[t(c).includes(2)?(i(),s("option",ie," 台北市 ")):n("",!0),t(c).includes(3)?(i(),s("option",ae," 新北市 ")):n("",!0),t(c).includes(4)?(i(),s("option",oe," 桃園市 ")):n("",!0),t(c).includes(5)?(i(),s("option",se," 新竹市 ")):n("",!0),t(c).includes(6)?(i(),s("option",ne," 新竹縣 ")):n("",!0),t(c).includes(8)?(i(),s("option",le," 台中市 ")):n("",!0),t(c).includes(12)?(i(),s("option",ce," 嘉義市 ")):n("",!0),t(c).includes(14)?(i(),s("option",re," 台南市 ")):n("",!0),t(c).includes(15)?(i(),s("option",ue," 高雄市 ")):n("",!0),t(c).includes(16)?(i(),s("option",de," 屏東縣 ")):n("",!0)],64)):u.value==1?(i(),s(V,{key:1},[t(c).includes(3)?(i(),s("option",me," 新北市 ")):n("",!0),t(c).includes(4)?(i(),s("option",ye," 桃園縣 ")):n("",!0),t(c).includes(7)?(i(),s("option",_e," 苗栗縣 ")):n("",!0),t(c).includes(8)?(i(),s("option",pe," 台中市 ")):n("",!0)],64)):n("",!0)],512),[[N,m.value]])]),a("div",ve,[w(t(I),{class:"px-0","formatted-value":v.value,"onUpdate:formattedValue":o[4]||(o[4]=l=>v.value=l),type:"date",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"請選擇日期","value-format":"yyyy-MM-dd","is-date-disabled":U},null,8,["formatted-value"])])]),a("div",ge,[a("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:E}," 搜尋 "),w(H,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:t(h),name:t(k),header:t(f)},null,8,["data","name","header"])])],2),p.value.length>1?(i(),L(t(P),{key:0,ref_key:"dataTable",ref:M,size:"small",pagination:{pageSize:17},columns:b,data:p.value,"max-height":600,"scroll-x":1200,bordered:!1,"single-line":!1,striped:""},null,8,["data"])):n("",!0)]))}};export{Be as default};
