import{i as y,r as i,o as B,c as C,b as d,d as s,e as l,n as E,k as L,m as S,j as z}from"./index-3459458a.js";import{L as F}from"./index-fcaa1a70.js";import{_ as T}from"./OutputExcel-14eb8bfa.js";import{N as V}from"./DatePicker-0f56cdd4.js";import{N as Y}from"./DataTable-83b67cc2.js";import"./xlsx-bd534488.js";import"./Forward-c5c87e0a.js";import"./Input-c173e393.js";import"./get-slot-1efb97e5.js";const j={class:"container-fluid px-0"},P=l("div",{class:"row mx-0"},[l("h1",{class:"report-h1 fw-bold"},"每月新增會員投保數")],-1),U={class:"row mx-0 mx-md-2 align-items-center col-md-auto"},A={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},X={__name:"NewmemberMonthReport",setup(R){const v=y("ischange"),w=y("$swal");async function _(a){w({icon:"error",title:`${a}`,showConfirmButton:!1})}const p=i([]),c=i(!1),b=i(),m=i([]),u=i(D());let f=[],h="",g=[];const k=(a,e,t)=>{f=[],g=[],h="",f=[...a],h=t,e.forEach(n=>{g.push(n.title)})};function D(){const a=new Date;let e=a.getFullYear(),t=a.getMonth();return t===0?(e--,t=11):t--,t=(t+1).toString().padStart(2,"0"),`${e}-${t}`}const N=a=>{const e=new Date(a),t=e.getFullYear(),n=e.getMonth()+1,r=new Date,o=r.getFullYear(),x=r.getMonth()+1;return t<2023||t>o||t===o&&n>x||t===o&&n>=x};p.value=[{key:"item1",align:"center",title:"縣市"},{key:"item2",align:"center",title:"新增會員卡投保數"},{key:"item3",align:"center",title:"新增註冊卡數"},{key:"item4",align:"center",title:"投保率"}];const M=async()=>{try{c.value=!0;const a="https://report.youbike.com.tw/isauth/gcpfun";let e={dataset_id:"report",table_id:"month_insur",date:u.value};const n=(await z.get(a,{params:e})).data.data;let r=[];n.forEach(o=>{r.push({item1:o.city,item2:o.insur,item3:o.total,item4:o.percentage})}),m.value=[...r],k(m.value,p.value,"每月新增會員投保數"),c.value=!1}catch(a){console.log(a)}},$=()=>{if(!u.value){_("日期不能為空");return}M()};return(a,e)=>(B(),C("div",j,[d(s(F),{active:c.value,"onUpdate:active":e[0]||(e[0]=t=>c.value=t),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),P,l("form",{class:E(["row mx-0",{"report-header":!s(v),"report-header-dark":s(v)}])},[l("div",U,[d(s(V),{class:"px-0","formatted-value":u.value,"onUpdate:formattedValue":e[1]||(e[1]=t=>u.value=t),type:"month",actions:null,"update-value-on-close":"","is-date-disabled":N,"value-format":"yyyy-MM"},null,8,["formatted-value"])]),l("div",A,[l("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:$}," 搜尋 "),d(T,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:s(f),name:s(h),header:s(g)},null,8,["data","name","header"])])],2),L(d(s(Y),{ref_key:"dataTable",ref:b,data:m.value,columns:p.value,pagination:{pageSize:15},"max-height":500,"scroll-x":300,size:"small",bordered:!1,"single-line":!1,striped:""},null,8,["data","columns"]),[[S,m.value.length]])]))}};export{X as default};
