import{i as H,u as j,r as m,o as l,c as n,b as h,d as e,e as c,l as S,v as N,F as C,m as u,n as q,p as R,L as G,y as I,q as U,k as J}from"./index-1377d8f9.js";import{_ as K}from"./OutputExcel-bd81d639.js";import{N as O}from"./DataTable-750ad636.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const Q={class:"container-fluid px-0"},W=c("div",{class:"row mx-0"},[c("h1",{class:"report-h1 fw-bold"},"yb2騎乘時間查詢")],-1),X={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Y=c("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"系統別:",-1),Z={class:"col-md-auto px-0"},ee=c("option",{selected:"",disabled:""},"請選擇",-1),te=c("option",{value:"2.0"},"2.0",-1),se=c("option",{value:"2.0E"},"2.0E",-1),ae=[ee,te,se],oe={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},le=c("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"城市:",-1),ne={class:"col-md-auto px-0"},ce=c("option",{selected:"",disabled:""},"請選擇",-1),ue={key:0,selected:"",value:"台北市"},ie={key:1,selected:"",value:"新北市"},de={key:2,selected:"",value:"桃園市"},re={key:3,selected:"",value:"新竹市"},me={key:4,selected:"",value:"新竹縣"},ve={key:5,selected:"",value:"苗栗縣"},_e={key:6,selected:"",value:"台中市"},pe={key:7,selected:"",value:"嘉義市"},he={key:8,selected:"",value:"嘉義縣"},fe={key:9,selected:"",value:"台南市"},ye={key:10,selected:"",value:"高雄市"},ge={key:11,selected:"",value:"屏東縣"},xe={key:0,selected:"",value:"桃園市"},be={key:1,selected:"",value:"新竹縣"},ke={key:2,selected:"",value:"苗栗縣"},De={key:3,selected:"",value:"台中市"},we={key:4,selected:"",value:"嘉義市"},Se={key:5,selected:"",value:"嘉義縣"},Ve={key:6,selected:"",value:"台南市"},Ee={key:7,selected:"",value:"高雄市"},He={key:8,selected:"",value:"屏東縣"},Ne=c("div",{class:"row align-items-center col-md-auto col-12 pe-0"},[c("label",{class:"col-md-auto col-form-label fw-bolder pe-0"},"項目:")],-1),Ce={class:"row mx-0 ms-md-2 align-items-center col-md-2 col-12 me-0"},Ue={class:"row mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},$e={class:"row mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},Me={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},je={__name:"RidetimeSearch",setup(ze){const V=H("ischange"),i=j().citys,$=H("$swal");async function f(d){$({icon:"error",title:`${d}`,showConfirmButton:!1})}const x=m(!1),y=m([]),v=m(),_=m(),g=m("請選擇"),M=m(null),p=m("請選擇"),E=[{key:"num1",align:"center",fixed:"left",width:150,title:"縣市"},{key:"num2",align:"center",title:"鄉鎮市區"},{key:"num3",align:"center",title:"同站／跨站"},{key:"num4",align:"center",title:"費率別"},{key:"num5",align:"center",title:"騎乘時間"},{key:"num6",align:"center",title:"次數"}];let k=[],D="",w=[];const z=(d,o,s)=>{k=[],D="",w=[],k=[...d],D=s,o.forEach(t=>{w.push(t.title)})},A=d=>{const o=_.value,s=new Date;if(s.setHours(0,0,0,0),o){const t=new Date(o);t.setHours(0,0,0,0);const a=new Date(t);a.setDate(a.getDate()-30);const r=new Date(d);if(r.setHours(0,0,0,0),r<a||r>t||r>=s)return!0}else{const t=new Date(d);if(t.setHours(0,0,0,0),t>=s)return!0}},B=d=>{const o=v.value,s=new Date;if(s.setHours(0,0,0,0),o){const t=new Date(o);if(t.setHours(0,0,0,0),t>s)return!0;const a=new Date(t);a.setDate(a.getDate()+30);const r=new Date(d);if(r.setHours(0,0,0,0),r<t||r>a||r>=s)return!0}else{const t=new Date(d);if(t.setHours(0,0,0,0),t>=s)return!0}},P=()=>{v.value=null,_.value=null},L=[{label:"同站借還",value:"同站借還"},{label:"跨站借還",value:"跨站借還"}],b=m([]),T=async()=>{try{x.value=!0,y.value=[];const d="https://report.youbike.com.tw/isauth/gcpfun",o={dataset_id:"report",table_id:"rent_minute_report2",begin_date:v.value,end_date:_.value,city:`${g.value}${p.value}`,item:b.value},s=await J.get(d,{params:o});console.log(s.data.data);let t=[];s.data.data.forEach((a,r)=>{if(r==0){t.push({num1:a.city,num2:a.SxPSArea,num3:a.same_station,num4:a.rate_info,num5:a.rent_minute,num6:a.times});return}t[t.length-1].num2==a.SxPSArea&&t[t.length-1].num3==a.same_station&&t[t.length-1].num4==a.rate_info&&t[t.length-1].num5==a.rent_minute?t[t.length-1].num6+=a.times:t.push({num1:a.city,num2:a.SxPSArea,num3:a.same_station,num4:a.rate_info,num5:a.rent_minute,num6:a.times})}),y.value=[...t],x.value=!1,z(y.value,E,"yb2騎乘時間查詢")}catch(d){console.log(d)}},F=()=>{if(p.value==="請選擇")return f("請選擇系統別");if(g.value=="請選擇")return f("請選擇城市");if(b.value.length===0)return f("請選擇項目");if(v.value){if(!_.value)return f("請選擇結束日期")}else return f("請選擇開始日期");T()};return(d,o)=>(l(),n("div",Q,[h(e(G),{active:x.value,"onUpdate:active":o[0]||(o[0]=s=>x.value=s),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),W,c("form",{class:q(["row mx-0",{"report-header":!e(V),"report-header-dark":e(V)}])},[c("div",X,[Y,c("div",Z,[S(c("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":o[1]||(o[1]=s=>p.value=s),onChange:o[2]||(o[2]=s=>g.value="請選擇")},ae,544),[[N,p.value]])])]),c("div",oe,[le,c("div",ne,[S(c("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":o[3]||(o[3]=s=>g.value=s)},[ce,p.value==="2.0"?(l(),n(C,{key:0},[e(i).includes(2)?(l(),n("option",ue," 台北市 ")):u("",!0),e(i).includes(3)?(l(),n("option",ie," 新北市 ")):u("",!0),e(i).includes(4)?(l(),n("option",de," 桃園市 ")):u("",!0),e(i).includes(5)?(l(),n("option",re," 新竹市 ")):u("",!0),e(i).includes(6)?(l(),n("option",me," 新竹縣 ")):u("",!0),e(i).includes(7)?(l(),n("option",ve," 苗栗縣 ")):u("",!0),e(i).includes(8)?(l(),n("option",_e," 台中市 ")):u("",!0),e(i).includes(12)?(l(),n("option",pe," 嘉義市 ")):u("",!0),e(i).includes(13)?(l(),n("option",he," 嘉義縣 ")):u("",!0),e(i).includes(14)?(l(),n("option",fe," 台南市 ")):u("",!0),e(i).includes(15)?(l(),n("option",ye," 高雄市 ")):u("",!0),e(i).includes(16)?(l(),n("option",ge," 屏東縣 ")):u("",!0)],64)):p.value==="2.0E"?(l(),n(C,{key:1},[e(i).includes(4)?(l(),n("option",xe," 桃園市 ")):u("",!0),e(i).includes(6)?(l(),n("option",be," 新竹縣 ")):u("",!0),e(i).includes(7)?(l(),n("option",ke," 苗栗縣 ")):u("",!0),e(i).includes(8)?(l(),n("option",De," 台中市 ")):u("",!0),e(i).includes(12)?(l(),n("option",we," 嘉義市 ")):u("",!0),e(i).includes(13)?(l(),n("option",Se," 嘉義縣 ")):u("",!0),e(i).includes(14)?(l(),n("option",Ve," 台南市 ")):u("",!0),e(i).includes(15)?(l(),n("option",Ee," 高雄市 ")):u("",!0),e(i).includes(16)?(l(),n("option",He," 屏東縣 ")):u("",!0)],64)):u("",!0)],512),[[N,g.value]])])]),Ne,c("div",Ce,[h(e(I),{class:"px-0",value:b.value,"onUpdate:value":o[4]||(o[4]=s=>b.value=s),placeholder:"請選擇",multiple:"",options:L,"max-tag-count":1,size:"medium"},null,8,["value"])]),c("div",Ue,[h(e(U),{class:"px-0","formatted-value":v.value,"onUpdate:formattedValue":o[5]||(o[5]=s=>v.value=s),type:"date",actions:null,"is-date-disabled":A,"update-value-on-close":"",placeholder:"開始日期","value-format":"yyyy-MM-dd"},null,8,["formatted-value"])]),c("div",$e,[h(e(U),{class:"px-0","formatted-value":_.value,"onUpdate:formattedValue":o[6]||(o[6]=s=>_.value=s),type:"date",actions:null,"is-date-disabled":B,"update-value-on-close":"",placeholder:"結束日期","value-format":"yyyy-MM-dd"},null,8,["formatted-value"])]),c("div",Me,[c("button",{type:"button",class:"btn btn-info text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:P}," 清空日期 "),c("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:F}," 搜尋 "),h(K,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:e(k),name:e(D),header:e(w)},null,8,["data","name","header"])])],2),S(h(e(O),{ref_key:"dataTable",ref:M,data:y.value,columns:E,size:"small",pagination:{pageSize:17},"max-height":600,"scroll-x":500,bordered:!1,"single-line":!1,striped:""},null,8,["data"]),[[R,y.value.length>0]])]))}};export{je as default};
