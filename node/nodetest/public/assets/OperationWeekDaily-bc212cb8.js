import{_ as P,u as j,i as S,r as p,o as t,c as o,b as w,d as e,e as c,l as M,v as O,F as N,m as s,n as q,x as K,L as Y,q as A,s as G,t as J,k as Q}from"./index-2bed0a42.js";import{_ as R}from"./OutputExcel-3a33b057.js";import{N as X}from"./DataTable-04116403.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const r=k=>(G("data-v-2bd25725"),k=k(),J(),k),Z={class:"container-fluid px-0"},ee=r(()=>c("div",{class:"row mx-0"},[c("h1",{class:"report-h1 fw-bold"},"營運管理週報")],-1)),te={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},oe=r(()=>c("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"系統別:",-1)),ae={class:"col-md-auto px-0"},se=r(()=>c("option",{selected:"",disabled:""},"請選擇",-1)),le=r(()=>c("option",{value:"1"},"1.0",-1)),ne=r(()=>c("option",{value:"2"},"2.0",-1)),ie=r(()=>c("option",{value:"2E"},"2.0E",-1)),ce=[se,le,ne,ie],ue={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},de=r(()=>c("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"城市:",-1)),re={class:"col-md-auto px-0"},me=r(()=>c("option",{selected:"",disabled:""},"請選擇",-1)),_e={key:0,value:"Taipei2"},pe={key:1,value:"Newtaipei2"},he={key:2,value:"Taoyuan2"},ve={key:3,value:"Hsinchu2"},ye={key:4,value:"Hsinchu_Country2"},fe={key:5,value:"HsinchuScience2"},ke={key:6,value:"Miaoli2"},ge={key:7,value:"Taichung2"},xe={key:8,value:"Chiayi2"},be={key:9,value:"Chiayi_Country2"},Ee={key:10,value:"Tainan2"},De={key:11,value:"Kaohsiung2"},Ce={key:12,value:"Pingtung2"},Te={key:13,value:"Taitung2"},we={key:0,value:"Newtaipei"},Ne={key:1,value:"Taoyuan"},$e={key:2,value:"Miaoli"},Se={key:0,value:"Taipei2E"},Me={key:1,value:"Newtaipei2E"},Oe={key:2,value:"Taoyuan2E"},Ve={key:3,value:"Hsinchu_Country2E"},Be={key:4,value:"HsinchuScience2E"},He={key:5,value:"Miaoli2E"},Ue={key:6,value:"Taichung2E"},We={key:7,value:"Chiayi2E"},Fe={key:8,value:"Chiayi_Country2E"},Ie={key:9,value:"Tainan2E"},ze={key:10,value:"Kaohsiung2E"},Le={key:11,value:"Pingtung2E"},Pe={key:12,value:"Taitung2E"},je={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},qe={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Ke={__name:"OperationWeekDaily",setup(k){const l=j().citys,$=S("ischange"),V=S("$swal");async function E(a){V({icon:"error",title:`${a}`,showConfirmButton:!1})}const B=p(null),y=p("請選擇"),m=p("請選擇"),f=p(!1),g=p([]),h=p([]),x=p(),H=a=>{const n=new Date(a),i=new Date,u=new Date(i.getFullYear(),i.getMonth(),i.getDate()),d=new Date(u);d.setDate(u.getDate()-(u.getDay()||7)+1);const _=n.getDay();return n>=d||_!==1||n.getFullYear()<2023};let D=[],C="",T=[];const U=(a,n,i)=>{D=[],C="",T=[];const u=[];a.forEach((d,_)=>{u.push([]);for(let v=1;v<=Object.keys(d).length;v++)u[_].push(d[`item${v}`])}),D=[...u],C=i,n.forEach(d=>{T.push(d.title)})},W=a=>{console.log("mackcol"),g.value=[];let n=[];n=a.filter((u,d)=>d!==4),console.log(n),n.push(a[4]);let i=[];n.forEach((u,d)=>{i.push({key:`item${d+1}`,align:"center",title:u[2]}),d===0&&(i[i.length-1].fixed="left")}),g.value=[...i]},F=a=>{console.log("mackdata"),h.value=[];let n=[];n=a.filter((d,_)=>_!==4),n.push(a[4]);let i=n[0].length-2,u=[];for(let d=1;d<=i;d++)u.push({});n.forEach((d,_)=>{d.forEach((v,b)=>{b===0||b===1||b===2||(u[b-3][`item${_+1}`]=v)})}),h.value=[...u]},I=async()=>{const a="https://report.youbike.com.tw/isauth/gcpfun";let n={dataset_id:"report",table_id:`weekly_report_query${m.value}`,date:x.value,city:[y.value]};f.value=!0;const i=await Q.get(a,{params:n}),{data:u}=i.data;if(u.length===0){h.value=[],f.value=!1;return}console.log(1),W([...u[0]]),F([...u[0]]),f.value=!1,U(h.value,g.value,"營運管理週報")},z=async()=>{if(m.value=="請選擇"){E("系統別不能為空");return}else if(y.value=="請選擇"){E("城市不能為空");return}else if(x.value===void 0){E("日期不能為空");return}await I()},L=a=>{if(a.item1==="場站資訊"||a.item1==="租借資訊"||a.item1==="收入資訊"||a.item1==="妥善率資訊"||a.item1==="票卡資訊"||a.item1==="當週租借車次"||a.item1==="註冊票卡淨增加數"&&!a.item2||a.item1==="各時段使用資訊"||a.item1==="租賃收入明細"||a.item1==="當週/日租借車次"&&!a.item2||a.item1==="租賃時間使用資訊"||a.item1==="維護管理"||a.item1==="調度管理"||a.item1==="營運資訊"||a.item1==="騎乘距離分析"||a.item1==="當日租借車次")return"too-old"};return(a,n)=>(t(),o("div",Z,[w(e(Y),{active:f.value,"onUpdate:active":n[0]||(n[0]=i=>f.value=i),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),ee,c("form",{class:q(["row mx-0",{"report-header":!e($),"report-header-dark":e($)}])},[c("div",te,[oe,c("div",ae,[M(c("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":n[1]||(n[1]=i=>m.value=i),onChange:n[2]||(n[2]=i=>y.value="請選擇")},ce,544),[[O,m.value]])])]),c("div",ue,[de,c("div",re,[M(c("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":n[3]||(n[3]=i=>y.value=i)},[me,m.value==2?(t(),o(N,{key:0},[e(l).includes(2)?(t(),o("option",_e,"台北市")):s("",!0),e(l).includes(3)?(t(),o("option",pe,"新北市")):s("",!0),e(l).includes(4)?(t(),o("option",he,"桃園市")):s("",!0),e(l).includes(5)?(t(),o("option",ve,"新竹市")):s("",!0),e(l).includes(6)?(t(),o("option",ye," 新竹縣 ")):s("",!0),e(l).includes(20)?(t(),o("option",fe," 竹科 ")):s("",!0),e(l).includes(7)?(t(),o("option",ke,"苗栗縣")):s("",!0),e(l).includes(8)?(t(),o("option",ge,"台中市")):s("",!0),e(l).includes(12)?(t(),o("option",xe,"嘉義市")):s("",!0),e(l).includes(13)?(t(),o("option",be," 嘉義縣 ")):s("",!0),e(l).includes(14)?(t(),o("option",Ee,"台南市")):s("",!0),e(l).includes(15)?(t(),o("option",De,"高雄市")):s("",!0),e(l).includes(16)?(t(),o("option",Ce,"屏東縣")):s("",!0),e(l).includes(19)?(t(),o("option",Te,"台東縣")):s("",!0)],64)):m.value==1?(t(),o(N,{key:1},[e(l).includes(3)?(t(),o("option",we,"新北市")):s("",!0),e(l).includes(4)?(t(),o("option",Ne,"桃園市")):s("",!0),e(l).includes(7)?(t(),o("option",$e,"苗栗縣")):s("",!0)],64)):m.value=="2E"?(t(),o(N,{key:2},[e(l).includes(2)?(t(),o("option",Se,"台北市")):s("",!0),e(l).includes(3)?(t(),o("option",Me,"新北市")):s("",!0),e(l).includes(4)?(t(),o("option",Oe,"桃園市")):s("",!0),e(l).includes(6)?(t(),o("option",Ve," 新竹縣 ")):s("",!0),e(l).includes(20)?(t(),o("option",Be," 竹科 ")):s("",!0),e(l).includes(7)?(t(),o("option",He,"苗栗縣")):s("",!0),e(l).includes(8)?(t(),o("option",Ue,"台中市")):s("",!0),e(l).includes(12)?(t(),o("option",We,"嘉義市")):s("",!0),e(l).includes(13)?(t(),o("option",Fe," 嘉義縣 ")):s("",!0),e(l).includes(14)?(t(),o("option",Ie,"台南市")):s("",!0),e(l).includes(15)?(t(),o("option",ze,"高雄市")):s("",!0),e(l).includes(16)?(t(),o("option",Le,"屏東縣")):s("",!0),e(l).includes(19)?(t(),o("option",Pe,"台東縣")):s("",!0)],64)):s("",!0)],512),[[O,y.value]])]),c("div",je,[w(e(A),{class:"px-0","formatted-value":x.value,"onUpdate:formattedValue":n[4]||(n[4]=i=>x.value=i),type:"date",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"請選每週一日期","value-format":"yyyy-MM-dd","is-date-disabled":H},null,8,["formatted-value"])])]),c("div",qe,[c("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:z}," 搜尋 "),w(R,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:e(D),name:e(C),header:e(T)},null,8,["data","name","header"])])],2),h.value.length>1?(t(),K(e(X),{key:0,ref_key:"dataTable",ref:B,size:"small","row-class-name":L,pagination:{pageSize:100},columns:g.value,data:h.value,"max-height":600,"scroll-x":1e3,bordered:!1,"single-line":!1,striped:""},null,8,["columns","data"])):s("",!0)]))}},Xe=P(Ke,[["__scopeId","data-v-2bd25725"]]);export{Xe as default};
