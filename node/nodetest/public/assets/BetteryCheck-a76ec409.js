import{i as V,u as A,r as m,o,c as l,b as _,d as e,e as d,l as C,v as P,m as r,n as F,p as G,L as I,q as N,k as J}from"./index-a5eda168.js";import{_ as K}from"./OutputExcel-9627298f.js";import{N as O}from"./DataTable-2051144f.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const Q={class:"container-fluid px-0"},R=d("div",{class:"row mx-0"},[d("h1",{class:"report-h1 fw-bold"},"2.0E電池狀況查詢")],-1),W={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},X=d("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"城市:",-1),Y={class:"col-md-auto px-0"},Z=d("option",{selected:"",disabled:""},"請選擇",-1),ee={key:0,value:"台北市2.0E"},te={key:1,value:"新北市2.0E"},ae={key:2,value:"桃園市2.0E"},se={key:3,value:"新竹2.0E"},oe={key:4,value:"竹縣2.0E"},le={key:5,value:"竹科2.0E"},ne={key:6,value:"苗栗縣2.0E"},ce={key:7,value:"台中市2.0E"},re={key:8,value:"嘉義市2.0E"},ue={key:9,value:"嘉義縣2.0E"},ie={key:10,value:"台南市2.0E"},de={key:11,value:"高雄市2.0E"},me={key:12,value:"屏東縣2.0E"},ve={key:13,value:"台東縣2.0E"},pe={class:"row mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},_e={class:"row mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},fe={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},ge={__name:"BetteryCheck",setup(he){const H=V("ischange"),n=A().citys,$=V("$swal");async function x(c){$({icon:"error",title:`${c}`,showConfirmButton:!1})}const f=m(!1),h=m([]),v=m(),p=m(),y=m("請選擇"),B=m(null),D=m([]);let b=[],w="",g=[];const M=(c,s,t)=>{b=[],w="",g=[],b=[...c],w=t,s.forEach(a=>{g.push(a.title)})},U=()=>{v.value=null,p.value=null},S=c=>{const s=p.value,t=new Date;if(t.setHours(0,0,0,0),s){const a=new Date(s);a.setHours(0,0,0,0);const u=new Date(a);u.setDate(u.getDate()-30);const i=new Date(c);if(i.setHours(0,0,0,0),i<u||i>a||i>=t)return!0}else{const a=new Date(c);if(a.setHours(0,0,0,0),a>=t)return!0}},z=c=>{const s=v.value,t=new Date;if(t.setHours(0,0,0,0),s){const a=new Date(s);if(a.setHours(0,0,0,0),a>t)return!0;const u=new Date(a);u.setDate(u.getDate()+30);const i=new Date(c);if(i.setHours(0,0,0,0),i<a||i>u||i>=t)return!0}else{const a=new Date(c);if(a.setHours(0,0,0,0),a>=t)return!0}},L=async()=>{try{f.value=!0;const c="https://report.youbike.com.tw/isauth/gcpfun",s={dataset_id:"data_analysis",table_id:"battery_analysis",begin_date:v.value,end_date:p.value,city:y.value},t=await J.get(c,{params:s}),a=t.data.data;console.log(t);const u=[];a[0].forEach((k,E)=>{u.push({key:`item${E+1}`,align:"center",title:k})}),u[0].fixed="left",u[0].width=100,u[1].width=210;let i=[];a.forEach((k,E)=>{E!==0&&(i.push({}),k.forEach((j,q)=>{i[E-1][`item${q+1}`]=j}))}),h.value=[...i],D.value=[...u],M(h.value,D.value,"2.0E電池狀況查詢"),f.value=!1}catch(c){console.log(c)}},T=()=>{if(y.value=="請選擇")return x("請選擇城市");if(v.value){if(!p.value)return x("請選擇結束日期")}else return x("請選擇開始日期");L()};return(c,s)=>(o(),l("div",Q,[_(e(I),{active:f.value,"onUpdate:active":s[0]||(s[0]=t=>f.value=t),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),R,d("form",{class:F(["row mx-0",{"report-header":!e(H),"report-header-dark":e(H)}])},[d("div",W,[X,d("div",Y,[C(d("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":s[1]||(s[1]=t=>y.value=t)},[Z,e(n).includes(2)?(o(),l("option",ee,"台北市2.0E")):r("",!0),e(n).includes(3)?(o(),l("option",te,"新北市2.0E")):r("",!0),e(n).includes(4)?(o(),l("option",ae,"桃園市2.0E")):r("",!0),e(n).includes(5)?(o(),l("option",se,"新竹市2.0E")):r("",!0),e(n).includes(6)?(o(),l("option",oe,"新竹縣2.0E")):r("",!0),e(n).includes(20)?(o(),l("option",le,"竹科2.0E")):r("",!0),e(n).includes(7)?(o(),l("option",ne,"苗栗縣2.0E")):r("",!0),e(n).includes(8)?(o(),l("option",ce,"台中市2.0E")):r("",!0),e(n).includes(12)?(o(),l("option",re,"嘉義市2.0E")):r("",!0),e(n).includes(13)?(o(),l("option",ue,"嘉義縣2.0E")):r("",!0),e(n).includes(14)?(o(),l("option",ie,"台南市2.0E")):r("",!0),e(n).includes(15)?(o(),l("option",de,"高雄市2.0E")):r("",!0),e(n).includes(16)?(o(),l("option",me,"屏東縣2.0E")):r("",!0),e(n).includes(19)?(o(),l("option",ve,"台東縣2.0E")):r("",!0)],512),[[P,y.value]])])]),d("div",pe,[_(e(N),{class:"px-0 mx-0","formatted-value":v.value,"onUpdate:formattedValue":s[2]||(s[2]=t=>v.value=t),type:"date",actions:null,"is-date-disabled":S,"update-value-on-close":"",placeholder:"開始日期","value-format":"yyyy-MM-dd"},null,8,["formatted-value"])]),d("div",_e,[_(e(N),{class:"px-0 mx-0","formatted-value":p.value,"onUpdate:formattedValue":s[3]||(s[3]=t=>p.value=t),type:"date",actions:null,"is-date-disabled":z,"update-value-on-close":"",placeholder:"結束日期","value-format":"yyyy-MM-dd"},null,8,["formatted-value"])]),d("div",fe,[d("button",{type:"button",class:"btn btn-info text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:U}," 清空日期 "),d("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:T}," 搜尋 "),_(K,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:e(b),name:e(w),header:e(g)},null,8,["data","name","header"])])],2),C(_(e(O),{ref_key:"dataTable",ref:B,data:h.value,columns:D.value,size:"small",pagination:{pageSize:15},"max-height":600,"scroll-x":1500,bordered:!1,"single-line":!1,striped:""},null,8,["data","columns"]),[[G,h.value.length>0]])]))}};export{ge as default};
