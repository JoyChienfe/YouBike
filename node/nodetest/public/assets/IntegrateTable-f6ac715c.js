import{u as M,i as w,r as c,o as n,c as r,b as y,d as e,e as s,k as S,v as U,l as d,n as $,s as z,j as E}from"./index-3459458a.js";import{L}from"./index-fcaa1a70.js";import{_ as j}from"./OutputExcel-14eb8bfa.js";import{N as I}from"./DatePicker-0f56cdd4.js";import{N as A}from"./DataTable-83b67cc2.js";import"./xlsx-bd534488.js";import"./Forward-c5c87e0a.js";import"./Input-c173e393.js";import"./get-slot-1efb97e5.js";const F={class:"container-fluid px-0"},P=s("div",{class:"row mx-0"},[s("h1",{class:"report-h1 fw-bold"},"統整表")],-1),Y={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},q=s("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"系統別:",-1),G={class:"col-md-auto px-0"},H=s("option",{selected:"",disabled:""},"請選擇",-1),J={key:0,value:"1"},K={key:1,value:"2"},O={key:2,value:"3"},Q={key:3,value:"4"},R={key:4,value:"5"},W={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},X={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},Z={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},me={__name:"IntegrateTable",setup(ee){const l=M().citys,x=w("ischange"),D=w("$swal");async function b(o){D({icon:"error",title:`${o}`,showConfirmButton:!1})}const N=c(null),u=c("請選擇"),p=c(!1),k=c([{key:"item1",align:"center",title:"縣市"},{key:"item2",align:"center",title:"使用次數"},{key:"item3",align:"center",title:"進電數"},{key:"item4",align:"center",title:"長時間通話數"},{key:"item5",align:"center",title:"掛斷數(大於6秒)"},{key:"item6",align:"center",title:"掛斷率(大於6秒)"}]),_=c([]),v=c(),B=o=>{const t=new Date(o),a=new Date,m=new Date(a.getFullYear(),a.getMonth(),a.getDate());return t<new Date(2023,11,1)||t>=m};let f=[],g="",h=[];const C=(o,t,a)=>{f=[],g="",h=[],f=[...o],g=a,t.forEach(m=>{h.push(m.title)})},T=async()=>{try{const o="https://report.youbike.com.tw/isauth/gcpfun";let t={dataset_id:"report",table_id:"CTI_summary_table",date:v.value,item:u.value};p.value=!0;const m=(await E.get(o,{params:t})).data.data.map(i=>({item1:i.city,item2:i.ride_times,item3:i.total,item4:i.long_answer,item5:i.hangup_gt_six,item6:i.hangup_gt_six_percentage}));_.value=[...m],C(_.value,k.value,"統整表"),p.value=!1}catch(o){console.log(o)}},V=async()=>{if(u.value==="請選擇")return b("請選擇城市");if(!v.value)return b("請選擇日期");await T()};return(o,t)=>(n(),r("div",F,[y(e(L),{active:p.value,"onUpdate:active":t[0]||(t[0]=a=>p.value=a),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),P,s("form",{class:$(["row mx-0",{"report-header":!e(x),"report-header-dark":e(x)}])},[s("div",Y,[q,s("div",G,[S(s("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":t[1]||(t[1]=a=>u.value=a)},[H,e(l).includes(2)&&e(l).includes(3)?(n(),r("option",J," 雙北 ")):d("",!0),e(l).includes(4)&&e(l).includes(5)&&e(l).includes(6)&&e(l).includes(7)?(n(),r("option",K," 桃竹苗 ")):d("",!0),e(l).includes(8)?(n(),r("option",O,"台中")):d("",!0),e(l).includes(12)?(n(),r("option",Q,"嘉義")):d("",!0),e(l).includes(14)&&e(l).includes(15)&&e(l).includes(16)?(n(),r("option",R," 南高屏 ")):d("",!0)],512),[[U,u.value]])])]),s("div",W,[s("div",X,[y(e(I),{class:"px-0","formatted-value":v.value,"onUpdate:formattedValue":t[2]||(t[2]=a=>v.value=a),type:"date",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"請選擇日期","value-format":"yyyy-MM-dd","is-date-disabled":B},null,8,["formatted-value"])])]),s("div",Z,[s("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:V}," 搜尋 "),y(j,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:e(f),name:e(g),header:e(h)},null,8,["data","name","header"])])],2),_.value.length>=1?(n(),z(e(A),{key:0,ref_key:"dataTable",ref:N,size:"small",pagination:{pageSize:17},columns:k.value,data:_.value,"max-height":600,"scroll-x":1e3,bordered:!1,"single-line":!1,striped:""},null,8,["columns","data"])):d("",!0)]))}};export{me as default};
