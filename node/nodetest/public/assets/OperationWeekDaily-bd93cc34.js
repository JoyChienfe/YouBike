import{_ as P,u as j,i as S,r as p,o,c as a,b as C,d as e,e as c,l as M,v as O,F as N,m as l,n as q,x as K,L as Y,q as A,s as G,t as J,k as Q}from"./index-f70ad2e2.js";import{_ as R}from"./OutputExcel-2fe361e9.js";import{N as X}from"./DataTable-f0bb03cc.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const r=k=>(G("data-v-b44144f6"),k=k(),J(),k),Z={class:"container-fluid px-0"},ee=r(()=>c("div",{class:"row mx-0"},[c("h1",{class:"report-h1 fw-bold"},"營運管理週報")],-1)),te={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},oe=r(()=>c("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"系統別:",-1)),ae={class:"col-md-auto px-0"},se=r(()=>c("option",{selected:"",disabled:""},"請選擇",-1)),le=r(()=>c("option",{value:"1"},"1.0",-1)),ne=r(()=>c("option",{value:"2"},"2.0",-1)),ie=r(()=>c("option",{value:"2E"},"2.0E",-1)),ce=[se,le,ne,ie],ue={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},de=r(()=>c("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"城市:",-1)),re={class:"col-md-auto px-0"},me=r(()=>c("option",{selected:"",disabled:""},"請選擇",-1)),_e={key:0,value:"Taipei2"},pe={key:1,value:"Newtaipei2"},he={key:2,value:"Taoyuan2"},ve={key:3,value:"Hsinchu2"},ye={key:4,value:"Hsinchu_Country2"},fe={key:5,value:"HsinchuScience2"},ke={key:6,value:"Miaoli2"},ge={key:7,value:"Taichung2"},xe={key:8,value:"Chiayi2"},be={key:9,value:"Tainan2"},Ee={key:10,value:"Kaohsiung2"},De={key:11,value:"Pingtung2"},we={key:0,value:"Newtaipei"},Te={key:1,value:"Taoyuan"},Ce={key:2,value:"Miaoli"},Ne={key:0,value:"Taipei2E"},$e={key:1,value:"Newtaipei2E"},Se={key:2,value:"Taoyuan2E"},Me={key:3,value:"Hsinchu_Country2E"},Oe={key:4,value:"HsinchuScience2E"},Ve={key:5,value:"Miaoli2E"},Be={key:6,value:"Taichung2E"},He={key:7,value:"Chiayi2E"},Ue={key:8,value:"Tainan2E"},We={key:9,value:"Kaohsiung2E"},Fe={key:10,value:"Pingtung2E"},Ie={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},ze={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Le={__name:"OperationWeekDaily",setup(k){const n=j().citys,$=S("ischange"),V=S("$swal");async function E(t){V({icon:"error",title:`${t}`,showConfirmButton:!1})}const B=p(null),y=p("請選擇"),m=p("請選擇"),f=p(!1),g=p([]),h=p([]),x=p(),H=t=>{const s=new Date(t),i=new Date,u=new Date(i.getFullYear(),i.getMonth(),i.getDate()),d=new Date(u);d.setDate(u.getDate()-(u.getDay()||7)+1);const _=s.getDay();return s>=d||_!==1||s.getFullYear()<2023};let D=[],w="",T=[];const U=(t,s,i)=>{D=[],w="",T=[];const u=[];t.forEach((d,_)=>{u.push([]);for(let v=1;v<=Object.keys(d).length;v++)u[_].push(d[`item${v}`])}),D=[...u],w=i,s.forEach(d=>{T.push(d.title)})},W=t=>{console.log("mackcol"),g.value=[];let s=[];s=t.filter((u,d)=>d!==4),console.log(s),s.push(t[4]);let i=[];s.forEach((u,d)=>{i.push({key:`item${d+1}`,align:"center",title:u[2]}),d===0&&(i[i.length-1].fixed="left")}),g.value=[...i]},F=t=>{console.log("mackdata"),h.value=[];let s=[];s=t.filter((d,_)=>_!==4),s.push(t[4]);let i=s[0].length-2,u=[];for(let d=1;d<=i;d++)u.push({});s.forEach((d,_)=>{d.forEach((v,b)=>{b===0||b===1||b===2||(u[b-3][`item${_+1}`]=v)})}),h.value=[...u]},I=async()=>{const t="https://report.youbike.com.tw/isauth/gcpfun";let s={dataset_id:"report",table_id:`weekly_report_query${m.value}`,date:x.value,city:[y.value]};f.value=!0;const i=await Q.get(t,{params:s}),{data:u}=i.data;if(u.length===0){h.value=[],f.value=!1;return}console.log(1),W([...u[0]]),F([...u[0]]),f.value=!1,U(h.value,g.value,"營運管理週報")},z=async()=>{if(m.value=="請選擇"){E("系統別不能為空");return}else if(y.value=="請選擇"){E("城市不能為空");return}else if(x.value===void 0){E("日期不能為空");return}await I()},L=t=>{if(t.item1==="場站資訊"||t.item1==="租借資訊"||t.item1==="收入資訊"||t.item1==="妥善率資訊"||t.item1==="票卡資訊"||t.item1==="當週租借車次"||t.item1==="註冊票卡淨增加數"&&!t.item2||t.item1==="各時段使用資訊"||t.item1==="租賃收入明細"||t.item1==="當週/日租借車次"&&!t.item2||t.item1==="租賃時間使用資訊"||t.item1==="維護管理"||t.item1==="調度管理"||t.item1==="營運資訊"||t.item1==="騎乘距離分析"||t.item1==="當日租借車次")return"too-old"};return(t,s)=>(o(),a("div",Z,[C(e(Y),{active:f.value,"onUpdate:active":s[0]||(s[0]=i=>f.value=i),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),ee,c("form",{class:q(["row mx-0",{"report-header":!e($),"report-header-dark":e($)}])},[c("div",te,[oe,c("div",ae,[M(c("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":s[1]||(s[1]=i=>m.value=i),onChange:s[2]||(s[2]=i=>y.value="請選擇")},ce,544),[[O,m.value]])])]),c("div",ue,[de,c("div",re,[M(c("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":s[3]||(s[3]=i=>y.value=i)},[me,m.value==2?(o(),a(N,{key:0},[e(n).includes(2)?(o(),a("option",_e," 台北市 ")):l("",!0),e(n).includes(3)?(o(),a("option",pe," 新北市 ")):l("",!0),e(n).includes(4)?(o(),a("option",he," 桃園市 ")):l("",!0),e(n).includes(5)?(o(),a("option",ve," 新竹市 ")):l("",!0),e(n).includes(6)?(o(),a("option",ye," 新竹縣 ")):l("",!0),e(n).includes(20)?(o(),a("option",fe," 竹科 ")):l("",!0),e(n).includes(7)?(o(),a("option",ke," 苗栗縣 ")):l("",!0),e(n).includes(8)?(o(),a("option",ge," 台中市 ")):l("",!0),e(n).includes(12)?(o(),a("option",xe," 嘉義市 ")):l("",!0),e(n).includes(14)?(o(),a("option",be," 台南市 ")):l("",!0),e(n).includes(15)?(o(),a("option",Ee," 高雄市 ")):l("",!0),e(n).includes(16)?(o(),a("option",De," 屏東縣 ")):l("",!0)],64)):m.value==1?(o(),a(N,{key:1},[e(n).includes(3)?(o(),a("option",we," 新北市 ")):l("",!0),e(n).includes(4)?(o(),a("option",Te," 桃園市 ")):l("",!0),e(n).includes(7)?(o(),a("option",Ce," 苗栗縣 ")):l("",!0)],64)):m.value=="2E"?(o(),a(N,{key:2},[e(n).includes(2)?(o(),a("option",Ne," 台北市 ")):l("",!0),e(n).includes(3)?(o(),a("option",$e," 新北市 ")):l("",!0),e(n).includes(4)?(o(),a("option",Se," 桃園市 ")):l("",!0),e(n).includes(6)?(o(),a("option",Me," 新竹縣 ")):l("",!0),e(n).includes(20)?(o(),a("option",Oe," 竹科 ")):l("",!0),e(n).includes(7)?(o(),a("option",Ve," 苗栗縣 ")):l("",!0),e(n).includes(8)?(o(),a("option",Be," 台中市 ")):l("",!0),e(n).includes(12)?(o(),a("option",He," 嘉義市 ")):l("",!0),e(n).includes(14)?(o(),a("option",Ue," 台南市 ")):l("",!0),e(n).includes(15)?(o(),a("option",We," 高雄市 ")):l("",!0),e(n).includes(16)?(o(),a("option",Fe," 屏東縣 ")):l("",!0)],64)):l("",!0)],512),[[O,y.value]])]),c("div",Ie,[C(e(A),{class:"px-0","formatted-value":x.value,"onUpdate:formattedValue":s[4]||(s[4]=i=>x.value=i),type:"date",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"請選每週一日期","value-format":"yyyy-MM-dd","is-date-disabled":H},null,8,["formatted-value"])])]),c("div",ze,[c("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:z}," 搜尋 "),C(R,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:e(D),name:e(w),header:e(T)},null,8,["data","name","header"])])],2),h.value.length>1?(o(),K(e(X),{key:0,ref_key:"dataTable",ref:B,size:"small","row-class-name":L,pagination:{pageSize:100},columns:g.value,data:h.value,"max-height":600,"scroll-x":1e3,bordered:!1,"single-line":!1,striped:""},null,8,["columns","data"])):l("",!0)]))}},Ge=P(Le,[["__scopeId","data-v-b44144f6"]]);export{Ge as default};
