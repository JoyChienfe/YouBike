import{u as ue,i as M,r as u,o as i,c as a,b as N,d as e,e as l,l as D,v as K,F as $,m as c,n as ye,x as ke,L as de,q as pe,k as he}from"./index-c3eef9e5.js";import{_ as ve}from"./OutputExcel-bac8da35.js";import{N as fe}from"./DataTable-26015d18.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const we={class:"container-fluid px-0"},xe=l("div",{class:"row mx-0"},[l("h1",{class:"report-h1 fw-bold"},"話務統計表")],-1),Te={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},be=l("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"系統別:",-1),Pe={class:"col-md-auto px-0"},Ce=l("option",{selected:"",disabled:""},"請選擇",-1),Ne=l("option",{value:"1.0"},"1.0",-1),He=l("option",{value:"2.0"},"2.0",-1),Me=[Ce,Ne,He],De={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Ke=l("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"城市:",-1),$e={class:"col-md-auto px-0"},Be=l("option",{selected:"",disabled:""},"請選擇",-1),Ve={key:0,value:"TP"},Ee={key:1,value:"NTP2"},Ue={key:2,value:"Taoyuan_two"},Fe={key:3,value:"Hsinchu_two"},Se={key:4,value:"HsinchuCountry"},ze={key:5,value:"Miaoli_two"},Le={key:6,value:"Taichung_two"},Ye={key:7,value:"Chiayi"},je={key:8,value:"Tainan"},qe={key:9,value:"Kaohsiung"},Ae={key:10,value:"Pingtung"},Ie={key:0,value:"NTP"},Re={key:1,value:"Taoyuan"},Ge={key:2,value:"Miaoli"},Je={key:3,value:"Taichung_one"},Oe={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},Qe={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},lt={__name:"CostumdayReporttotal",setup(We){const g=ue().citys,H=M("ischange"),B=M("$swal");async function w(_){B({icon:"error",title:`${_}`,showConfirmButton:!1})}const x=u(null),t=u("請選擇"),y=u("請選擇"),p=u(!1),o=u([]),h=u([]),v=u(),V=_=>{const n=new Date(_),r=new Date,k=new Date(r.getFullYear(),r.getMonth(),r.getDate());return n<new Date(2023,7,8)||n>=k};let s=[];const E=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"台北2.0進線數"},{key:"item5",align:"center",title:"5511專線"},{key:"item6",align:"center",title:"1999專線"},{key:"item7",align:"center",title:"接聽數"},{key:"item8",align:"center",title:"接聽比例"},{key:"item9",align:"center",title:"台北2.0進線數"},{key:"item10",align:"center",title:"5511專線"},{key:"item11",align:"center",title:"1999專線"},{key:"item12",align:"center",title:"平均每人接聽通數"},{key:"item13",align:"center",title:"掛斷數"},{key:"item14",align:"center",title:">6掛斷數"},{key:"item15",align:"center",title:"<=6掛斷數"},{key:"item16",align:"center",title:">6掛斷率"},{key:"item17",align:"center",title:"使用次數"},{key:"item18",align:"center",title:"接聽前平均等待時間"},{key:"item19",align:"center",title:"平均通話時間"}],U=["time_range","total","total_percentage","TP_two_total","TP_5511_total","TP_1999_total","answer","answer_percentage","TP_two_answer","TP_5511_answer","TP_1999_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],F=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"新北2.0"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"新北2.0"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],S=["time_range","total","total_percentage","NTP_two_total","answer","answer_percentage","NTP_two_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],z=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"YB新北"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"YB新北"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],L=["time_range","total","total_percentage","NTP_one_total","answer","answer_percentage","NTP_one_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],Y=["time_range","total","total_percentage","Taoyuan_one_total","answer","answer_percentage","Taoyuan_one_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],j=["time_range","total","total_percentage","Taoyuan_two_total","answer","answer_percentage","Taoyuan_two_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],q=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"桃園2.0"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"桃園2.0"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],A=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"桃園1.0"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"桃園1.0"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],I=["time_range","total","total_percentage","Hsinchu_two_total","answer","answer_percentage","Hsinchu_two_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],R=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"新竹2.0"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"新竹2.0"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],G=["time_range","total","total_percentage","HsinchuCountry_two_total","answer","answer_percentage","HsinchuCountry_two_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],J=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"竹縣2.0"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"竹縣2.0"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],O=["time_range","total","total_percentage","Miaoli_one_total","answer","answer_percentage","Miaoli_one_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],Q=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"苗栗1.0"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"苗栗1.0"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],W=["time_range","total","total_percentage","Chiayi_total","answer","answer_percentage","Chiayi_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],X=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"嘉義2.0"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"嘉義2.0"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],Z=["time_range","total","total_percentage","Taichung_two_total","answer","answer_percentage","Taichung_two_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],ee=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"台中2.0"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"台中2.0"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],te=["time_range","total","total_percentage","Taichung_one_total","answer","answer_percentage","Taichung_one_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],ie=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"台中1.0"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"台中1.0"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],ne=["time_range","total","total_percentage","Tainan_total","answer","answer_percentage","Tainan_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],ae=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"台南2.0"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"台南2.0"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],le=["time_range","total","total_percentage","Kaohsiung_two_total","Kaohsiung_0800_total","answer","answer_percentage","Kaohsiung_two_answer","Kaohsiung_0800_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],re=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"高雄2.0進電數"},{key:"item5",align:"center",title:"0800專線"},{key:"item6",align:"center",title:"接聽數"},{key:"item7",align:"center",title:"接聽比例"},{key:"item8",align:"center",title:"高雄2.0進線數"},{key:"item9",align:"center",title:"0800專線"},{key:"item10",align:"center",title:"平均每人接聽通數"},{key:"item11",align:"center",title:"掛斷數"},{key:"item12",align:"center",title:">6掛斷數"},{key:"item13",align:"center",title:"<=6掛斷數"},{key:"item14",align:"center",title:">6掛斷率"},{key:"item15",align:"center",title:"使用次數"},{key:"item16",align:"center",title:"接聽前平均等待時間"},{key:"item17",align:"center",title:"平均通話時間"}],ce=["time_range","total","total_percentage","Pingtung_total","answer","answer_percentage","Pingtung_answer","avg_person_counts","hangup","hangup_gt_six","hangup_le_six","hangup_gt_six_percentage","ride_times","before_avg_duration","avg_duration"],oe=[{key:"item1",align:"center",fixed:"left",title:"時刻"},{key:"item2",align:"center",title:"進電數"},{key:"item3",align:"center",title:"進電比例"},{key:"item4",align:"center",title:"屏東2.0"},{key:"item5",align:"center",title:"接聽數"},{key:"item6",align:"center",title:"接聽比例"},{key:"item7",align:"center",title:"屏東2.0"},{key:"item8",align:"center",title:"平均每人接聽通數"},{key:"item9",align:"center",title:"掛斷數"},{key:"item10",align:"center",title:">6掛斷數"},{key:"item11",align:"center",title:"<=6掛斷數"},{key:"item12",align:"center",title:">6掛斷率"},{key:"item13",align:"center",title:"使用次數"},{key:"item14",align:"center",title:"接聽前平均等待時間"},{key:"item15",align:"center",title:"平均通話時間"}],ge=()=>{t.value==="TP"?(s=[...U],o.value=[...E]):t.value==="NTP2"?(s=[...S],o.value=[...F]):t.value==="NTP"?(s=[...L],o.value=[...z]):t.value==="Taoyuan"?(s=[...Y],o.value=[...A]):t.value==="Taoyuan_two"?(s=[...j],o.value=[...q]):t.value==="Hsinchu_two"?(s=[...I],o.value=[...R]):t.value==="HsinchuCountry"?(s=[...G],o.value=[...J]):t.value==="Miaoli"||t.value==="Miaoli_two"?(s=[...O],o.value=[...Q]):t.value==="Chiayi"?(s=[...W],o.value=[...X]):t.value==="Taichung_two"?(s=[...Z],o.value=[...ee]):t.value==="Taichung_one"?(s=[...te],o.value=[...ie]):t.value==="Kaohsiung"?(s=[...le],o.value=[...re]):t.value==="Tainan"?(s=[...ne],o.value=[...ae]):t.value==="Pingtung"&&(s=[...ce],o.value=[...oe])};let T=[],b="",P=[];const se=(_,n,r)=>{T=[],b="",P=[],T=[..._],b=r,n.forEach(k=>{P.push(k.title)})},_e=async()=>{try{const _="https://report.youbike.com.tw/isauth/gcpfun";let n={dataset_id:"report",table_id:"CTI_final_table",date:v.value,city:t.value,sys:y.value};p.value=!0,console.log(n);const r=await he.get(_,{params:n});console.log(r),p.value=!1;let k=[];r.data.data.forEach(d=>{let f={};s.forEach((m,C)=>{m==="total_percentage"||m==="answer_percentage"||m==="hangup_gt_six_percentage"?f[`item${C+1}`]=d[m]===0||d[m]===null?0:(d[m]*100).toFixed(2)+"%":m==="avg_person_counts"?f[`item${C+1}`]=d[m]===null?0:d[m]:f[`item${C+1}`]=d[m]}),k.push(f)}),h.value=[...k],se(h.value,o.value,"話務統計表"),x.value.page&&x.value.page(1),p.value=!1}catch(_){console.log(_)}},me=async()=>{if(y.value==="請選擇")return w("請選擇系統別");if(t.value==="請選擇")return w("請選擇城市");if(!v.value)return w("請選擇日期");ge(),await _e()};return(_,n)=>(i(),a("div",we,[N(e(de),{active:p.value,"onUpdate:active":n[0]||(n[0]=r=>p.value=r),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),xe,l("form",{class:ye(["row mx-0",{"report-header":!e(H),"report-header-dark":e(H)}])},[l("div",Te,[be,l("div",Pe,[D(l("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":n[1]||(n[1]=r=>y.value=r),onChange:n[2]||(n[2]=r=>t.value="請選擇")},Me,544),[[K,y.value]])])]),l("div",De,[Ke,l("div",$e,[D(l("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":n[3]||(n[3]=r=>t.value=r)},[Be,y.value==2?(i(),a($,{key:0},[e(g).includes(2)?(i(),a("option",Ve,"台北市")):c("",!0),e(g).includes(3)?(i(),a("option",Ee," 新北市 ")):c("",!0),e(g).includes(4)?(i(),a("option",Ue," 桃園市 ")):c("",!0),e(g).includes(5)?(i(),a("option",Fe," 新竹市 ")):c("",!0),e(g).includes(6)?(i(),a("option",Se," 新竹縣 ")):c("",!0),e(g).includes(7)?(i(),a("option",ze," 苗栗縣 ")):c("",!0),e(g).includes(8)?(i(),a("option",Le," 台中市 ")):c("",!0),e(g).includes(12)?(i(),a("option",Ye," 嘉義市 ")):c("",!0),e(g).includes(14)?(i(),a("option",je," 台南市 ")):c("",!0),e(g).includes(15)?(i(),a("option",qe," 高雄市 ")):c("",!0),e(g).includes(16)?(i(),a("option",Ae," 屏東縣 ")):c("",!0)],64)):y.value==1?(i(),a($,{key:1},[e(g).includes(3)?(i(),a("option",Ie,"新北市")):c("",!0),e(g).includes(4)?(i(),a("option",Re," 桃園縣 ")):c("",!0),e(g).includes(7)?(i(),a("option",Ge," 苗栗縣 ")):c("",!0),e(g).includes(8)?(i(),a("option",Je," 台中市 ")):c("",!0)],64)):c("",!0)],512),[[K,t.value]])]),l("div",Oe,[N(e(pe),{class:"px-0","formatted-value":v.value,"onUpdate:formattedValue":n[4]||(n[4]=r=>v.value=r),type:"date",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"請選擇日期","value-format":"yyyy-MM-dd","is-date-disabled":V},null,8,["formatted-value"])])]),l("div",Qe,[l("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:me}," 搜尋 "),N(ve,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:e(T),name:e(b),header:e(P)},null,8,["data","name","header"])])],2),h.value.length>1?(i(),ke(e(fe),{key:0,ref_key:"dataTable",ref:x,size:"small",pagination:{pageSize:17},columns:o.value,data:h.value,"max-height":600,"scroll-x":1e3,bordered:!1,"single-line":!1,striped:""},null,8,["columns","data"])):c("",!0)]))}};export{lt as default};
