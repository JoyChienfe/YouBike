import{_ as I,i as S,r as c,z as U,u as V,o as f,c as v,b as F,d as H,e,l as w,b2 as y,n as A,b4 as p,j as P,F as R,b3 as z,k as D,L as W,s as O,t as q}from"./index-986760c3.js";const d=u=>(O("data-v-f16ead73"),u=u(),q(),u),G={class:"container-fluid"},J=d(()=>e("div",{class:"row mx-0 mb-3"},[e("h1",{class:"report-h1 fw-bold"},"簡訊發送")],-1)),K={novalidate:""},Q={class:"row border-3 border py-3 mb-3 rounded"},X=d(()=>e("div",{class:"btn-toolbar mb-3",role:"toolbar","aria-label":"Toolbar with button groups"},null,-1)),Y=d(()=>e("h2",{class:"fs-5 fw-bold mb-2"},"1.輸入電話號碼",-1)),Z={class:"col-auto mb-1"},ee={class:"invalid-feedback"},te={class:"row border-3 border py-3 rounded mb-3"},se={class:"row mb-1"},oe=d(()=>e("div",{class:"btn-toolbar mb-3",role:"toolbar","aria-label":"Toolbar with button groups"},null,-1)),ne=d(()=>e("h2",{class:"fs-5 fw-bold mb-2"},"2.輸入簡訊內容",-1)),ae={class:"col-10"},le={class:"col-2 d-flex flex-column justify-content-center"},ce={class:"text-center gradient-bg mb-1"},re={class:"text-danger"},ie={class:"row mb-2"},de={class:"col-12"},ue={class:"punctuation-panel"},be=["onClick"],fe={__name:"sendMessage",setup(u){const _=S("$swal"),m=c(null);async function C(s){_({icon:"error",title:`${s}`,showConfirmButton:!1})}async function k(s){_({icon:"success",title:`${s}`,showConfirmButton:!1})}const T=c(["，","。","？","！","「","」","『","』","︰","（","）","《","》","〈","〉","［","］","｛","｝","：","；","‘","’","“","”","、","。","·","……","—","《","》","（","）","【","】","+","-","±","÷","×","=","≠","%","∞","√"]);function N(s){r.value+=s}const h=c(!1),r=c(""),l=c(""),i=c(""),a=c("");function $(){const n=["0912345678,","0987654321,","0988888888,","0977777777,"].join(`
`),t=new Blob([n],{type:"text/plain;charset=utf-8;"}),o=document.createElement("a"),b=URL.createObjectURL(t);o.href=b,o.download="電話號碼範例檔.txt",document.body.appendChild(o),o.click(),document.body.removeChild(o)}const L=async s=>{const n=s.target.files[0];if(!n||!n.name.toLowerCase().endsWith(".txt")){await C("請上傳txt文件");return}const t=new FileReader;t.onload=function(o){const b=o.target.result;l.value=b},t.readAsText(n)};function x(s){const n=s.replace(/,$/,"");return/^09\d{8}$/.test(n)}function g(s){return s===null?void 0:(a.value=!0,i.value="",s.split(`
`).forEach((t,o)=>{t.endsWith(",")||(i.value+=`第${o+1}行格式錯誤，應以逗號結尾。
`,a.value=!1),x(t)||(i.value+=`第${o+1}行手機格式錯誤。
`,a.value=!1)}),a.value)}U(l,s=>{g(s)});const M=()=>{l.value="",r.value="",a.value=!1,i.value="",m.value.value=null},j=V(),{userId:B}=j,E=async()=>{if(!g(l.value))return;const t=l.value.split(`
`).map(o=>o.replace(/,$/,"").trim()).filter(x);try{const o="https://report.youbike.com.tw/sms/send";await D.post(o,{phone:t,yb_id:B,message:r.value,check:t.length>=5e3}),await k("發送成功"),M()}catch(o){console.log(o)}};return(s,n)=>(f(),v("div",G,[F(H(W),{active:h.value,"onUpdate:active":n[0]||(n[0]=t=>h.value=t),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),J,e("form",K,[e("div",Q,[X,Y,e("div",Z,[e("input",{type:"file",class:"form-control",onChange:L,ref_key:"file",ref:m},null,544)]),e("div",{class:"col-auto mb-1"},[e("button",{type:"button",class:"btn btn-primary fw-bold",onClick:$}," 下載範例檔案 ")]),e("div",null,[w(e("textarea",{class:A({"form-control":!0,"is-valid":a.value,"is-invalid":a.value!==""&&!a.value}),placeholder:`0912345678,\r
0987654321,\r
0966666666,`,id:"floatingTextarea",style:{height:"100px"},"onUpdate:modelValue":n[1]||(n[1]=t=>l.value=t)},null,2),[[y,l.value]]),e("div",ee,p(i.value),1)])]),e("div",te,[e("div",se,[oe,ne,e("div",ae,[w(e("textarea",{"onUpdate:modelValue":n[2]||(n[2]=t=>r.value=t),class:"form-control form-control-sm",placeholder:"輸入簡訊內容",id:"floatingTextarea",style:{height:"100px"}},null,512),[[y,r.value]])]),e("div",le,[e("p",ce,[e("span",re,p(r.value.length),1),P("字 ")])])]),e("div",ie,[e("div",de,[e("div",ue,[(f(!0),v(R,null,z(T.value,t=>(f(),v("button",{key:t,type:"button",class:"btn btn-sm me-1 mb-1 btn-outline-secondary",onClick:o=>N(t)},p(t),9,be))),128))])])])]),e("div",{class:"row d-flex justify-content-center"},[e("button",{class:"btn btn-danger btn-lg",style:{width:"200px"},type:"button",onClick:E}," 發送 ")])])]))}},pe=I(fe,[["__scopeId","data-v-f16ead73"]]);export{pe as default};
