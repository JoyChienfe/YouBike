import{i as H,u as j,r as m,o as n,c,b as f,d as t,e as l,l as S,v as N,F as C,m as u,n as q,p as R,L as G,y as I,q as U,k as J}from"./index-57300d61.js";import{_ as K}from"./OutputExcel-9882e099.js";import{N as O}from"./DataTable-6cdc6e71.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const Q={class:"container-fluid px-0"},W=l("div",{class:"row mx-0"},[l("h1",{class:"report-h1 fw-bold"},"yb2騎乘時間查詢")],-1),X={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Y=l("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"系統別:",-1),Z={class:"col-md-auto px-0"},ee=l("option",{selected:"",disabled:""},"請選擇",-1),te=l("option",{value:"2.0"},"2.0",-1),se=l("option",{value:"2.0E"},"2.0E",-1),ae=[ee,te,se],oe={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},le=l("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"城市:",-1),ne={class:"col-md-auto px-0"},ce=l("option",{selected:"",disabled:""},"請選擇",-1),ue={key:0,selected:"",value:"台北市"},ie={key:1,selected:"",value:"新北市"},de={key:2,selected:"",value:"桃園市"},re={key:3,selected:"",value:"新竹市"},me={key:4,selected:"",value:"新竹縣"},ve={key:5,selected:"",value:"苗栗縣"},_e={key:6,selected:"",value:"台中市"},pe={key:7,selected:"",value:"嘉義市"},fe={key:8,selected:"",value:"台南市"},he={key:9,selected:"",value:"高雄市"},ye={key:10,selected:"",value:"屏東縣"},ge={key:0,selected:"",value:"桃園市"},xe={key:1,selected:"",value:"新竹縣"},be={key:2,selected:"",value:"苗栗縣"},ke={key:3,selected:"",value:"台中市"},De={key:4,selected:"",value:"嘉義市"},we={key:5,selected:"",value:"台南市"},Se={key:6,selected:"",value:"高雄市"},Ve={key:7,selected:"",value:"屏東縣"},Ee=l("div",{class:"row align-items-center col-md-auto col-12 pe-0"},[l("label",{class:"col-md-auto col-form-label fw-bolder pe-0"},"項目:")],-1),He={class:"row mx-0 ms-md-2 align-items-center col-md-2 col-12 me-0"},Ne={class:"row mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},Ce={class:"row mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},Ue={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Te={__name:"RidetimeSearch",setup($e){const V=H("ischange"),i=j().citys,$=H("$swal");async function h(d){$({icon:"error",title:`${d}`,showConfirmButton:!1})}const x=m(!1),y=m([]),v=m(),_=m(),g=m("請選擇"),M=m(null),p=m("請選擇"),E=[{key:"num1",align:"center",fixed:"left",width:150,title:"縣市"},{key:"num2",align:"center",title:"鄉鎮市區"},{key:"num3",align:"center",title:"同站／跨站"},{key:"num4",align:"center",title:"費率別"},{key:"num5",align:"center",title:"騎乘時間"},{key:"num6",align:"center",title:"次數"}];let k=[],D="",w=[];const z=(d,o,s)=>{k=[],D="",w=[],k=[...d],D=s,o.forEach(e=>{w.push(e.title)})},A=d=>{const o=_.value,s=new Date;if(s.setHours(0,0,0,0),o){const e=new Date(o);e.setHours(0,0,0,0);const a=new Date(e);a.setDate(a.getDate()-30);const r=new Date(d);if(r.setHours(0,0,0,0),r<a||r>e||r>=s)return!0}else{const e=new Date(d);if(e.setHours(0,0,0,0),e>=s)return!0}},B=d=>{const o=v.value,s=new Date;if(s.setHours(0,0,0,0),o){const e=new Date(o);if(e.setHours(0,0,0,0),e>s)return!0;const a=new Date(e);a.setDate(a.getDate()+30);const r=new Date(d);if(r.setHours(0,0,0,0),r<e||r>a||r>=s)return!0}else{const e=new Date(d);if(e.setHours(0,0,0,0),e>=s)return!0}},P=()=>{v.value=null,_.value=null},L=[{label:"同站借還",value:"同站借還"},{label:"跨站借還",value:"跨站借還"}],b=m([]),T=async()=>{try{x.value=!0,y.value=[];const d="https://report.youbike.com.tw/isauth/gcpfun",o={dataset_id:"report",table_id:"rent_minute_report2",begin_date:v.value,end_date:_.value,city:`${g.value}${p.value}`,item:b.value},s=await J.get(d,{params:o});console.log(s.data.data);let e=[];s.data.data.forEach((a,r)=>{if(r==0){e.push({num1:a.city,num2:a.SxPSArea,num3:a.same_station,num4:a.rate_info,num5:a.rent_minute,num6:a.times});return}e[e.length-1].num2==a.SxPSArea&&e[e.length-1].num3==a.same_station&&e[e.length-1].num4==a.rate_info&&e[e.length-1].num5==a.rent_minute?e[e.length-1].num6+=a.times:e.push({num1:a.city,num2:a.SxPSArea,num3:a.same_station,num4:a.rate_info,num5:a.rent_minute,num6:a.times})}),y.value=[...e],x.value=!1,z(y.value,E,"yb2騎乘時間查詢")}catch(d){console.log(d)}},F=()=>{if(p.value==="請選擇")return h("請選擇系統別");if(g.value=="請選擇")return h("請選擇城市");if(b.value.length===0)return h("請選擇項目");if(v.value){if(!_.value)return h("請選擇結束日期")}else return h("請選擇開始日期");T()};return(d,o)=>(n(),c("div",Q,[f(t(G),{active:x.value,"onUpdate:active":o[0]||(o[0]=s=>x.value=s),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),W,l("form",{class:q(["row mx-0",{"report-header":!t(V),"report-header-dark":t(V)}])},[l("div",X,[Y,l("div",Z,[S(l("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":o[1]||(o[1]=s=>p.value=s),onChange:o[2]||(o[2]=s=>g.value="請選擇")},ae,544),[[N,p.value]])])]),l("div",oe,[le,l("div",ne,[S(l("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":o[3]||(o[3]=s=>g.value=s)},[ce,p.value==="2.0"?(n(),c(C,{key:0},[t(i).includes(2)?(n(),c("option",ue," 台北市 ")):u("",!0),t(i).includes(3)?(n(),c("option",ie," 新北市 ")):u("",!0),t(i).includes(4)?(n(),c("option",de," 桃園市 ")):u("",!0),t(i).includes(5)?(n(),c("option",re," 新竹市 ")):u("",!0),t(i).includes(6)?(n(),c("option",me," 新竹縣 ")):u("",!0),t(i).includes(7)?(n(),c("option",ve," 苗栗縣 ")):u("",!0),t(i).includes(8)?(n(),c("option",_e," 台中市 ")):u("",!0),t(i).includes(12)?(n(),c("option",pe," 嘉義市 ")):u("",!0),t(i).includes(14)?(n(),c("option",fe," 台南市 ")):u("",!0),t(i).includes(15)?(n(),c("option",he," 高雄市 ")):u("",!0),t(i).includes(16)?(n(),c("option",ye," 屏東縣 ")):u("",!0)],64)):p.value==="2.0E"?(n(),c(C,{key:1},[t(i).includes(4)?(n(),c("option",ge," 桃園市 ")):u("",!0),t(i).includes(6)?(n(),c("option",xe," 新竹縣 ")):u("",!0),t(i).includes(7)?(n(),c("option",be," 苗栗縣 ")):u("",!0),t(i).includes(8)?(n(),c("option",ke," 台中市 ")):u("",!0),t(i).includes(12)?(n(),c("option",De," 嘉義市 ")):u("",!0),t(i).includes(14)?(n(),c("option",we," 台南市 ")):u("",!0),t(i).includes(15)?(n(),c("option",Se," 高雄市 ")):u("",!0),t(i).includes(16)?(n(),c("option",Ve," 屏東縣 ")):u("",!0)],64)):u("",!0)],512),[[N,g.value]])])]),Ee,l("div",He,[f(t(I),{class:"px-0",value:b.value,"onUpdate:value":o[4]||(o[4]=s=>b.value=s),placeholder:"請選擇",multiple:"",options:L,"max-tag-count":1,size:"medium"},null,8,["value"])]),l("div",Ne,[f(t(U),{class:"px-0","formatted-value":v.value,"onUpdate:formattedValue":o[5]||(o[5]=s=>v.value=s),type:"date",actions:null,"is-date-disabled":A,"update-value-on-close":"",placeholder:"開始日期","value-format":"yyyy-MM-dd"},null,8,["formatted-value"])]),l("div",Ce,[f(t(U),{class:"px-0","formatted-value":_.value,"onUpdate:formattedValue":o[6]||(o[6]=s=>_.value=s),type:"date",actions:null,"is-date-disabled":B,"update-value-on-close":"",placeholder:"結束日期","value-format":"yyyy-MM-dd"},null,8,["formatted-value"])]),l("div",Ue,[l("button",{type:"button",class:"btn btn-info text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:P}," 清空日期 "),l("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:F}," 搜尋 "),f(K,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:t(k),name:t(D),header:t(w)},null,8,["data","name","header"])])],2),S(f(t(O),{ref_key:"dataTable",ref:M,data:y.value,columns:E,size:"small",pagination:{pageSize:17},"max-height":600,"scroll-x":500,bordered:!1,"single-line":!1,striped:""},null,8,["data"]),[[R,y.value.length>0]])]))}};export{Te as default};
