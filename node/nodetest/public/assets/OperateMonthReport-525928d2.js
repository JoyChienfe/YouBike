import{i as x,r as u,o as B,c as C,b as d,d as n,e as l,n as E,k as z,m as F,j as L}from"./index-3459458a.js";import{L as T}from"./index-fcaa1a70.js";import{_ as V}from"./OutputExcel-14eb8bfa.js";import{N as Y}from"./DatePicker-0f56cdd4.js";import{N as j}from"./DataTable-83b67cc2.js";import"./xlsx-bd534488.js";import"./Forward-c5c87e0a.js";import"./Input-c173e393.js";import"./get-slot-1efb97e5.js";const P={class:"container-fluid px-0"},S=l("div",{class:"row mx-0"},[l("h1",{class:"report-h1 fw-bold"},"累積業績")],-1),U={class:"row mx-0 mx-md-2 align-items-center col-md-auto"},A={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},X={__name:"OperateMonthReport",setup(O){const v=x("ischange"),b=x("$swal");async function w(o){b({icon:"error",title:`${o}`,showConfirmButton:!1})}const c=u(!1),f=u(),r=u(null),s=u([]);let p=[],h="",g=[];const k=(o,e,a)=>{p=[],g=[],h="",p=[...o],h=a,e.forEach(t=>{g.push(t.title)})},_=[{key:"month",align:"center",fixed:"left",title:"月份"},{key:"city",align:"center",title:"城市"},{key:"num1",align:"center",title:"單月騎乘次數"},{key:"num2",align:"center",title:"去年同期騎乘次數"},{key:"num3",align:"center",title:"單月最高騎乘次數紀錄"}],D=o=>{const e=new Date(o),a=e.getFullYear(),t=e.getMonth()+1,i=new Date,m=i.getFullYear(),y=i.getMonth()+1;return a<2012||a===2012&&t<8||a>m||a===m&&t>y||a===m&&t>=y},M=async()=>{try{c.value=!0,s.value=[];const o="https://report.youbike.com.tw/isauth/gcpfun";let e={dataset_id:"founder_report",table_id:"monthly_operation_report",date:r.value};(await L.get(o,{params:e})).data.data.forEach(t=>{s.value.push({month:t.month,city:t.city,num1:t.monthly_rent_number,num2:t.last_year_monthly_rent_number,num3:t.max_monthly_rent_number})}),k(s.value,_,"累積業績"),f.value.page&&f.value.page(1),c.value=!1}catch(o){console.log(o)}},N=o=>{const e=new Date,a=e.getFullYear(),t=e.getMonth()+1,i=t<10?`0${t}`:t;`${a}-${i}`!==o&&(r.value=o)},$=()=>{if(!r.value){w("日期不能為空");return}M()};return(o,e)=>(B(),C("div",P,[d(n(T),{active:c.value,"onUpdate:active":e[0]||(e[0]=a=>c.value=a),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),S,l("form",{class:E(["row mx-0",{"report-header":!n(v),"report-header-dark":n(v)}])},[l("div",U,[d(n(Y),{class:"px-0","formatted-value":r.value,"onUpdate:formattedValue":e[1]||(e[1]=a=>r.value=a),type:"month",actions:null,"update-value-on-close":"","is-date-disabled":D,"value-format":"yyyy-MM","on-update:formatted-value":N},null,8,["formatted-value"])]),l("div",A,[l("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:$}," 搜尋 "),d(V,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:n(p),name:n(h),header:n(g)},null,8,["data","name","header"])])],2),z(d(n(j),{ref_key:"dataTable",ref:f,data:s.value,columns:_,pagination:{pageSize:15},"max-height":500,"scroll-x":300,size:"small",bordered:!1,"single-line":!1,striped:""},null,8,["data"]),[[F,s.value.length]])]))}};export{X as default};
