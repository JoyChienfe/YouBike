import{u as M,i as w,r as i,o as n,c as r,b as x,d as e,e as s,l as S,v as U,m as d,n as $,x as z,L as E,q as L,k as I}from"./index-bbfb8d80.js";import{_ as j}from"./OutputExcel-c2348632.js";import{N as q}from"./DataTable-6641dcf8.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const A={class:"container-fluid px-0"},F=s("div",{class:"row mx-0"},[s("h1",{class:"report-h1 fw-bold"},"統整表")],-1),P={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Y=s("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"系統別:",-1),G={class:"col-md-auto px-0"},H=s("option",{selected:"",disabled:""},"請選擇",-1),J={key:0,value:"1"},K={key:1,value:"2"},O={key:2,value:"3"},Q={key:3,value:"4"},R={key:4,value:"5"},W={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},X={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},Z={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},ce={__name:"IntegrateTable",setup(ee){const l=M().citys,y=w("ischange"),D=w("$swal");async function b(o){D({icon:"error",title:`${o}`,showConfirmButton:!1})}const N=i(null),m=i("請選擇"),p=i(!1),k=i([{key:"item1",align:"center",title:"縣市"},{key:"item2",align:"center",title:"使用次數"},{key:"item3",align:"center",title:"進電數"},{key:"item4",align:"center",title:"長時間通話數"},{key:"item5",align:"center",title:"掛斷數(大於6秒)"},{key:"item6",align:"center",title:"掛斷率(大於6秒)"}]),_=i([]),v=i(),B=o=>{const t=new Date(o),a=new Date,u=new Date(a.getFullYear(),a.getMonth(),a.getDate());return t<new Date(2023,11,1)||t>=u};let f=[],g="",h=[];const C=(o,t,a)=>{f=[],g="",h=[],f=[...o],g=a,t.forEach(u=>{h.push(u.title)})},T=async()=>{try{const o="https://report.youbike.com.tw/isauth/gcpfun";let t={dataset_id:"report",table_id:"CTI_summary_table",date:v.value,item:m.value};p.value=!0;const u=(await I.get(o,{params:t})).data.data.map(c=>({item1:c.city,item2:c.ride_times,item3:c.total,item4:c.long_answer,item5:c.hangup_gt_six,item6:c.hangup_gt_six_percentage}));_.value=[...u],C(_.value,k.value,"統整表"),p.value=!1}catch(o){console.log(o)}},V=async()=>{if(m.value==="請選擇")return b("請選擇城市");if(!v.value)return b("請選擇日期");await T()};return(o,t)=>(n(),r("div",A,[x(e(E),{active:p.value,"onUpdate:active":t[0]||(t[0]=a=>p.value=a),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),F,s("form",{class:$(["row mx-0",{"report-header":!e(y),"report-header-dark":e(y)}])},[s("div",P,[Y,s("div",G,[S(s("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":t[1]||(t[1]=a=>m.value=a)},[H,e(l).includes(2)&&e(l).includes(3)?(n(),r("option",J," 雙北 ")):d("",!0),e(l).includes(4)&&e(l).includes(5)&&e(l).includes(6)&&e(l).includes(7)?(n(),r("option",K," 桃竹苗 ")):d("",!0),e(l).includes(8)?(n(),r("option",O,"台中")):d("",!0),e(l).includes(12)?(n(),r("option",Q,"嘉義")):d("",!0),e(l).includes(14)&&e(l).includes(15)&&e(l).includes(16)?(n(),r("option",R," 南高屏 ")):d("",!0)],512),[[U,m.value]])])]),s("div",W,[s("div",X,[x(e(L),{class:"px-0","formatted-value":v.value,"onUpdate:formattedValue":t[2]||(t[2]=a=>v.value=a),type:"date",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"請選擇日期","value-format":"yyyy-MM-dd","is-date-disabled":B},null,8,["formatted-value"])])]),s("div",Z,[s("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:V}," 搜尋 "),x(j,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:e(f),name:e(g),header:e(h)},null,8,["data","name","header"])])],2),_.value.length>=1?(n(),z(e(q),{key:0,ref_key:"dataTable",ref:N,size:"small",pagination:{pageSize:17},columns:k.value,data:_.value,"max-height":600,"scroll-x":1e3,bordered:!1,"single-line":!1,striped:""},null,8,["columns","data"])):d("",!0)]))}};export{ce as default};
