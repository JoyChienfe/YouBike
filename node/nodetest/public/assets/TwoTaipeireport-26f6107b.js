/* empty css                     */import{u as J,r as m,i as $,x as K,o as r,c,b as v,d as i,e as s,k as O,v as Q,l as d,w as W,n as Z,j as T,E as X,h as tt,y as et,t as at}from"./index-9437428c.js";import{L as lt}from"./index-181255ed.js";import{u as b,w as ot}from"./xlsx-bd534488.js";import{N as it}from"./Result-fec7dcae.js";import{N as j}from"./DatePicker-642088af.js";import"./Warning-669a2b5d.js";import"./Forward-a46dd4c7.js";import"./Input-3a828f95.js";const st={class:"container-fluid px-0"},nt=s("div",{class:"row mx-0"},[s("h1",{class:"report-h1 fw-bold"},"見車率統計日報")],-1),rt={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},ct=s("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"城市:",-1),ut={class:"col-md-auto px-0"},dt=s("option",{selected:"",disabled:""},"請選擇",-1),mt={key:0,value:"台北市"},pt={key:1,value:"新北市"},vt={key:2,value:"桃園市"},yt={key:3,value:"新竹市"},gt={key:4,value:"新竹縣"},_t={key:5,value:"竹科"},ft={key:6,value:"苗栗縣"},ht={key:7,value:"台中市"},kt={key:8,value:"嘉義市"},wt={key:9,value:"台南市"},xt={key:10,value:"高雄市"},bt={key:11,value:"屏東縣"},Dt={class:"row col-md-auto col-12 my-auto pt-2"},Vt={class:"row col-md-auto col-12 mx-auto mx-md-0"},Et=s("div",{class:"row mx-0 ms-md-0 align-items-center col-md-auto col-12"},[s("label",{class:"col-md-auto ms-md-0 col-form-label px-0 px-md-2 fw-bolder"},"類型:")],-1),Nt={class:"row col-md-2 align-items-center mx-0 ps-md-0"},Ct={class:"row ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},Ht={class:"row ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},It={__name:"TwoTaipeireport",setup(St){const u=J().citys,k=m(!1),C=$("ischange"),B=$("$swal"),f=m("請選擇");async function y(l){B({icon:"error",title:`${l}`,showConfirmButton:!1})}let H=[];const L=m([{key:"item1",align:"center",fixed:"left",title:"date",width:100},{key:"item2",align:"center",title:"責任區",width:60},{key:"item3",align:"center",title:"場站代號",width:100},{key:"item4",align:"center",title:"站名",width:250},{key:"item5",align:"center",title:"狀態",width:60},{key:"item6",align:"center",title:"項目",width:70},{key:"item7",align:"center",title:"0"},{key:"item8",align:"center",title:"1"},{key:"item9",align:"center",title:"2"},{key:"item10",align:"center",title:"3"},{key:"item11",align:"center",title:"4"},{key:"item12",align:"center",title:"5"},{key:"item13",align:"center",title:"6"},{key:"item14",align:"center",title:"7"},{key:"item15",align:"center",title:"8"},{key:"item16",align:"center",title:"9"},{key:"item17",align:"center",title:"10"},{key:"item18",align:"center",title:"11"},{key:"item19",align:"center",title:"12"},{key:"item20",align:"center",title:"13"},{key:"item21",align:"center",title:"14"},{key:"item22",align:"center",title:"15"},{key:"item23",align:"center",title:"16"},{key:"item24",align:"center",title:"17"},{key:"item25",align:"center",title:"18"},{key:"item26",align:"center",title:"19"},{key:"item27",align:"center",title:"20"},{key:"item28",align:"center",title:"21"},{key:"item29",align:"center",title:"22"},{key:"item30",align:"center",title:"23"},{key:"item31",align:"center",title:"總計",width:50}]),S=m([]),w=m([]),g=m(),_=m();function z(l){var a=new Date(l),o=a.getFullYear(),t=("0"+(a.getMonth()+1)).slice(-2),n=("0"+a.getDate()).slice(-2),e=o+"-"+t+"-"+n;return e}function A(l){const a=_.value,o=new Date;if(o.setHours(0,0,0,0),a){const t=new Date(a);t.setHours(0,0,0,0);const n=new Date(t);n.setDate(n.getDate()-30);const e=new Date(l);if(e.setHours(0,0,0,0),e<n||e>t||e>o)return!0}else{const t=new Date(l);if(t.setHours(0,0,0,0),t>o)return!0}}let F=[{label:"無車",value:"無車"},{label:"無位",value:"無位"},{label:"見車率",value:"見車率"},{label:"見位率",value:"見位率"}],x=[],D="",V=[];const I=(l,a,o)=>{if(x=[],V=[],D="",x=[...l],D=o,a.forEach(t=>{V.push(t.title)}),x.length){const t=b.book_new(),n=b.json_to_sheet(x);b.book_append_sheet(t,n,"sheet1"),b.sheet_add_aoa(n,[V],{origin:"A1"}),ot(t,`${D}.xlsx`)}else return y("空資料不能匯出")};function P(l){const a=g.value,o=new Date;if(o.setHours(0,0,0,0),a){const t=new Date(a);if(t.setHours(0,0,0,0),t>o)return!0;const n=new Date(t);n.setDate(n.getDate()+30);const e=new Date(l);if(e.setHours(0,0,0,0),e<t||e>n||e>o)return!0}else{const t=new Date(l);if(t.setHours(0,0,0,0),t>o)return!0}}function R(){g.value=null,_.value=null}const Y=async()=>{const l={station:h.value===!0?["all"]:p.value.map(e=>parseInt(e.split("-")[0])),dataset_id:"data_analysis",table_id:"daily_empty_full",begin_date:g.value,end_date:_.value,city:[f.value],status:w.value};console.log(l),k.value=!0;const a="https://report.youbike.com.tw/isauth/gcpfun",o=await T.get(a,{params:l});k.value=!1;const t=o.data.data;let n=[];t.forEach(e=>{let M=[];M={item1:z(e.date),item2:e.responsible_area,item3:e.s_no,item4:e.s_name,item5:e.item,item6:e.status,item7:e.r0,item8:e.r1,item9:e.r2,item10:e.r3,item11:e.r4,item12:e.r5,item13:e.r6,item14:e.r7,item15:e.r8,item16:e.r9,item17:e.r10,item18:e.r11,item19:e.r12,item20:e.r13,item21:e.r14,item22:e.r15,item23:e.r16,item24:e.r17,item25:e.r18,item26:e.r19,item27:e.r20,item28:e.r21,item29:e.r22,item30:e.r23,item31:e.total},n.push({...M})}),S.value=[...n],I(S.value,L.value,"見車率統計日報")},q=async()=>{if(f.value==="請選擇")return y("請選擇城市");if(p.value.length===0&&!h.value){y("請選擇場站");return}else if(w.value.length===0){y("請選擇類型");return}else if(g.value==null){y("請選擇結束日期");return}else if(_.value==null){y("請選擇結束日期");return}try{await Y()}catch(l){console.log(l)}},E=m([]),p=m([]),N=m(!1),h=m(!0);function U(l){if(l.length===0){E.value=[],p.value=[];return}N.value=!0,setTimeout(()=>{N.value=!1;const a=[];H.forEach(t=>{l.includes(t.city)&&a.push({label:t.s_name_tw,value:`${t.s_no}-${t.city}`})});const o=p.value.filter(t=>l.includes(t.split("-")[1]));p.value=[...o],E.value=[...a]},200)}K(f,l=>{U(l)});async function G(){try{const l="https://report.youbike.com.tw/isauth/gcpfun",a={dataset_id:"yb2",table_id:"station"},o=await T.get(l,{params:a});console.log(o),H=[...o.data.data]}catch(l){console.log(l)}}return(async()=>await G())(),(l,a)=>{const o=X;return r(),c("div",st,[v(i(lt),{active:k.value,"onUpdate:active":a[0]||(a[0]=t=>k.value=t),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),nt,s("form",{class:Z(["row mx-0",{"report-header":!i(C),"report-header-dark":i(C)}])},[s("div",rt,[ct,s("div",ut,[O(s("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":a[1]||(a[1]=t=>f.value=t)},[dt,i(u).includes(2)?(r(),c("option",mt," 台北市 ")):d("",!0),i(u).includes(3)?(r(),c("option",pt," 新北市 ")):d("",!0),i(u).includes(4)?(r(),c("option",vt," 桃園市 ")):d("",!0),i(u).includes(5)?(r(),c("option",yt," 新竹市 ")):d("",!0),i(u).includes(6)?(r(),c("option",gt," 新竹縣 ")):d("",!0),i(u).includes(20)?(r(),c("option",_t,"竹科")):d("",!0),i(u).includes(7)?(r(),c("option",ft," 苗栗縣 ")):d("",!0),i(u).includes(8)?(r(),c("option",ht," 台中市 ")):d("",!0),i(u).includes(12)?(r(),c("option",kt," 嘉義市 ")):d("",!0),i(u).includes(14)?(r(),c("option",wt," 台南市 ")):d("",!0),i(u).includes(15)?(r(),c("option",xt," 高雄市 ")):d("",!0),i(u).includes(16)?(r(),c("option",bt," 屏東縣 ")):d("",!0)],512),[[Q,f.value]])])]),s("div",Dt,[v(i(et),{checked:h.value,"onUpdate:checked":a[2]||(a[2]=t=>h.value=t),size:"large"},{default:W(()=>[tt("場站全選")]),_:1},8,["checked"])]),s("div",Vt,[v(o,{disabled:h.value,modelValue:p.value,"onUpdate:modelValue":a[3]||(a[3]=t=>p.value=t),filterable:"",options:E.value,placeholder:"請選擇場站名稱","remote-method":U,loading:N.value,class:"text-light mt-3 mt-md-0 px-0 mt-md-1 w240",multiple:"","collapse-tags":"","collapse-tags-tooltip":"",clearable:""},null,8,["disabled","modelValue","options","loading"])]),Et,s("div",Nt,[v(i(at),{class:"px-0",value:w.value,"onUpdate:value":a[4]||(a[4]=t=>w.value=t),placeholder:"請選擇",multiple:"",options:i(F),"max-tag-count":1,size:"medium"},null,8,["value","options"])]),s("div",Ct,[v(i(j),{class:"px-0","formatted-value":g.value,"onUpdate:formattedValue":a[5]||(a[5]=t=>g.value=t),type:"date",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"開始日期","value-format":"yyyy-MM-dd","is-date-disabled":A},null,8,["formatted-value"])]),s("div",Ht,[v(i(j),{class:"px-0","formatted-value":_.value,"onUpdate:formattedValue":a[6]||(a[6]=t=>_.value=t),type:"date",actions:null,"input-readonly":!0,"is-date-disabled":P,"update-value-on-close":!0,placeholder:"結束日期","value-format":"yyyy-MM-dd"},null,8,["formatted-value"])]),s("div",{class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},[s("button",{type:"button",class:"btn btn-info text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:R}," 清空日期 ")]),s("div",{class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},[s("button",{type:"button",class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:q}," 搜尋匯出 ")])],2),v(i(it),{class:"mt-5",status:"info",title:"此頁面只供下載EXCEL"})])}}};export{It as default};
