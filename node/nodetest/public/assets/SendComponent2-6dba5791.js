import{i as f,r as p,o as b,x as B,w as n,b as i,d as s,e as o,f as C,h as E,j as $,bh as L,k as q}from"./index-9fc17187.js";import{a as I,N as Y}from"./FormItem-d128c4e2.js";const j={class:"fw-bold"},z={class:"row"},A={class:"col-12"},S={class:"row"},D={class:"col text-center"},O={__name:"SendComponent2",props:{maildata:{type:Array,required:!0},city:{type:String,required:!0},type:{type:String,required:!0}},setup(h){const u=h,v=f("$swal");async function x(t){v({icon:"success",title:`${t}`,showConfirmButton:!1})}const r=p({textareaValue:null}),y={textareaValue:{required:!0,validator(t,e){let a=!0,l=null;return e.split(`
`).forEach((c,N)=>{(c.charAt(c.length-1)!==","||c.indexOf("@")===-1)&&(l=N,a=!1)}),!a&&e?new Error(`第${l+1}行格式錯誤`):!0},trigger:["blur","input"]}};function _(){const l=r.value.textareaValue.split(`
`).map(m=>m.trim()).join(`
`);r.value.textareaValue=l}function w(t){let e="";return t.forEach((a,l)=>{l===t.length-1?e+=`${a.mail},`:e+=`${a.mail},
`}),e===","?null:e}const d=p(null);async function g(){try{return await d.value.validate(),"驗證成功"}catch{throw new Error("驗證失敗")}}const V=f("getData"),k=async()=>{try{await g();const t=r.value.textareaValue.split(",").filter(a=>a).map(a=>a.replace(/\n/g,"")),e="https://report.youbike.com.tw/mail/station/status";await q.put(e,{city:u.city,mailList:[...t],type:u.type}),await x("儲存成功"),await V()}catch(t){console.log(t)}};return(async()=>r.value.textareaValue=w(u.maildata))(),(t,e)=>(b(),B(s(L),{size:"medium",preset:"dialog"},{default:n(()=>[i(s(I),{ref_key:"formRef",ref:d,model:r.value,rules:y},{default:n(()=>[o("div",j,[o("div",z,[o("div",A,[i(s(Y),{path:"textareaValue",label:"Email","label-style":"font-weight: 700; font-size:16px",rules:"rules.textareaValue"},{default:n(()=>[i(s(C),{size:"large",value:r.value.textareaValue,"onUpdate:value":e[0]||(e[0]=a=>r.value.textareaValue=a),onChange:_,placeholder:`IloveYouBike@gmail.com,
YouLoveYouBike@gmail.com,
WeLoveYouBike@gmail.com,
`,type:"textarea"},null,8,["value"])]),_:1})])])]),o("div",S,[o("div",D,[i(s(E),{type:"info",class:"me-3",onClick:k},{default:n(()=>[$("儲存")]),_:1})])])]),_:1},8,["model"])]),_:1}))}};export{O as _};
