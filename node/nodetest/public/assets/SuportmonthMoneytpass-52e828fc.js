import{i as _,r as u,o as T,c as $,b as d,d as o,e as s,n as C,k as M,m as B,j as E}from"./index-3459458a.js";import{L as P}from"./index-fcaa1a70.js";import{_ as j}from"./OutputExcel-14eb8bfa.js";import{N as z}from"./DatePicker-0f56cdd4.js";import{N as A}from"./DataTable-83b67cc2.js";import"./xlsx-bd534488.js";import"./Forward-c5c87e0a.js";import"./Input-c173e393.js";import"./get-slot-1efb97e5.js";const L={class:"container-fluid px-0"},V=s("div",{class:"row mx-0"},[s("h1",{class:"report-h1 fw-bold"},"TPASS補助款月報")],-1),F={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},U={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},Y={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},X={__name:"SuportmonthMoneytpass",setup(q){const k=_("$swal");async function w(a){k({icon:"error",title:`${a}`,showConfirmButton:!1})}const v=_("ischange"),r=u(),m=u(!1),c=u([]),x=u(null),y=[{key:"num1",align:"center",fixed:"left",title:"專案別"},{key:"num2",align:"center",title:"系統別"},{key:"num3",align:"center",title:"補助款項目"},{key:"num4",align:"center",title:"票卡"},{key:"num5",align:"center",title:"筆數"},{key:"num6",align:"center",title:"補助金額"},{key:"num7",align:"center",fixed:"left",title:"單筆補助金額"}];let p=[],f="",h=[];const b=(a,t,n)=>{p=[],f="",h=[],p=[...a],f=n,t.forEach(l=>{h.push(l.title)})},N=a=>{const t=new Date(a),n=t.getFullYear(),l=t.getMonth()+1,i=new Date,e=i.getFullYear(),g=i.getMonth()+1;return n===e&&l>g||n>e||n<2023},D=async()=>{try{c.value=[],m.value=!0;const a="https://report.youbike.com.tw/isauth/gcpfun",t={dataset_id:"financial_report",table_id:"monthly_pass",date:`${r.value}-01`},l=[...(await E.get(a,{params:t})).data.data];l.sort((e,g)=>e.rank-g.rank);let i=[];l.forEach(e=>{i.push({num1:e.project,num2:e.sys,num3:e.item,num4:e.card,num5:e.CNT,num6:e.amount,num7:e.subsidy})}),c.value=[...i],b(c.value,y,`${r.value}TPASS補助款月報`),x.value.page(1),m.value=!1}catch(a){console.log(a)}},S=()=>{if(!r.value)return w("請選擇日期");D()};return(a,t)=>(T(),$("div",L,[d(o(P),{active:m.value,"onUpdate:active":t[0]||(t[0]=n=>m.value=n),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),V,s("form",{class:C(["row mx-0",{"report-header":!o(v),"report-header-dark":o(v)}])},[s("div",F,[s("div",U,[d(o(z),{class:"px-0","formatted-value":r.value,"onUpdate:formattedValue":t[1]||(t[1]=n=>r.value=n),type:"month",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"請選擇日期","value-format":"yyyy-MM","is-date-disabled":N},null,8,["formatted-value"])])]),s("div",Y,[s("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:S}," 搜尋 "),d(j,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:o(p),name:o(f),header:o(h)},null,8,["data","name","header"])])],2),M(d(o(A),{size:"small",data:c.value,ref_key:"dataTable",ref:x,columns:y,pagination:{pageSize:17},"max-height":600,"scroll-x":500,bordered:!1,"single-line":!1,striped:""},null,8,["data"]),[[B,c.value.length>1]])]))}};export{X as default};
