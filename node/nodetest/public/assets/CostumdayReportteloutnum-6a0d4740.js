import{i as h,r as m,o as v,c as B,b as y,d as n,e as l,n as z,x as E,m as T,L as V,q as $,k as L}from"./index-bfe704f8.js";import{_ as M}from"./OutputExcel-bfa1334f.js";import{N as A}from"./DataTable-9584a8e3.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const I={class:"container-fluid px-0"},S=l("div",{class:"row mx-0"},[l("h1",{class:"report-h1 fw-bold"},"外撥通數統計")],-1),U={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},j={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},q={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},J={__name:"CostumdayReportteloutnum",setup(F){const f=h("ischange"),x=h("$swal");async function w(a){x({icon:"error",title:`${a}`,showConfirmButton:!1})}const _=m(null),s=m(!1),o=m([]),c=m(),b=a=>{const e=new Date(a),i=new Date,r=new Date(i.getFullYear(),i.getMonth(),i.getDate());return e<new Date(2023,7,8)||e>=r},k=[{key:"item1",align:"center",fixed:"left",title:"員工編號",width:100},{key:"item2",align:"center",title:"姓名",width:100},{key:"item3",align:"center",title:"0-1"},{key:"item4",align:"center",title:"1-2"},{key:"item5",align:"center",title:"2-3"},{key:"item6",align:"center",title:"3-4"},{key:"item7",align:"center",title:"4-5"},{key:"item8",align:"center",title:"5-6"},{key:"item9",align:"center",title:"6-7"},{key:"item10",align:"center",title:"7-8"},{key:"item11",align:"center",title:"8-9"},{key:"item12",align:"center",title:"9-10"},{key:"item13",align:"center",title:"10-11"},{key:"item14",align:"center",title:"11-12"},{key:"item15",align:"center",title:"12-13"},{key:"item16",align:"center",title:"13-14"},{key:"item17",align:"center",title:"14-15"},{key:"item18",align:"center",title:"15-16"},{key:"item19",align:"center",title:"16-17"},{key:"item20",align:"center",title:"17-18"},{key:"item21",align:"center",title:"18-19"},{key:"item22",align:"center",title:"19-20"},{key:"item23",align:"center",title:"20-21"},{key:"item24",align:"center",title:"21-22"},{key:"item25",align:"center",title:"22-23"},{key:"item26",align:"center",title:"23-24"},{key:"item27",align:"center",title:"合計"}];let d=[],u="",g=[];const D=(a,e,i)=>{d=[],u="",g=[],d=[...a],u=i,e.forEach(r=>{g.push(r.title)})},C=async()=>{try{const a="http://127.0.0.1:3000/isauth/gcpfun";let e={dataset_id:"yb2",table_id:"CTI_callout",date:c.value};s.value=!0;const r=(await L.get(a,{params:e})).data.data;let p=[];r.forEach(t=>{p.push({item1:t.AID,item2:t.name,item3:t.zero,item4:t.one,item5:t.two,item6:t.three,item7:t.four,item8:t.five,item9:t.six,item10:t.seven,item11:t.eight,item12:t.nine,item13:t.ten,item14:t.eleven,item15:t.twelve,item16:t.thirteen,item17:t.fourteen,item18:t.fifthteen,item19:t.sixteen,item20:t.seventeen,item21:t.eighteen,item22:t.nineteen,item23:t.twenty,item24:t.twenty_one,item25:t.twenty_two,item26:t.twenty_three,item27:t.total})}),o.value=[...p],D(o.value,k,"外撥通數統計"),s.value=!1}catch(a){console.log(a)}},N=async()=>{if(!c.value)return w("請選擇日期");await C()};return(a,e)=>(v(),B("div",I,[y(n(V),{active:s.value,"onUpdate:active":e[0]||(e[0]=i=>s.value=i),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),S,l("form",{class:z(["row mx-0",{"report-header":!n(f),"report-header-dark":n(f)}])},[l("div",U,[l("div",j,[y(n($),{class:"px-0","formatted-value":c.value,"onUpdate:formattedValue":e[1]||(e[1]=i=>c.value=i),type:"date",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"請選擇日期","value-format":"yyyy-MM-dd","is-date-disabled":b},null,8,["formatted-value"])])]),l("div",q,[l("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:N}," 搜尋 "),y(M,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:n(d),name:n(u),header:n(g)},null,8,["data","name","header"])])],2),o.value.length>1?(v(),E(n(A),{key:0,ref_key:"dataTable",ref:_,size:"small",pagination:{pageSize:17},columns:k,data:o.value,"max-height":600,"scroll-x":1200,bordered:!1,"single-line":!1,striped:""},null,8,["data"])):T("",!0)]))}};export{J as default};
