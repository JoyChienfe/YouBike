import{_ as P,i as $,u as Y,r as _,o as t,c as o,b as T,d as e,e as l,l as M,v as S,F as N,m as s,n as q,x as z,L as K,q as j,s as A,t as G,k as J}from"./index-1377d8f9.js";import{_ as Q}from"./OutputExcel-bd81d639.js";import{N as R}from"./DataTable-750ad636.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const r=y=>(A("data-v-c7c7f53a"),y=y(),G(),y),W={class:"container-fluid px-0"},X=r(()=>l("div",{class:"row mx-0"},[l("h1",{class:"report-h1 fw-bold"},"營運管理月報")],-1)),Z={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},ee=r(()=>l("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"系統別:",-1)),te={class:"col-md-auto px-0"},oe=r(()=>l("option",{selected:"",disabled:""},"請選擇",-1)),se=r(()=>l("option",{value:"1"},"1.0",-1)),ae=r(()=>l("option",{value:"2"},"2.0",-1)),ie=r(()=>l("option",{value:"2E"},"2.0E",-1)),ne=[oe,se,ae,ie],le={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},ce=r(()=>l("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"城市:",-1)),ue={class:"col-md-auto px-0"},de=r(()=>l("option",{selected:"",disabled:""},"請選擇",-1)),re={key:0,value:"Taipei2"},me={key:1,value:"Newtaipei2"},_e={key:2,value:"Taoyuan2"},he={key:3,value:"Hsinchu2"},pe={key:4,value:"Hsinchu_Country2"},ve={key:5,value:"HsinchuScience2"},ye={key:6,value:"Miaoli2"},fe={key:7,value:"Taichung2"},ke={key:8,value:"Chiayi2"},ge={key:9,value:"Chiayi_Country2"},xe={key:10,value:"Tainan2"},be={key:11,value:"Kaohsiung2"},Ee={key:12,value:"Pingtung2"},Ce={key:13,value:"Taitung2"},Te={key:0,value:"Newtaipei"},Ne={key:1,value:"Taoyuan"},De={key:2,value:"Miaoli"},we={key:0,value:"Taipei2E"},$e={key:1,value:"Newtaipei2E"},Me={key:2,value:"Taoyuan2E"},Se={key:3,value:"Hsinchu_Country2E"},Ve={key:4,value:"HsinchuScience2E"},Be={key:5,value:"Miaoli2E"},He={key:6,value:"Taichung2E"},Ue={key:7,value:"Chiayi2E"},Fe={key:8,value:"Chiayi_Country2E"},Ie={key:9,value:"Tainan2E"},Le={key:10,value:"Kaohsiung2E"},Oe={key:11,value:"Pingtung2E"},Pe={key:12,value:"Taitung2E"},Ye={class:"row mx-0 mx-md-2 align-items-center col-md-2 col-12 mt-3 mt-md-0"},qe={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},ze={__name:"OperationMonthDaily",setup(y){const D=$("ischange"),a=Y().citys,V=$("$swal");async function b(i){V({icon:"error",title:`${i}`,showConfirmButton:!1})}const B=i=>{const u=new Date(i).getFullYear(),v=new Date().getFullYear();return u<2020||u>v},H=_(null),h=_("請選擇"),f=_(!1),m=_("請選擇"),p=_([]),k=_([]),g=_();let x=[],E="",C=[];const U=(i,c,u)=>{x=[],E="",C=[],x=[...i],E=u,c.forEach(d=>{C.push(d.title)})},F=async()=>{try{const i="https://report.youbike.com.tw/isauth/gcpfun",c={dataset_id:"report",table_id:`monthly_report_query${m.value}`,city:h.value,date:g.value};f.value=!0;const u=await J.get(i,{params:c});f.value=!1;let d=[];if(d=u.data.data,d.length===0){k.value=[],p.value=[],x=[];return}let v=[{key:"item1",align:"center",fixed:"left",width:"200",title:d[0].item},{key:"item2",align:"center",title:d[0].year1}];for(let n=1;n<=12;n++)v.push({key:`item${n+2}`,align:"center",title:d[0][`month${n}`]});v.push({key:"item15",align:"center",title:d[0].year2});let w=[];d.forEach((n,O)=>{O!==0&&w.push({item1:n.item,item2:n.year1,item3:n.month1,item4:n.month2,item5:n.month3,item6:n.month4,item7:n.month5,item8:n.month6,item9:n.month7,item10:n.month8,item11:n.month9,item12:n.month10,item13:n.month11,item14:n.month12,item15:n.year2})}),k.value=[...v],p.value=[...w],U(p.value,k.value,"經營管理月報")}catch(i){console.log(i)}},I=async()=>{if(m.value=="請選擇")return b("請選擇系統別");if(h.value==="請選擇")return b("請選擇城市");if(!g.value)return b("請選擇日期");F()},L=i=>{if(i.item1==="場站資訊"||i.item1==="租借資訊"||i.item1==="收入資訊"||i.item1==="妥善率資訊"||i.item1==="票卡資訊"||i.item1==="當月租借車次"&&!i.item2&&!i.item3&&!i.item4&&!i.item5&&!i.item6||i.item1==="註冊票卡淨增加數"||i.item1==="租賃收入明細"||i.item1==="各時段使用資訊"||i.item1==="營運資訊"||i.item1==="租賃時間使用資訊"||i.item1==="維護管理"||i.item1==="騎乘距離分析"||i.item1=="保險投保數量")return"too-old"};return(i,c)=>(t(),o("div",W,[T(e(K),{active:f.value,"onUpdate:active":c[0]||(c[0]=u=>f.value=u),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),X,l("form",{class:q(["row mx-0",{"report-header":!e(D),"report-header-dark":e(D)}])},[l("div",Z,[ee,l("div",te,[M(l("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":c[1]||(c[1]=u=>m.value=u),onChange:c[2]||(c[2]=u=>h.value="請選擇")},ne,544),[[S,m.value]])])]),l("div",le,[ce,l("div",ue,[M(l("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":c[3]||(c[3]=u=>h.value=u)},[de,m.value==2?(t(),o(N,{key:0},[e(a).includes(2)?(t(),o("option",re,"台北市")):s("",!0),e(a).includes(3)?(t(),o("option",me,"新北市")):s("",!0),e(a).includes(4)?(t(),o("option",_e,"桃園市")):s("",!0),e(a).includes(5)?(t(),o("option",he,"新竹市")):s("",!0),e(a).includes(6)?(t(),o("option",pe," 新竹縣 ")):s("",!0),e(a).includes(20)?(t(),o("option",ve," 竹科 ")):s("",!0),e(a).includes(7)?(t(),o("option",ye,"苗栗縣")):s("",!0),e(a).includes(8)?(t(),o("option",fe,"台中市")):s("",!0),e(a).includes(12)?(t(),o("option",ke,"嘉義市")):s("",!0),e(a).includes(13)?(t(),o("option",ge," 嘉義縣 ")):s("",!0),e(a).includes(14)?(t(),o("option",xe,"台南市")):s("",!0),e(a).includes(15)?(t(),o("option",be,"高雄市")):s("",!0),e(a).includes(16)?(t(),o("option",Ee,"屏東縣")):s("",!0),e(a).includes(19)?(t(),o("option",Ce,"台東縣")):s("",!0)],64)):m.value==1?(t(),o(N,{key:1},[e(a).includes(3)?(t(),o("option",Te,"新北市")):s("",!0),e(a).includes(4)?(t(),o("option",Ne,"桃園市")):s("",!0),e(a).includes(7)?(t(),o("option",De,"苗栗縣")):s("",!0)],64)):m.value=="2E"?(t(),o(N,{key:2},[e(a).includes(2)?(t(),o("option",we,"台北市")):s("",!0),e(a).includes(3)?(t(),o("option",$e,"新北市")):s("",!0),e(a).includes(4)?(t(),o("option",Me,"桃園市")):s("",!0),e(a).includes(6)?(t(),o("option",Se," 新竹縣 ")):s("",!0),e(a).includes(20)?(t(),o("option",Ve," 竹科 ")):s("",!0),e(a).includes(7)?(t(),o("option",Be,"苗栗縣")):s("",!0),e(a).includes(8)?(t(),o("option",He,"台中市")):s("",!0),e(a).includes(12)?(t(),o("option",Ue,"嘉義市")):s("",!0),e(a).includes(13)?(t(),o("option",Fe," 嘉義縣 ")):s("",!0),e(a).includes(14)?(t(),o("option",Ie,"台南市")):s("",!0),e(a).includes(15)?(t(),o("option",Le,"高雄市")):s("",!0),e(a).includes(16)?(t(),o("option",Oe,"屏東縣")):s("",!0),e(a).includes(19)?(t(),o("option",Pe,"台東縣")):s("",!0)],64)):s("",!0)],512),[[S,h.value]])])]),l("div",Ye,[T(e(j),{class:"px-0","formatted-value":g.value,"onUpdate:formattedValue":c[4]||(c[4]=u=>g.value=u),type:"year",actions:null,"input-readonly":!0,"is-date-disabled":B,placeholder:"請選擇日期","value-format":"yyyy"},null,8,["formatted-value"])]),l("div",qe,[l("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:I}," 搜尋 "),T(Q,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:e(x),name:e(E),header:e(C)},null,8,["data","name","header"])])],2),p.value.length?(t(),z(e(R),{key:0,size:"small",ref_key:"table",ref:H,"row-class-name":L,columns:k.value,data:p.value,"max-height":600,"scroll-x":1e3,bordered:!1,"single-line":!1,striped:""},null,8,["columns","data"])):s("",!0)]))}},Re=P(ze,[["__scopeId","data-v-c7c7f53a"]]);export{Re as default};
