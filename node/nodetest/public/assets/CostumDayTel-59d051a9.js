import{i as g,r as d,o as x,c as $,b as h,d as l,e as o,n as E,x as M,m as T,L as V,q as L,k as z}from"./index-9c026bac.js";import{_ as F}from"./OutputExcel-850e7656.js";import{N as P}from"./DataTable-a8e5321a.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const U={class:"container-fluid px-0"},Y=o("div",{class:"row mx-0"},[o("h1",{class:"report-h1 fw-bold"},"補償券月報")],-1),j={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},q={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},A={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Q={__name:"CostumDayTel",setup(G){const v=g("ischange"),_=g("$swal");async function b(t){_({icon:"error",title:`${t}`,showConfirmButton:!1})}const w=d(null),i=d(!1),m=d([]),n=d(),k=t=>{const e=new Date(t),a=e.getFullYear(),r=e.getMonth()+1,c=new Date,s=c.getFullYear(),B=c.getMonth()+1;return a===s&&r>B||a>s||a<2023},y=[{key:"item1",align:"center",fixed:"left",title:"項目"},{key:"item2",align:"center",title:"使用縣市"},{key:"item3",align:"center",title:"車種"},{key:"item4",align:"center",title:"使用次數"},{key:"item5",align:"center",title:"使用金額"}];let u=[],p="",f=[];const N=(t,e,a)=>{u=[],p="",f=[],u=[...t],p=a,e.forEach(r=>{f.push(r.title)})},C=async()=>{try{const t="https://report.youbike.com.tw/isauth/gcpfun";let e={dataset_id:"report",table_id:"refund_report",date:n.value};i.value=!0;const r=(await z.get(t,{params:e})).data.data;let c=[];r.forEach(s=>{c.push({item1:s.item,item2:s.city,item3:s.sys,item4:s.numbers,item5:s.total})}),m.value=[...c],N(m.value,y,`${n.value}補償卷月報`),i.value=!1}catch(t){console.log(t)}},D=async()=>{if(!n.value)return b("請選擇日期");await C()};return(t,e)=>(x(),$("div",U,[h(l(V),{active:i.value,"onUpdate:active":e[0]||(e[0]=a=>i.value=a),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),Y,o("form",{class:E(["row mx-0",{"report-header":!l(v),"report-header-dark":l(v)}])},[o("div",j,[o("div",q,[h(l(L),{class:"px-0","formatted-value":n.value,"onUpdate:formattedValue":e[1]||(e[1]=a=>n.value=a),type:"month",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"請選擇日期","value-format":"yyyy-MM","is-date-disabled":k},null,8,["formatted-value"])])]),o("div",A,[o("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:D}," 搜尋 "),h(F,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:l(u),name:l(p),header:l(f)},null,8,["data","name","header"])])],2),m.value.length>1?(x(),M(l(P),{key:0,ref_key:"dataTable",ref:w,size:"small",columns:y,data:m.value,"scroll-x":500,bordered:!1,"single-line":!1,striped:""},null,8,["data"])):T("",!0)]))}};export{Q as default};
