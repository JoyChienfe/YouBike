import{i as k,r as m,o as B,c as z,b as p,d as l,e as r,n as F,k as L,m as j,j as A}from"./index-3459458a.js";import{L as P}from"./index-fcaa1a70.js";import{_ as q}from"./OutputExcel-14eb8bfa.js";import{N as M}from"./DatePicker-0f56cdd4.js";import{N as G}from"./DataTable-83b67cc2.js";import"./xlsx-bd534488.js";import"./Forward-c5c87e0a.js";import"./Input-c173e393.js";import"./get-slot-1efb97e5.js";const I={class:"container-fluid px-0"},J=r("div",{class:"row mx-0"},[r("h1",{class:"report-h1 fw-bold"},"每日新增&刪減票卡數")],-1),K={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},O={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},Q={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},R={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},rt={__name:"EverydayEdit",setup(W){const _=k("ischange"),C=k("$swal");async function b(a){C({icon:"error",title:`${a}`,showConfirmButton:!1})}const i=m(),u=m(),f=m(!1),D=m(null),v=m([]),g=m();let h=[],y="",x=[];const H=(a,e,t)=>{h=[],y="",x=[],h=[...a],y=t,e.forEach(o=>{x.push(o.title)})},E=a=>{const e=u.value,t=new Date;t.setHours(0,0,0,0);const o=new Date(a),c=o.getFullYear(),w=o.getMonth()+1;if(c<2023||c===2023&&w<9)return!0;if(e){const s=new Date(e);s.setHours(0,0,0,0);const d=new Date(s);d.setDate(d.getDate()-30);const n=new Date(a);if(n.setHours(0,0,0,0),n<d||n>s||n>=t)return!0}else{const s=new Date(a);if(s.setHours(0,0,0,0),s>=t)return!0}},N=a=>{const e=i.value,t=new Date;t.setHours(0,0,0,0);const o=new Date(a),c=o.getFullYear(),w=o.getMonth()+1;if(c<2023||c===2023&&w<9)return!0;if(e){const s=new Date(e);if(s.setHours(0,0,0,0),s>t)return!0;const d=new Date(s);d.setDate(d.getDate()+30);const n=new Date(a);if(n.setHours(0,0,0,0),n<s||n>d||n>=t)return!0}else{const s=new Date(a);if(s.setHours(0,0,0,0),s>=t)return!0}};function T(a){const e=new Date(a),t=e.getUTCFullYear(),o=(e.getUTCMonth()+1).toString().padStart(2,"0"),c=e.getUTCDate().toString().padStart(2,"0");return`${t}-${o}-${c}`}const Y=()=>{i.value=null,u.value=null},$=()=>{let a=[{key:"item1",align:"center",title:"日期"},{key:"item2",align:"center",title:"縣市"},{key:"item3",align:"center",title:"刪減票卡數"},{key:"item4",align:"center",title:"增加票卡數"}];g.value=[...a]},S=a=>{let e=[];a.forEach(t=>{e.push({item1:T(t.date),item2:t.city,item3:t.del_card,item4:t.add_card})}),v.value=[...e]},U=async()=>{const a="https://report.youbike.com.tw/isauth/gcpfun",e={dataset_id:"report",table_id:"add_del_card",begin_date:i.value,end_date:u.value};try{f.value=!0;const t=await A.get(a,{params:e});f.value=!1;const o=t.data.data;$(),S(o),D.value&&D.value.page(1),H(v.value,g.value,"每日新增&刪減票卡數")}catch(t){console.log(t)}},V=()=>{if(i.value){if(!u.value){b("請選擇結束日期");return}}else{b("請選擇開始日期");return}U()};return(a,e)=>(B(),z("div",I,[p(l(P),{active:f.value,"onUpdate:active":e[0]||(e[0]=t=>f.value=t),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),J,r("form",{class:F(["row mx-0",{"report-header":!l(_),"report-header-dark":l(_)}])},[r("div",K,[r("div",O,[p(l(M),{class:"px-0","formatted-value":i.value,"onUpdate:formattedValue":e[1]||(e[1]=t=>i.value=t),type:"date",actions:null,"input-readonly":!0,"update-value-on-close":!0,"default-time":"2023-06-20",placeholder:"開始日期","value-format":"yyyy-MM-dd","is-date-disabled":E},null,8,["formatted-value"])]),r("div",Q,[p(l(M),{class:"px-0","formatted-value":u.value,"onUpdate:formattedValue":e[2]||(e[2]=t=>u.value=t),type:"date",actions:null,"input-readonly":!0,"is-date-disabled":N,"update-value-on-close":!0,placeholder:"結束日期","value-format":"yyyy-MM-dd"},null,8,["formatted-value"])])]),r("div",R,[r("button",{type:"button",class:"btn btn-info text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:Y}," 清空日期 "),r("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:V}," 搜尋 "),p(q,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:l(h),name:l(y),header:l(x)},null,8,["data","name","header"])])],2),L(p(l(G),{ref_key:"dataTable",ref:D,size:"small",columns:g.value,data:v.value,pagination:{pageSize:13},"max-height":600,"scroll-x":500,bordered:!1,"single-line":!1,striped:""},null,8,["columns","data"]),[[j,v.value.length>0]])]))}};export{rt as default};
