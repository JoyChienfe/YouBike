/* empty css                     */import{u as J,r,i as j,z as K,o as n,c,b as v,d as l,e as s,l as z,v as A,m as u,w as O,n as Q,k as B,E as W,L as Z,j as X,A as tt,y as et,q as ot}from"./index-e7986d38.js";import{u as M,w as at}from"./xlsx-bd534488.js";import{N as st}from"./Result-9a9b869e.js";import"./Warning-f10a1cf1.js";const lt={class:"container-fluid px-0"},it=s("div",{class:"row mx-0"},[s("h1",{class:"report-h1 fw-bold"},"見車率統計月報")],-1),nt={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},ct=s("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"城市:",-1),dt={class:"col-md-auto px-0"},ut=s("option",{selected:"",disabled:""},"請選擇",-1),rt={key:0,value:"台北市"},mt={key:1,value:"新北市"},pt={key:2,value:"桃園市"},_t={key:3,value:"新竹市"},vt={key:4,value:"新竹縣"},yt={key:5,value:"竹科"},ht={key:6,value:"苗栗縣"},ft={key:7,value:"台中市"},gt={key:8,value:"嘉義市"},xt={key:9,value:"嘉義縣"},bt={key:10,value:"台南市"},wt={key:11,value:"高雄市"},kt={key:12,value:"屏東縣"},Mt={key:13,value:"台東縣"},Vt={class:"row col-md-auto col-12 my-auto pt-2"},$t={class:"row col-md-auto col-12 mx-auto mx-md-0"},Nt={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Dt=s("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"區間:",-1),Et={class:"col-md-auto px-0"},St=s("option",{selected:"",disabled:""},"請選擇",-1),Ut=s("option",{value:"all_day"},"全天",-1),Ct=s("option",{value:"6_to_24_hour"},"6-24點",-1),Lt=[St,Ut,Ct],Yt=s("div",{class:"row mx-0 ms-md-0 align-items-center col-md-auto col-12"},[s("label",{class:"col-md-auto ms-md-0 col-form-label px-0 px-md-2 fw-bolder"},"類型:")],-1),jt={class:"row col-md-2 align-items-center mx-0 ps-md-0"},zt={class:"row ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},It={__name:"LookcarReportMonth",setup(At){const d=J().citys,g=r(!1),S=j("ischange"),F=j("$swal"),y=r("請選擇");async function _(a){F({icon:"error",title:`${a}`,showConfirmButton:!1})}let U=[];const C=r([]),x=r([]),b=r(R()),h=r("請選擇");function R(){const a=new Date,e=a.getFullYear(),i=a.getMonth(),o=i===0?e-1:e,m=i===0?12:i,t=o+"-"+("0"+m).slice(-2);return console.log(t),t}function L(a){const e=new Date(a),i=new Date,o=i.getMonth()+1,m=i.getFullYear(),t=e.getFullYear(),k=e.getMonth()+1;return t<2024||t===2024&&k>o-1||t>m}L();let P=[{label:"無車",value:"無車"},{label:"無位",value:"無位"},{label:"見車率",value:"見車率"},{label:"見位率",value:"見位率"}],w=[],V="",$=[];const T=(a,e,i)=>{if(w=[],$=[],V="",w=[...a],V=i,$=[...e],w.length){const o=M.book_new(),m=M.json_to_sheet(w);M.book_append_sheet(o,m,"sheet1"),M.sheet_add_aoa(m,[$],{origin:"A1"}),at(o,`${V}.xlsx`)}else return _("空資料不能匯出")};let N=[];function q(){N=[];function a(){const e=[];for(let i=1;i<=31;i++)e.push(`${i}`);return e}N=["責任區","場站代號","站名","車位數","狀態",...a(),"總計"]}const I=async()=>{const a={dataset_id:"data_analysis",table_id:"monthly_empty_full_station",date:`${b.value}-01`,city:[y.value],item:h.value,status:x.value,station:f.value===!0?["all"]:p.value.map(t=>parseInt(t.split("-")[0]))};g.value=!0;const e="https://report.youbike.com.tw/isauth/gcpfun",i=await B.get(e,{params:a});g.value=!1;const o=i.data.data;let m=[];o.forEach(t=>{let k=[];k={item1:t.responsible_area,item3:t.s_no,item4:t.s_name,item5:t.s_total,item6:t.status,item7:t.day1,item8:t.day2,item9:t.day3,item10:t.day4,item11:t.day5,item12:t.day6,item13:t.day7,item14:t.day8,item15:t.day9,item16:t.day10,item17:t.day11,item18:t.day12,item19:t.day13,item20:t.day14,item21:t.day15,item22:t.day16,item23:t.day17,item24:t.day18,item25:t.day19,item26:t.day20,item27:t.day21,item28:t.day22,item29:t.day23,item30:t.day24,item31:t.day25,item32:t.day26,item33:t.day27,item34:t.day28,item35:t.day29,item36:t.day30,item37:t.day31,item38:t.total},m.push({...k})}),C.value=[...m],q(),T(C.value,N,`${h.value==="all_day"?"全天":"6-24點"}_見車率統計月報`)},G=async()=>{if(y.value==="請選擇")return _("請選擇城市");if(h.value==="請選擇"){_("請選擇區間");return}else if(p.value.length===0&&!f.value){_("請選擇場站");return}else if(x.value.length===0){_("請選擇類型");return}else if(b.value==null){_("請選擇日期");return}try{await I()}catch(a){console.log(a)}},D=r([]),p=r([]),E=r(!1),f=r(!0);function Y(a){if(a.length===0){D.value=[],p.value=[];return}E.value=!0,setTimeout(()=>{E.value=!1;const e=[];U.forEach(o=>{a.includes(o.city)&&e.push({label:o.s_name_tw,value:`${o.s_no}-${o.city}`})});const i=p.value.filter(o=>a.includes(o.split("-")[1]));p.value=[...i],D.value=[...e]},200)}K(y,a=>{Y(a)});async function H(){const a="https://report.youbike.com.tw/isauth/gcpfun",e={dataset_id:"yb2",table_id:"station"};U=[...(await B.get(a,{params:e})).data.data]}return(async()=>await H())(),(a,e)=>{const i=W;return n(),c("div",lt,[v(l(Z),{active:g.value,"onUpdate:active":e[0]||(e[0]=o=>g.value=o),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),it,s("form",{class:Q(["row mx-0",{"report-header":!l(S),"report-header-dark":l(S)}])},[s("div",nt,[ct,s("div",dt,[z(s("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":e[1]||(e[1]=o=>y.value=o)},[ut,l(d).includes(2)?(n(),c("option",rt," 台北市 ")):u("",!0),l(d).includes(3)?(n(),c("option",mt," 新北市 ")):u("",!0),l(d).includes(4)?(n(),c("option",pt," 桃園市 ")):u("",!0),l(d).includes(5)?(n(),c("option",_t," 新竹市 ")):u("",!0),l(d).includes(6)?(n(),c("option",vt," 新竹縣 ")):u("",!0),l(d).includes(20)?(n(),c("option",yt,"竹科")):u("",!0),l(d).includes(7)?(n(),c("option",ht," 苗栗縣 ")):u("",!0),l(d).includes(8)?(n(),c("option",ft," 台中市 ")):u("",!0),l(d).includes(12)?(n(),c("option",gt," 嘉義市 ")):u("",!0),l(d).includes(13)?(n(),c("option",xt," 嘉義縣 ")):u("",!0),l(d).includes(14)?(n(),c("option",bt," 台南市 ")):u("",!0),l(d).includes(15)?(n(),c("option",wt," 高雄市 ")):u("",!0),l(d).includes(16)?(n(),c("option",kt," 屏東縣 ")):u("",!0),l(d).includes(19)?(n(),c("option",Mt," 台東縣 ")):u("",!0)],512),[[A,y.value]])])]),s("div",Vt,[v(l(tt),{checked:f.value,"onUpdate:checked":e[2]||(e[2]=o=>f.value=o),size:"large"},{default:O(()=>[X("場站全選")]),_:1},8,["checked"])]),s("div",$t,[v(i,{disabled:f.value,modelValue:p.value,"onUpdate:modelValue":e[3]||(e[3]=o=>p.value=o),filterable:"",options:D.value,placeholder:"請選擇場站名稱","remote-method":Y,loading:E.value,class:"text-light mt-3 mt-md-0 px-0 mt-md-1 w240",multiple:"","collapse-tags":"","collapse-tags-tooltip":"",clearable:""},null,8,["disabled","modelValue","options","loading"])]),s("div",Nt,[Dt,s("div",Et,[z(s("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":e[4]||(e[4]=o=>h.value=o)},Lt,512),[[A,h.value]])])]),Yt,s("div",jt,[v(l(et),{class:"px-0",value:x.value,"onUpdate:value":e[5]||(e[5]=o=>x.value=o),placeholder:"請選擇",multiple:"",options:l(P),"max-tag-count":1,size:"medium"},null,8,["value","options"])]),s("div",zt,[v(l(ot),{class:"px-0","formatted-value":b.value,"onUpdate:formattedValue":e[6]||(e[6]=o=>b.value=o),type:"month",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"選擇星期一的日期","value-format":"yyyy-MM","is-date-disabled":L},null,8,["formatted-value"])]),s("div",{class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},[s("button",{type:"button",class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:G}," 搜尋匯出 ")])],2),v(l(st),{class:"mt-5",status:"info",title:"此頁面只供下載EXCEL"})])}}};export{It as default};
