import{_ as J,u as Q,i as V,r as m,o as t,c as s,b as f,d as e,e as u,l as N,v as M,F as $,m as a,n as R,p as W,L as X,q,s as Y,t as Z,k as ee}from"./index-7b4e55c1.js";import{_ as te}from"./OutputExcel-bdbd0611.js";import{N as se}from"./DataTable-48a84b8a.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const _=k=>(Y("data-v-236c78a5"),k=k(),Z(),k),oe={class:"container-fluid px-0"},ae=_(()=>u("div",{class:"row mx-0"},[u("h1",{class:"report-h1 fw-bold"},"營運管理日報")],-1)),le={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},ne=_(()=>u("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"系統別:",-1)),ie={class:"col-md-auto px-0"},ce=_(()=>u("option",{selected:"",disabled:""},"請選擇",-1)),ue=_(()=>u("option",{value:"daily_report_query1"},"1.0",-1)),de=_(()=>u("option",{value:"daily_report_query2"},"2.0",-1)),re=_(()=>u("option",{value:"daily_report_query2E"},"2.0E",-1)),me=[ce,ue,de,re],_e={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},pe=_(()=>u("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"城市:",-1)),ve={class:"col-md-auto px-0"},ye=_(()=>u("option",{selected:"",disabled:""},"請選擇",-1)),he={key:0,selected:"",value:"Taipei"},fe={key:1,selected:"",value:"Newtaipei"},ke={key:2,selected:"",value:"Taoyuan"},ge={key:3,selected:"",value:"Hsinchu"},xe={key:4,selected:"",value:"Miaoli"},De={key:5,selected:"",value:"Taichung"},be={key:0,selected:"",value:"Taipei2"},Ee={key:1,selected:"",value:"Newtaipei2"},we={key:2,selected:"",value:"Taoyuan2"},Ce={key:3,selected:"",value:"Hsinchu2"},He={key:4,selected:"",value:"Hsinchu_Country2"},Te={key:5,value:"HsinchuScience2"},Ne={key:6,selected:"",value:"Miaoli2"},$e={key:7,selected:"",value:"Taichung2"},Se={key:8,selected:"",value:"Chiayi2"},Ve={key:9,selected:"",value:"Chiayi_Country2"},Me={key:10,selected:"",value:"Tainan2"},qe={key:11,selected:"",value:"Kaohsiung2"},Ue={key:12,selected:"",value:"Pingtung2"},Be={key:0,selected:"",value:"Taipei2E"},Ie={key:1,selected:"",value:"Newtaipei2E"},ze={key:2,selected:"",value:"Taoyuan2E"},Le={key:3,selected:"",value:"Hsinchu_Country2E"},Oe={key:4,value:"HsinchuScience2E"},Pe={key:5,selected:"",value:"Miaoli2E"},Fe={key:6,selected:"",value:"Taichung2E"},Ke={key:7,selected:"",value:"Chiayi2E"},je={key:8,selected:"",value:"Chiayi_Country2E"},Ae={key:9,selected:"",value:"Tainan2E"},Ge={key:10,selected:"",value:"Kaohsiung2E"},Je={key:11,selected:"",value:"Pingtung2E"},Qe={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},Re={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},We={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Xe={__name:"OperationDaily",setup(k){const l=Q().citys,S=V("ischange"),U=V("$swal");async function g(o){U({icon:"error",title:`${o}`,showConfirmButton:!1})}const v=m(),y=m(),p=m("請選擇"),h=m("請選擇"),x=m(!1),B=m(null),D=m([{}]),w=m();let C=[],H="",T=[];const I=(o,i,n)=>{C=[],H="",T=[],C=[...o],H=n,i.forEach(c=>{T.push(c.title)})},z=o=>{const i=[];o.forEach((n,c)=>{c===0?i.push({key:`item${c+1}`,align:"center",fixed:"left",title:`${n[2]}`,width:150}):i.push({key:`item${c+1}`,align:"center",title:`${n[2]}`})}),w.value=[...i]},L=o=>{const i=y.value,n=new Date;if(n.setHours(0,0,0,0),i){const c=new Date(i);c.setHours(0,0,0,0);const r=new Date(c);r.setDate(r.getDate()-30);const d=new Date(o);if(d.setHours(0,0,0,0),d<r||d>c||d>=n)return!0}else{const c=new Date(o);if(c.setHours(0,0,0,0),c>=n)return!0}},O=o=>{const i=v.value,n=new Date;if(n.setHours(0,0,0,0),i){const c=new Date(i);if(c.setHours(0,0,0,0),c>n)return!0;const r=new Date(c);r.setDate(r.getDate()+30);const d=new Date(o);if(d.setHours(0,0,0,0),d<c||d>r||d>=n)return!0}else{const c=new Date(o);if(c.setHours(0,0,0,0),c>=n)return!0}},P=async()=>{const o="https://report.youbike.com.tw/isauth/gcpfun",i={dataset_id:"report",table_id:p.value,begin_date:v.value,end_date:y.value,city:[h.value]};try{x.value=!0;const c=(await ee.get(o,{params:i})).data.data;console.log(c),z(c),x.value=!1;let r=c[0].length-2,d=[];for(let b=1;b<=r;b++)d.push({});c.forEach((b,A)=>{b.forEach((G,E)=>{E===0||E===1||E===2||(d[E-3][`item${A+1}`]=G)})}),D.value=[...d],I(D.value,w.value,"營運管理日報")}catch(n){console.log(n)}},F=()=>{if(p.value=="請選擇")return g("請選擇系統");if(h.value=="請選擇")return g("請選擇城市");if(v.value==null)return g("請選擇開始日期");if(y.value==null)return g("請選擇結束日期");P()},K=()=>{v.value=null,y.value=null},j=o=>{if(o.item1==="場站資訊"||o.item1==="租借資訊"||o.item1==="收入資訊"||o.item1==="妥善率資訊"||o.item1==="票卡資訊"||o.item1==="租借資訊"||o.item1==="各時段使用資訊"||o.item1==="租賃收入明細"||o.item1==="當日租借車次"&&!o.item2||o.item1==="營運資訊"||o.item1==="租賃時間使用資訊"||o.item1==="調度管理"||o.item1==="騎乘距離分析"||o.item1==="維護管理"||o.item1==="註冊票卡淨增加數"&&!o.item2&&o.item2!==0)return"too-old"};return(o,i)=>(t(),s("div",oe,[f(e(X),{active:x.value,"onUpdate:active":i[0]||(i[0]=n=>x.value=n),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),ae,u("form",{class:R(["row mx-0",{"report-header":!e(S),"report-header-dark":e(S)}])},[u("div",le,[ne,u("div",ie,[N(u("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":i[1]||(i[1]=n=>p.value=n),onChange:i[2]||(i[2]=n=>h.value="請選擇")},me,544),[[M,p.value]])])]),u("div",_e,[pe,u("div",ve,[N(u("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":i[3]||(i[3]=n=>h.value=n)},[ye,p.value=="daily_report_query1"?(t(),s($,{key:0},[e(l).includes(2)?(t(),s("option",he," 台北市 ")):a("",!0),e(l).includes(3)?(t(),s("option",fe," 新北市 ")):a("",!0),e(l).includes(4)?(t(),s("option",ke," 桃園市 ")):a("",!0),e(l).includes(5)?(t(),s("option",ge," 新竹市 ")):a("",!0),e(l).includes(7)?(t(),s("option",xe," 苗栗縣 ")):a("",!0),e(l).includes(8)?(t(),s("option",De," 台中市 ")):a("",!0)],64)):p.value=="daily_report_query2"?(t(),s($,{key:1},[e(l).includes(2)?(t(),s("option",be," 台北市 ")):a("",!0),e(l).includes(3)?(t(),s("option",Ee," 新北市 ")):a("",!0),e(l).includes(4)?(t(),s("option",we," 桃園市 ")):a("",!0),e(l).includes(5)?(t(),s("option",Ce," 新竹市 ")):a("",!0),e(l).includes(6)?(t(),s("option",He," 新竹縣 ")):a("",!0),e(l).includes(20)?(t(),s("option",Te," 竹科 ")):a("",!0),e(l).includes(7)?(t(),s("option",Ne," 苗栗縣 ")):a("",!0),e(l).includes(8)?(t(),s("option",$e," 台中市 ")):a("",!0),e(l).includes(12)?(t(),s("option",Se," 嘉義市 ")):a("",!0),e(l).includes(13)?(t(),s("option",Ve," 嘉義縣 ")):a("",!0),e(l).includes(14)?(t(),s("option",Me," 台南市 ")):a("",!0),e(l).includes(15)?(t(),s("option",qe," 高雄市 ")):a("",!0),e(l).includes(16)?(t(),s("option",Ue," 屏東縣 ")):a("",!0)],64)):p.value=="daily_report_query2E"?(t(),s($,{key:2},[e(l).includes(2)?(t(),s("option",Be," 台北市 ")):a("",!0),e(l).includes(3)?(t(),s("option",Ie," 新北市 ")):a("",!0),e(l).includes(4)?(t(),s("option",ze," 桃園市 ")):a("",!0),e(l).includes(6)?(t(),s("option",Le," 新竹縣 ")):a("",!0),e(l).includes(20)?(t(),s("option",Oe," 竹科 ")):a("",!0),e(l).includes(7)?(t(),s("option",Pe," 苗栗縣 ")):a("",!0),e(l).includes(8)?(t(),s("option",Fe," 台中市 ")):a("",!0),e(l).includes(12)?(t(),s("option",Ke," 嘉義市 ")):a("",!0),e(l).includes(13)?(t(),s("option",je," 嘉義縣 ")):a("",!0),e(l).includes(14)?(t(),s("option",Ae," 台南市 ")):a("",!0),e(l).includes(15)?(t(),s("option",Ge," 高雄市 ")):a("",!0),e(l).includes(16)?(t(),s("option",Je," 屏東縣 ")):a("",!0)],64)):a("",!0)],512),[[M,h.value]])]),u("div",Qe,[f(e(q),{class:"px-0","formatted-value":v.value,"onUpdate:formattedValue":i[4]||(i[4]=n=>v.value=n),type:"date",actions:null,"input-readonly":!0,"update-value-on-close":!0,"default-time":"2023-06-20",placeholder:"開始日期","value-format":"yyyy-MM-dd","is-date-disabled":L},null,8,["formatted-value"])]),u("div",Re,[f(e(q),{class:"px-0","formatted-value":y.value,"onUpdate:formattedValue":i[5]||(i[5]=n=>y.value=n),type:"date",actions:null,"input-readonly":!0,"is-date-disabled":O,"update-value-on-close":!0,placeholder:"結束日期","value-format":"yyyy-MM-dd"},null,8,["formatted-value"])])]),u("div",We,[u("button",{type:"button",class:"btn btn-info text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:K}," 清空日期 "),u("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:F}," 搜尋 "),f(te,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:e(C),name:e(H),header:e(T)},null,8,["data","name","header"])])],2),N(f(e(se),{ref_key:"dataTable",ref:B,size:"small",columns:w.value,data:D.value,"row-class-name":j,pagination:{pageSize:100},"max-height":600,"scroll-x":1e3,bordered:!1,"single-line":!1,striped:""},null,8,["columns","data"]),[[W,"item2"in D.value[0]]])]))}},at=J(Xe,[["__scopeId","data-v-236c78a5"]]);export{at as default};
