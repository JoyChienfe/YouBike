import{u as $,i as D,r,o,c as s,b,d as e,e as a,k as N,v as P,F as S,l,n as E,s as z,j as F}from"./index-3459458a.js";import{L as I}from"./index-fcaa1a70.js";import{_ as j}from"./OutputExcel-14eb8bfa.js";import{N as H}from"./DatePicker-0f56cdd4.js";import{N as K}from"./DataTable-83b67cc2.js";import"./xlsx-bd534488.js";import"./Forward-c5c87e0a.js";import"./Input-c173e393.js";import"./get-slot-1efb97e5.js";const A={class:"container-fluid px-0"},R=a("div",{class:"row mx-0"},[a("h1",{class:"report-h1 fw-bold"},"電話掛斷通數統計表")],-1),Y={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},q=a("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"系統別:",-1),G={class:"col-md-auto px-0"},J=a("option",{selected:"",disabled:""},"請選擇",-1),O=a("option",{value:"1.0"},"1.0",-1),Q=a("option",{value:"2.0"},"2.0",-1),W=[J,O,Q],X={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Z=a("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"城市:",-1),ee={class:"col-md-auto px-0"},te=a("option",{selected:"",disabled:""},"請選擇",-1),oe={key:0,value:"TP_two"},ae={key:1,value:"NTP_two"},se={key:2,value:"Taoyuan_two"},le={key:3,value:"Hsinchu_two"},ne={key:4,value:"HsinchuCountry"},ie={key:5,value:"Taichung_two"},ce={key:6,value:"Chiayi"},re={key:7,value:"Tainan"},ue={key:8,value:"Kaohsiung"},de={key:9,value:"Pingtung"},me={key:0,value:"NTP_one"},_e={key:1,value:"Taoyuan"},pe={key:2,value:"Miaoli"},ve={key:3,value:"Taichung_one"},he={class:"row px-0 ps-md-4 mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},ye={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Se={__name:"CostumdayReporttelout",setup(fe){const i=$().citys,w=D("ischange"),V=D("$swal");async function y(c){V({icon:"error",title:`${c}`,showConfirmButton:!1})}const f=r(null),m=r("請選擇"),u=r("請選擇"),p=r(!1),v=r([]),h=r(),B=c=>{const t=new Date(c),n=new Date,d=new Date(n.getFullYear(),n.getMonth(),n.getDate());return t<new Date(2023,7,8)||t>=d},T=r([{key:"item1",align:"center",title:"來電號碼"},{key:"item2",align:"center",title:"要求技能"},{key:"item3",align:"center",title:"來電時間"},{key:"item4",align:"center",title:"掛斷時間"},{key:"item5",align:"center",title:"諮詢客服小組"}]);let g=[],k="",x=[];const L=(c,t,n)=>{g=[],k="",x=[],g=[...c],k=n,t.forEach(d=>{x.push(d.title)})},M=async()=>{try{const c="https://report.youbike.com.tw/isauth/gcpfun";let t={dataset_id:"report",table_id:"CTI_hangup_detail",date:h.value,city:m.value,sys:u.value};p.value=!0;const d=(await F.get(c,{params:t})).data.data;console.log(d,t);const C=[];d.forEach(_=>{C.push({item1:_.mobile,item2:_.SKILLS,item3:_.income,item4:_.hang_up,item5:_.PID})}),v.value=[...C],L(v.value,T.value,"電話掛斷通數統計表"),f.value&&f.value.page(1),p.value=!1}catch(c){console.log(c)}},U=async()=>{if(u.value==="請選擇")return y("請選擇系統別");if(m.value==="請選擇")return y("請選擇城市");if(!h.value)return y("請選擇日期");await M()};return(c,t)=>(o(),s("div",A,[b(e(I),{active:p.value,"onUpdate:active":t[0]||(t[0]=n=>p.value=n),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),R,a("form",{class:E(["row mx-0",{"report-header":!e(w),"report-header-dark":e(w)}])},[a("div",Y,[q,a("div",G,[N(a("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":t[1]||(t[1]=n=>u.value=n),onChange:t[2]||(t[2]=n=>m.value="請選擇")},W,544),[[P,u.value]])])]),a("div",X,[Z,a("div",ee,[N(a("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":t[3]||(t[3]=n=>m.value=n)},[te,u.value==2?(o(),s(S,{key:0},[e(i).includes(2)?(o(),s("option",oe," 台北市 ")):l("",!0),e(i).includes(3)?(o(),s("option",ae," 新北市 ")):l("",!0),e(i).includes(4)?(o(),s("option",se," 桃園市 ")):l("",!0),e(i).includes(5)?(o(),s("option",le," 新竹市 ")):l("",!0),e(i).includes(6)?(o(),s("option",ne," 新竹縣 ")):l("",!0),e(i).includes(8)?(o(),s("option",ie," 台中市 ")):l("",!0),e(i).includes(12)?(o(),s("option",ce," 嘉義市 ")):l("",!0),e(i).includes(14)?(o(),s("option",re," 台南市 ")):l("",!0),e(i).includes(15)?(o(),s("option",ue," 高雄市 ")):l("",!0),e(i).includes(16)?(o(),s("option",de," 屏東縣 ")):l("",!0)],64)):u.value==1?(o(),s(S,{key:1},[e(i).includes(3)?(o(),s("option",me," 新北市 ")):l("",!0),e(i).includes(4)?(o(),s("option",_e," 桃園縣 ")):l("",!0),e(i).includes(7)?(o(),s("option",pe," 苗栗縣 ")):l("",!0),e(i).includes(8)?(o(),s("option",ve," 台中市 ")):l("",!0)],64)):l("",!0)],512),[[P,m.value]])]),a("div",he,[b(e(H),{class:"px-0","formatted-value":h.value,"onUpdate:formattedValue":t[4]||(t[4]=n=>h.value=n),type:"date",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"請選擇日期","value-format":"yyyy-MM-dd","is-date-disabled":B},null,8,["formatted-value"])])]),a("div",ye,[a("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:U}," 搜尋 "),b(j,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:e(g),name:e(k),header:e(x)},null,8,["data","name","header"])])],2),v.value.length>=1?(o(),z(e(K),{key:0,ref_key:"dataTable",ref:f,size:"small",pagination:{pageSize:17},columns:T.value,data:v.value,"max-height":600,"scroll-x":700,bordered:!1,"single-line":!1,striped:""},null,8,["columns","data"])):l("",!0)]))}};export{Se as default};
