import{u as L,i as k,r as i,o as T,c as V,b as d,d as n,e as s,n as F,l as P,p as R,L as Y,y as D,q as j,k as q}from"./index-51f79bed.js";import{_ as A}from"./OutputExcel-c7156f1d.js";import{N as G}from"./DataTable-69ff6a12.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const H={class:"container-fluid px-0"},I=s("div",{class:"row mx-0"},[s("h1",{class:"report-h1 fw-bold"}," 借/還車場站排名(前幾名)(每月10號更新資料) ")],-1),J=s("div",{class:"row align-items-center col-md-auto col-12 pe-0"},[s("label",{class:"col-md-auto col-form-label fw-bolder pe-0"},"借/還:")],-1),K={class:"row mx-0 mx-md-2 align-items-center col-md-2 col-12"},O=s("div",{class:"row align-items-center col-md-auto col-12 pe-0"},[s("label",{class:"col-md-auto col-form-label fw-bolder pe-0"},"城市:")],-1),Q={class:"row mx-0 mx-md-2 align-items-center col-md-3 col-12"},W={class:"row col-md-auto col-12 ps-md-0 pe-md-3 mx-auto mx-md-0"},X={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},oe={__name:"ReturncarRanktop",setup(Z){const e=L().citys,y=k("ischange"),r=i(!1),m=i([]),u=i([]),p=i(null),b=i(),c=i([]),N=k("$swal");async function f(t){N({icon:"error",title:`${t}`,showConfirmButton:!1})}const B=[{label:"借",value:"借"},{label:"還",value:"還"}];let v=[{label:"台北市2.0",value:"台北市2.0",disabled:!e.includes(2)},{label:"新北市",value:"新北市",disabled:!e.includes(3)},{label:"新北市2.0",value:"新北市2.0",disabled:!e.includes(3)},{label:"桃園市",value:"桃園市",disabled:!e.includes(4)},{label:"桃園市2.0",value:"桃園市2.0",disabled:!e.includes(4)},{label:"桃園市2.0E",value:"桃園市2.0E",disabled:!e.includes(4)},{label:"新竹市",value:"新竹市",disabled:!e.includes(5)},{label:"新竹市2.0",value:"新竹市2.0",disabled:!e.includes(5)},{label:"新竹市2.0E",value:"新竹市2.0E",disabled:!e.includes(5)},{label:"新竹縣2.0",value:"新竹縣2.0",disabled:!e.includes(6)},{label:"新竹縣2.0E",value:"新竹縣2.0E",disabled:!e.includes(6)},{label:"竹科",value:"竹科",disabled:!e.includes(20)},{label:"竹科2.0",value:"竹科2.0",disabled:!e.includes(20)},{label:"竹科2.0E",value:"竹科2.0E",disabled:!e.includes(20)},{label:"苗栗縣",value:"苗栗縣",disabled:!e.includes(7)},{label:"苗栗縣2.0",value:"苗栗縣2.0",disabled:!e.includes(7)},{label:"苗栗縣2.0E",value:"苗栗縣2.0E",disabled:!e.includes(7)},{label:"台中市",value:"台中市",disabled:!e.includes(8)},{label:"台中市2.0",value:"台中市2.0",disabled:!e.includes(8)},{label:"台中市2.0E",value:"台中市2.0E",disabled:!e.includes(8)},{label:"嘉義市2.0",value:"嘉義市2.0",disabled:!e.includes(12)},{label:"嘉義市2.0E",value:"嘉義市2.0E",disabled:!e.includes(12)},{label:"台南市2.0",value:"台南市2.0",disabled:!e.includes(14)},{label:"台南市2.0E",value:"台南市2.0E",disabled:!e.includes(14)},{label:"高雄市2.0",value:"高雄市2.0",disabled:!e.includes(15)},{label:"高雄市2.0E",value:"高雄市2.0E",disabled:!e.includes(15)},{label:"屏東縣2.0",value:"屏東縣2.0",disabled:!e.includes(16)},{label:"屏東縣2.0E",value:"屏東縣2.0E",disabled:!e.includes(16)}];(function(){let l=[];v.forEach(a=>{a.disabled||l.push(a)}),v=[...l]})();const _=[{key:"num1",align:"center",fixed:"left",title:"名次"},{key:"num2",align:"center",title:"借/還 "},{key:"num3",align:"center",title:"城市"},{key:"num4",align:"center",title:"場站代碼 "},{key:"num5",align:"center",title:"場站名稱",width:250},{key:"num6",align:"center",title:"借車/還車次數"}],z=()=>{let t=[];v.forEach(l=>{t.push(l.value)}),c.value=t},C=t=>{const l=new Date(t),a=l.getFullYear(),o=l.getMonth()+1,w=new Date,E=w.getFullYear(),S=w.getMonth()+1;return a<2023||a>E||a===E&&o>=S};let h=[],g="",x=[];const U=(t,l,a)=>{h=[],g="",x=[],h=[...t],g=a,l.forEach(o=>{x.push(o.title)})},$=async()=>{try{r.value=!0,u.value=[];const t={dataset_id:"marketing_report",table_id:"rent_return_rank_top",item:m.value,city:c.value,date:`${b.value}-01`},l="https://report.youbike.com.tw/isauth/gcpfun";(await q.get(l,{params:t})).data.data.forEach(o=>{u.value.push({num1:o.rank,num2:o.rent_return,num3:o.city,num4:o.station_no,num5:o.station_name,num6:o.times})}),p.value.page&&p.value.page(1),U(u.value,_,"借還車場站排名(前幾名)"),r.value=!1}catch(t){console.log(t)}},M=()=>{if(m.value.length==0)return f("請選擇借/還");if(c.value.length==0)return f("請選擇城市");if(!b.value)return f("請選擇日期");$()};return(t,l)=>(T(),V("div",H,[d(n(Y),{active:r.value,"onUpdate:active":l[0]||(l[0]=a=>r.value=a),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),I,s("form",{class:F(["row mx-0",{"report-header":!n(y),"report-header-dark":n(y)}])},[J,s("div",K,[d(n(D),{class:"px-0",value:m.value,"onUpdate:value":l[1]||(l[1]=a=>m.value=a),placeholder:"請選擇",multiple:"",options:B,"max-tag-count":1,size:"medium"},null,8,["value"])]),O,s("div",Q,[d(n(D),{class:"px-0",value:c.value,"onUpdate:value":l[2]||(l[2]=a=>c.value=a),placeholder:"請選擇",multiple:"",options:n(v),"max-tag-count":1,size:"medium"},null,8,["value","options"])]),s("div",{class:"row col-md-auto col-12 ps-md-0 pe-md-3 mx-auto mx-md-0 mb-3 mb-md-0"},[s("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0",onClick:z}," 城市全選 ")]),s("div",W,[d(n(j),{class:"px-0","formatted-value":b.value,"onUpdate:formattedValue":l[3]||(l[3]=a=>b.value=a),type:"month",actions:null,"input-readonly":!0,"update-value-on-close":!0,placeholder:"請選擇日期","value-format":"yyyy-MM","is-date-disabled":C},null,8,["formatted-value"])]),s("div",X,[s("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:M}," 搜尋 "),d(A,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:n(h),name:n(g),header:n(x)},null,8,["data","name","header"])])],2),P(d(n(G),{size:"small",data:u.value,ref_key:"dataTable",ref:p,columns:_,pagination:{pageSize:17},"max-height":600,"scroll-x":500,bordered:!1,"single-line":!1,striped:""},null,8,["data"]),[[R,u.value.length>1]])]))}};export{oe as default};
