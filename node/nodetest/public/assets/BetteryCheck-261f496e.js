import{i as V,u as A,r as m,o as r,c as d,b as f,d as a,e as c,l as C,v as P,m as i,n as F,p as G,L as I,q as N,k as J}from"./index-3015f284.js";import{_ as K}from"./OutputExcel-98e5e71d.js";import{N as O}from"./DataTable-46950ae5.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const Q={class:"container-fluid px-0"},R=c("div",{class:"row mx-0"},[c("h1",{class:"report-h1 fw-bold"},"2.0E電池狀況查詢")],-1),W={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},X=c("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"城市:",-1),Y={class:"col-md-auto px-0"},Z=c("option",{selected:"",disabled:""},"請選擇",-1),ee={key:0,selected:"",value:"桃園市2.0E"},te={key:1,selected:"",value:"新竹2.0E"},ae={key:2,selected:"",value:"竹縣2.0E"},se={key:3,selected:"",value:"苗栗縣2.0E"},oe={key:4,selected:"",value:"台中市2.0E"},le={key:5,selected:"",value:"嘉義市2.0E"},ne={key:6,selected:"",value:"嘉義縣2.0E"},ce={key:7,selected:"",value:"台南市2.0E"},re={key:8,selected:"",value:"高雄市2.0E"},de={key:9,selected:"",value:"屏東縣2.0E"},ue={class:"row mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},ie={class:"row mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},me={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},De={__name:"BetteryCheck",setup(ve){const H=V("ischange"),u=A().citys,$=V("$swal");async function D(o){$({icon:"error",title:`${o}`,showConfirmButton:!1})}const _=m(!1),h=m([]),v=m(),p=m(),y=m("請選擇"),B=m(null),b=m([]);let E=[],w="",g=[];const M=(o,s,e)=>{E=[],w="",g=[],E=[...o],w=e,s.forEach(t=>{g.push(t.title)})},U=()=>{v.value=null,p.value=null},S=o=>{const s=p.value,e=new Date;if(e.setHours(0,0,0,0),s){const t=new Date(s);t.setHours(0,0,0,0);const l=new Date(t);l.setDate(l.getDate()-30);const n=new Date(o);if(n.setHours(0,0,0,0),n<l||n>t||n>=e)return!0}else{const t=new Date(o);if(t.setHours(0,0,0,0),t>=e)return!0}},z=o=>{const s=v.value,e=new Date;if(e.setHours(0,0,0,0),s){const t=new Date(s);if(t.setHours(0,0,0,0),t>e)return!0;const l=new Date(t);l.setDate(l.getDate()+30);const n=new Date(o);if(n.setHours(0,0,0,0),n<t||n>l||n>=e)return!0}else{const t=new Date(o);if(t.setHours(0,0,0,0),t>=e)return!0}},L=async()=>{try{_.value=!0;const o="https://report.youbike.com.tw/isauth/gcpfun",s={dataset_id:"data_analysis",table_id:"battery_analysis",begin_date:v.value,end_date:p.value,city:y.value},e=await J.get(o,{params:s}),t=e.data.data;console.log(e);const l=[];t[0].forEach((k,x)=>{l.push({key:`item${x+1}`,align:"center",title:k})}),l[0].fixed="left",l[0].width=100,l[1].width=210;let n=[];t.forEach((k,x)=>{x!==0&&(n.push({}),k.forEach((j,q)=>{n[x-1][`item${q+1}`]=j}))}),h.value=[...n],b.value=[...l],M(h.value,b.value,"2.0E電池狀況查詢"),_.value=!1}catch(o){console.log(o)}},T=()=>{if(y.value=="請選擇")return D("請選擇城市");if(v.value){if(!p.value)return D("請選擇結束日期")}else return D("請選擇開始日期");L()};return(o,s)=>(r(),d("div",Q,[f(a(I),{active:_.value,"onUpdate:active":s[0]||(s[0]=e=>_.value=e),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),R,c("form",{class:F(["row mx-0",{"report-header":!a(H),"report-header-dark":a(H)}])},[c("div",W,[X,c("div",Y,[C(c("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":s[1]||(s[1]=e=>y.value=e)},[Z,a(u).includes(4)?(r(),d("option",ee," 桃園市2.0E ")):i("",!0),a(u).includes(5)?(r(),d("option",te," 新竹市2.0E ")):i("",!0),a(u).includes(6)?(r(),d("option",ae," 新竹縣2.0E ")):i("",!0),a(u).includes(7)?(r(),d("option",se," 苗栗縣2.0E ")):i("",!0),a(u).includes(8)?(r(),d("option",oe," 台中市2.0E ")):i("",!0),a(u).includes(12)?(r(),d("option",le," 嘉義市2.0E ")):i("",!0),a(u).includes(13)?(r(),d("option",ne," 嘉義縣2.0E ")):i("",!0),a(u).includes(14)?(r(),d("option",ce," 台南市2.0E ")):i("",!0),a(u).includes(15)?(r(),d("option",re," 高雄市2.0E ")):i("",!0),a(u).includes(16)?(r(),d("option",de," 屏東縣2.0E ")):i("",!0)],512),[[P,y.value]])])]),c("div",ue,[f(a(N),{class:"px-0 mx-0","formatted-value":v.value,"onUpdate:formattedValue":s[2]||(s[2]=e=>v.value=e),type:"date",actions:null,"is-date-disabled":S,"update-value-on-close":"",placeholder:"開始日期","value-format":"yyyy-MM-dd"},null,8,["formatted-value"])]),c("div",ie,[f(a(N),{class:"px-0 mx-0","formatted-value":p.value,"onUpdate:formattedValue":s[3]||(s[3]=e=>p.value=e),type:"date",actions:null,"is-date-disabled":z,"update-value-on-close":"",placeholder:"結束日期","value-format":"yyyy-MM-dd"},null,8,["formatted-value"])]),c("div",me,[c("button",{type:"button",class:"btn btn-info text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:U}," 清空日期 "),c("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:T}," 搜尋 "),f(K,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:a(E),name:a(w),header:a(g)},null,8,["data","name","header"])])],2),C(f(a(O),{ref_key:"dataTable",ref:B,data:h.value,columns:b.value,size:"small",pagination:{pageSize:15},"max-height":600,"scroll-x":1500,bordered:!1,"single-line":!1,striped:""},null,8,["data","columns"]),[[G,h.value.length>0]])]))}};export{De as default};
