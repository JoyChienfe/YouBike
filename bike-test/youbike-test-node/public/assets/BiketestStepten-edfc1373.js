/* empty css             *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                 *//* empty css                  *//* empty css                */import{_ as G}from"./_plugin-vue_export-helper-30db3103.js";import{_ as H}from"./PhotoComponent.vue_vue_type_script_setup_true_lang-f757ad49.js";import{d as O,u as Y,ab as J,r as _,a3 as K,ac as W,c as f,e as r,a as o,w as l,a4 as v,E as X,o as d,ad as Z,ae as ee,h as b,g as te,af as oe,ag as se,i as ae,am as le,k as ne,aj as re,ak as ce,cw as ue,cx as ie,j as de,m as me,an as pe}from"./index-0bfd0be3.js";import{u as _e}from"./bikestest-a2ceefd7.js";import{u as fe}from"./auth-00379faa.js";const k=w=>(oe("data-v-9bc467a4"),w=w(),se(),w),ve={class:"container-fluid"},be=k(()=>r("p",{class:"fs-1 mb-2 text-center"},"模擬體驗",-1)),we={class:"row"},ge={class:"col-12 mb-1"},he={class:"col-12 mb-1"},ye=k(()=>r("br",null,null,-1)),ke=k(()=>r("br",null,null,-1)),xe=k(()=>r("br",null,null,-1)),Se={class:"col-12 mb-1"},Ve={class:"col-12 mb-1"},Ee={class:"col-12 mb-1"},Be={class:"row mx-auto"},De={class:"col-6"},$e={class:"col-6"},qe=O({__name:"BiketestStepten",setup(w){const x=Y(),m=J("$swal");async function q(){return!!(await m({icon:"warning",title:"是否提交表單",showCancelButton:!0,confirmButtonText:"是",cancelButtonText:"否"})).isConfirmed}async function C(){let t;await m({icon:"success",title:"表單送出成功",html:"將導到拍照頁面...",timer:2500,timerProgressBar:!0,didOpen:()=>{m.showLoading(),m.getPopup().querySelector("b")},willClose:()=>{clearInterval(t)}})}async function T(){return!!(await m({icon:"warning",title:"是否需要拍照",showCancelButton:!0,cancelButtonText:"否",confirmButtonText:"是"})).isConfirmed}const E=_(),e=_({catequery:"1.0",startrow:null,endrow:null,text:"",iscodepass:null,checkdata:[{title:"騎乘行進",ischeck:[],value:["行進不順暢","異音"]}]}),A=_({iscodepass:[{required:!0,message:"掃瑪借車不能為空",trigger:"blur"}],startrow:[{required:!0,message:"前胎壓不能為空",trigger:"blur"}],endrow:[{required:!0,message:"後胎壓不能為空",trigger:"blur"}]}),F=()=>{window.scrollTo({top:0,behavior:"smooth"})},a=_e();K(()=>{F(),a.step.step10||x.push("/server/biketest/BiketestStepnine"),a.systum==="1.0"?e.value.catequery="1.0":a.systum==="2.0"?e.value.catequery="2.0":e.value.catequery="2.0E",I()});const I=()=>{const t=a.systum;t==="1.0"?(console.log("現在系統是1.0,賦予資料中..."),console.log("不需要保存資料,因為1.0這是最後一頁")):t==="2.0"?(console.log("現在系統是2.0,賦予資料中..."),console.log("不需要保存資料,因為2.0這是最後一頁")):t==="2.0E"?(console.log("現在系統是2.0E,賦予資料中..."),console.log("不需要保存資料,因為2.0E這是最後一頁")):console.log("現在沒有系統")};function M(){const t=new Date,s=t.getFullYear(),p=String(t.getMonth()+1).padStart(2,"0"),u=String(t.getDate()).padStart(2,"0"),c=String(t.getHours()).padStart(2,"0"),g=String(t.getMinutes()).padStart(2,"0"),i=String(t.getSeconds()).padStart(2,"0");return`${s}-${p}-${u} ${c}:${g}:${i}`}const S=_(!1),B=_({});function R(){S.value=!0}function U(){S.value=!1}function D(){a.clearfrom(),a.clearstep(),x.push("/server/bikesubmit")}const N=fe(),{account:j}=N.getUserid(),P=async t=>{if(t)try{if(await t.validate(),e.value.catequery==="1.0")return;if(e.value.catequery==="2.0")return;if(e.value.catequery==="2.0E"){if(!await q())return;a.testfrom3.騎乘行進=e.value.checkdata[0],a.testfrom3.iscodepass=e.value.iscodepass,a.testfrom3.startrow=e.value.startrow,a.testfrom3.endrow=e.value.endrow,a.testfrom3.text=e.value.text;const p="https://simulation.youbike.com.tw/biketest/biketest",u=a.testfrom3.station_name.split("-"),c={sys:a.systum,user_id:j,edit_id:"",test_date:M(),station_name:`${u[0]}-${u[1]}`,carnum:a.testfrom3.carnum,carnum2:a.testfrom3.carnum2,tablejson:a.testfrom3};if(await ae.post(p,c),await C(),!await T())D();else{const i=new Date,h=i.getMonth()+1,y=i.getDate();B.value={payload:`(${h}-${y})-${a.testfrom3.carnum}`},R()}console.log("送出2.0E")}}catch{console.log("驗證失敗")}};window.addEventListener("beforeunload",function(t){const s="您確定要離開此頁面嗎？您的未保存更改將丟失。";t.returnValue=s,confirm(s)||t.preventDefault()});const Q=()=>{a.step.step10=!1,x.push("/server/biketest/BiketestStepnine")};return(t,s)=>{const p=pe,u=le,c=ne,g=W("QuestionFilled"),i=re,h=ce,y=ue,L=ie,V=de,$=me,z=X;return d(),f(v,null,[r("div",ve,[be,o(z,{"label-width":"120px",size:"large","label-position":"top",model:e.value,ref_key:"formRefAll",ref:E,rules:A.value},{default:l(()=>[r("div",we,[e.value.catequery==="1.0"?(d(),f(v,{key:0},[],64)):e.value.catequery==="2.0"?(d(),f(v,{key:1},[],64)):e.value.catequery==="2.0E"?(d(),f(v,{key:2},[r("div",ge,[o(c,{label:e.value.checkdata[0].title},{default:l(()=>[o(u,{modelValue:e.value.checkdata[0].ischeck,"onUpdate:modelValue":s[0]||(s[0]=n=>e.value.checkdata[0].ischeck=n)},{default:l(()=>[(d(!0),f(v,null,Z(e.value.checkdata[0].value,n=>(d(),ee(p,{key:n,label:n,name:n},null,8,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),r("div",he,[o(h,{class:"box-item",effect:"dark",placement:"top-start"},{content:l(()=>[b(" 此為檢驗QR識別效果，無須測試輸入驗證碼"),ye,b(" 同站借還5分鐘不扣款"),ke,b(" 無法於啟動掃碼（一次）螢幕熄滅內識別QR即為失敗"),xe]),default:l(()=>[o(i,{size:"20",color:"#ADADAD"},{default:l(()=>[o(g)]),_:1})]),_:1}),o(c,{label:"掃碼借車",prop:"iscodepass"},{default:l(()=>[o(L,{modelValue:e.value.iscodepass,"onUpdate:modelValue":s[1]||(s[1]=n=>e.value.iscodepass=n)},{default:l(()=>[o(y,{label:"是"}),o(y,{label:"否"})]),_:1},8,["modelValue"])]),_:1})]),r("div",Se,[o(c,{label:"前胎壓",prop:"startrow"},{default:l(()=>[o(V,{placeholder:"請輸入前胎壓",modelValue:e.value.startrow,"onUpdate:modelValue":s[2]||(s[2]=n=>e.value.startrow=n),type:"number",inputmode:"numeric"},null,8,["modelValue"])]),_:1})]),r("div",Ve,[o(c,{label:"後胎壓",prop:"endrow"},{default:l(()=>[o(V,{placeholder:"請輸入後胎壓",modelValue:e.value.endrow,"onUpdate:modelValue":s[3]||(s[3]=n=>e.value.endrow=n),type:"number",inputmode:"numeric"},null,8,["modelValue"])]),_:1})]),r("div",Ee,[o(c,{label:"備註"},{default:l(()=>[o(V,{type:"textarea",modelValue:e.value.text,"onUpdate:modelValue":s[4]||(s[4]=n=>e.value.text=n)},null,8,["modelValue"])]),_:1})]),r("div",Be,[r("div",De,[o(c,null,{default:l(()=>[o($,{type:"primary",plain:"",class:"col-12",onClick:Q},{default:l(()=>[b("上一步")]),_:1})]),_:1})]),r("div",$e,[o(c,null,{default:l(()=>[o($,{type:"primary",plain:"",class:"col-12",onClick:s[5]||(s[5]=n=>P(E.value))},{default:l(()=>[b("送出")]),_:1})]),_:1})])])],64)):te("",!0)])]),_:1},8,["model","rules"])]),o(H,{centerDialogVisible:S.value,onCloseModal:U,onSubmitFrom:D,"upload-data":B.value},null,8,["centerDialogVisible","upload-data"])],64)}}});const Le=G(qe,[["__scopeId","data-v-9bc467a4"]]);export{Le as default};
