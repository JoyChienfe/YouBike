/* empty css             *//* empty css                     *//* empty css                  *//* empty css                 */import{_ as P}from"./_plugin-vue_export-helper-30db3103.js";/* empty css                    */import{_ as j}from"./PhotoComponent.vue_vue_type_script_setup_true_lang-6f7a4a6e.js";import{d as L,u as R,ab as z,r as _,a3 as G,c as v,e as u,a as l,w as r,a4 as w,E as H,o as m,ad as O,ae as Y,h as V,g as J,af as K,ag as Q,i as W,am as X,k as Z,j as ee,m as te,an as oe}from"./index-62a9fa75.js";import{u as se}from"./bikestest-50d59575.js";import{u as ae}from"./auth-c9b42ca7.js";const le=g=>(K("data-v-f82756ee"),g=g(),Q(),g),ne={class:"container-fluid"},re=le(()=>u("p",{class:"fs-1 mb-2 text-center"},"模擬體驗",-1)),ue={class:"row"},ce={class:"col-12 mb-1"},ie={class:"col-12 mb-1"},de={class:"col-12 mb-1"},me={class:"col-12 mb-1"},pe={class:"row mx-auto"},fe={class:"col-6"},_e={class:"col-6"},ve=L({__name:"BiketestStepten",setup(g){const y=R(),p=z("$swal");async function B(){return!!(await p({icon:"warning",title:"是否提交表單",showCancelButton:!0,confirmButtonText:"是",cancelButtonText:"否"})).isConfirmed}async function E(){let t;await p({icon:"success",title:"表單送出成功",html:"將導到拍照頁面...",timer:2500,timerProgressBar:!0,didOpen:()=>{p.showLoading(),p.getPopup().querySelector("b")},willClose:()=>{clearInterval(t)}})}async function $(){return!!(await p({icon:"warning",title:"是否需要拍照",showCancelButton:!0,cancelButtonText:"否",confirmButtonText:"是"})).isConfirmed}const k=_(),e=_({catequery:"1.0",startrow:null,endrow:null,text:"",iscodepass:null,checkdata:[{title:"騎乘行進",ischeck:[],value:["行進不順暢","異音"]}]}),q=_({iscodepass:[{required:!0,message:"掃瑪借車不能為空",trigger:"blur"}],startrow:[{required:!0,message:"前胎壓不能為空",trigger:"blur"}],endrow:[{required:!0,message:"後胎壓不能為空",trigger:"blur"}]}),C=()=>{window.scrollTo({top:0,behavior:"smooth"})},o=se();G(()=>{C(),o.step.step10||y.push("/server/biketest/BiketestStepnine"),o.systum==="1.0"?e.value.catequery="1.0":o.systum==="2.0"?e.value.catequery="2.0":e.value.catequery="2.0E",D()});const D=()=>{const t=o.systum;t==="1.0"?(console.log("現在系統是1.0,賦予資料中..."),console.log("不需要保存資料,因為1.0這是最後一頁")):t==="2.0"?(console.log("現在系統是2.0,賦予資料中..."),console.log("不需要保存資料,因為2.0這是最後一頁")):t==="2.0E"?(console.log("現在系統是2.0E,賦予資料中..."),console.log("不需要保存資料,因為2.0E這是最後一頁")):console.log("現在沒有系統")};function T(){const t=new Date,s=t.getFullYear(),f=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),n=String(t.getHours()).padStart(2,"0"),d=String(t.getMinutes()).padStart(2,"0"),c=String(t.getSeconds()).padStart(2,"0");return`${s}-${f}-${i} ${n}:${d}:${c}`}const h=_(!1),x=_({});function A(){h.value=!0}function M(){h.value=!1}function S(){o.clearfrom(),o.clearstep(),y.push("/server/bikesubmit")}const F=ae(),{account:I}=F.getUserid(),N=async t=>{if(t)try{if(await t.validate(),e.value.catequery==="1.0")return;if(e.value.catequery==="2.0")return;if(e.value.catequery==="2.0E"){if(!await B())return;o.testfrom3.騎乘行進=e.value.checkdata[0],o.testfrom3.iscodepass=e.value.iscodepass,o.testfrom3.startrow=e.value.startrow,o.testfrom3.endrow=e.value.endrow,o.testfrom3.text=e.value.text;const f="https://simulation.youbike.com.tw/biketest/biketest",i=o.testfrom3.station_name.split("-"),n={sys:o.systum,user_id:I,edit_id:"",test_date:T(),station_name:`${i[0]}-${i[1]}`,carnum:o.testfrom3.carnum,carnum2:o.testfrom3.carnum2,tablejson:o.testfrom3};if(await W.post(f,n),await E(),!await $())S();else{const c=new Date,b=c.getMonth()+1,a=c.getDate();x.value={payload:`(${b}-${a})-${o.testfrom3.carnum}`},A()}console.log("送出2.0E")}}catch{console.log("驗證失敗")}};window.addEventListener("beforeunload",function(t){const s="您確定要離開此頁面嗎？您的未保存更改將丟失。";t.returnValue=s,confirm(s)||t.preventDefault()});const U=()=>{o.step.step10=!1,y.push("/server/biketest/BiketestStepnine")};return(t,s)=>{const f=oe,i=X,n=Z,d=ee,c=te,b=H;return m(),v(w,null,[u("div",ne,[re,l(b,{"label-width":"120px",size:"large","label-position":"top",model:e.value,ref_key:"formRefAll",ref:k,rules:q.value},{default:r(()=>[u("div",ue,[e.value.catequery==="1.0"?(m(),v(w,{key:0},[],64)):e.value.catequery==="2.0"?(m(),v(w,{key:1},[],64)):e.value.catequery==="2.0E"?(m(),v(w,{key:2},[u("div",ce,[l(n,{label:e.value.checkdata[0].title},{default:r(()=>[l(i,{modelValue:e.value.checkdata[0].ischeck,"onUpdate:modelValue":s[0]||(s[0]=a=>e.value.checkdata[0].ischeck=a)},{default:r(()=>[(m(!0),v(w,null,O(e.value.checkdata[0].value,a=>(m(),Y(f,{key:a,label:a,name:a},null,8,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),u("div",ie,[l(n,{label:"前胎壓",prop:"startrow"},{default:r(()=>[l(d,{placeholder:"請輸入前胎壓",modelValue:e.value.startrow,"onUpdate:modelValue":s[1]||(s[1]=a=>e.value.startrow=a),type:"number",inputmode:"numeric"},null,8,["modelValue"])]),_:1})]),u("div",de,[l(n,{label:"後胎壓",prop:"endrow"},{default:r(()=>[l(d,{placeholder:"請輸入後胎壓",modelValue:e.value.endrow,"onUpdate:modelValue":s[2]||(s[2]=a=>e.value.endrow=a),type:"number",inputmode:"numeric"},null,8,["modelValue"])]),_:1})]),u("div",me,[l(n,{label:"備註"},{default:r(()=>[l(d,{type:"textarea",modelValue:e.value.text,"onUpdate:modelValue":s[3]||(s[3]=a=>e.value.text=a)},null,8,["modelValue"])]),_:1})]),u("div",pe,[u("div",fe,[l(n,null,{default:r(()=>[l(c,{type:"primary",plain:"",class:"col-12",onClick:U},{default:r(()=>[V("上一步")]),_:1})]),_:1})]),u("div",_e,[l(n,null,{default:r(()=>[l(c,{type:"primary",plain:"",class:"col-12",onClick:s[4]||(s[4]=a=>N(k.value))},{default:r(()=>[V("送出")]),_:1})]),_:1})])])],64)):J("",!0)])]),_:1},8,["model","rules"])]),l(j,{centerDialogVisible:h.value,onCloseModal:M,onSubmitFrom:S,"upload-data":x.value},null,8,["centerDialogVisible","upload-data"])],64)}}});const Ee=P(ve,[["__scopeId","data-v-f82756ee"]]);export{Ee as default};
