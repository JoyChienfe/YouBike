import{i as H,u as j,r as m,o as t,c as o,b as h,d as e,e as c,l as S,v as N,F as C,m as a,n as q,p as R,L as G,y as I,q as U,k as J}from"./index-a5eda168.js";import{_ as K}from"./OutputExcel-9627298f.js";import{N as O}from"./DataTable-2051144f.js";import"./xlsx-bd534488.js";import"./get-slot-1efb97e5.js";const Q={class:"container-fluid px-0"},W=c("div",{class:"row mx-0"},[c("h1",{class:"report-h1 fw-bold"},"yb2騎乘時間查詢")],-1),X={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Y=c("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"系統別:",-1),Z={class:"col-md-auto px-0"},ee=c("option",{selected:"",disabled:""},"請選擇",-1),te=c("option",{value:"2.0"},"2.0",-1),oe=c("option",{value:"2.0E"},"2.0E",-1),se=[ee,te,oe],ae={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},le=c("label",{class:"col-md-auto col-form-label px-0 px-md-2 fw-bolder"},"城市:",-1),ne={class:"col-md-auto px-0"},ue=c("option",{selected:"",disabled:""},"請選擇",-1),ie={key:0,value:"台北市"},ce={key:1,value:"新北市"},de={key:2,value:"桃園市"},re={key:3,value:"新竹市"},me={key:4,value:"新竹縣"},_e={key:5,value:"竹科"},ve={key:6,value:"苗栗縣"},pe={key:7,value:"台中市"},he={key:8,value:"嘉義市"},ye={key:9,value:"嘉義縣"},fe={key:10,value:"台南市"},ke={key:11,value:"高雄市"},ge={key:12,value:"屏東縣"},xe={key:13,value:"台東縣"},be={key:0,value:"台北市"},De={key:1,value:"新北市"},we={key:2,value:"桃園市"},Se={key:3,value:"新竹市"},Ve={key:4,value:"新竹縣"},Ee={key:5,value:"竹科"},He={key:6,value:"苗栗縣"},Ne={key:7,value:"台中市"},Ce={key:8,value:"嘉義市"},Ue={key:9,value:"嘉義縣"},$e={key:10,value:"台南市"},Me={key:11,value:"高雄市"},ze={key:12,value:"屏東縣"},Ae={key:13,value:"台東縣"},Be=c("div",{class:"row align-items-center col-md-auto col-12 pe-0"},[c("label",{class:"col-md-auto col-form-label fw-bolder pe-0"},"項目:")],-1),Pe={class:"row mx-0 ms-md-2 align-items-center col-md-2 col-12 me-0"},Le={class:"row mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},Te={class:"row mx-0 mx-md-2 align-items-center col-md-auto mt-3 mt-md-0"},Fe={class:"row mx-0 mx-md-2 align-items-center col-md-auto col-12"},Oe={__name:"RidetimeSearch",setup(je){const V=H("ischange"),l=j().citys,$=H("$swal");async function y(d){$({icon:"error",title:`${d}`,showConfirmButton:!1})}const g=m(!1),f=m([]),_=m(),v=m(),k=m("請選擇"),M=m(null),p=m("請選擇"),E=[{key:"num1",align:"center",fixed:"left",width:150,title:"縣市"},{key:"num2",align:"center",title:"鄉鎮市區"},{key:"num3",align:"center",title:"同站／跨站"},{key:"num4",align:"center",title:"費率別"},{key:"num5",align:"center",title:"騎乘時間"},{key:"num6",align:"center",title:"次數"}];let b=[],D="",w=[];const z=(d,i,n)=>{b=[],D="",w=[],b=[...d],D=n,i.forEach(s=>{w.push(s.title)})},A=d=>{const i=v.value,n=new Date;if(n.setHours(0,0,0,0),i){const s=new Date(i);s.setHours(0,0,0,0);const u=new Date(s);u.setDate(u.getDate()-30);const r=new Date(d);if(r.setHours(0,0,0,0),r<u||r>s||r>=n)return!0}else{const s=new Date(d);if(s.setHours(0,0,0,0),s>=n)return!0}},B=d=>{const i=_.value,n=new Date;if(n.setHours(0,0,0,0),i){const s=new Date(i);if(s.setHours(0,0,0,0),s>n)return!0;const u=new Date(s);u.setDate(u.getDate()+30);const r=new Date(d);if(r.setHours(0,0,0,0),r<s||r>u||r>=n)return!0}else{const s=new Date(d);if(s.setHours(0,0,0,0),s>=n)return!0}},P=()=>{_.value=null,v.value=null},L=[{label:"同站借還",value:"同站借還"},{label:"跨站借還",value:"跨站借還"}],x=m([]),T=async()=>{try{g.value=!0,f.value=[];const d="https://report.youbike.com.tw/isauth/gcpfun",i={dataset_id:"report",table_id:"rent_minute_report2",begin_date:_.value,end_date:v.value,city:`${k.value}${p.value}`,item:x.value},n=await J.get(d,{params:i});console.log(n.data.data);let s=[];n.data.data.forEach((u,r)=>{if(r==0){s.push({num1:u.city,num2:u.SxPSArea,num3:u.same_station,num4:u.rate_info,num5:u.rent_minute,num6:u.times});return}s[s.length-1].num2==u.SxPSArea&&s[s.length-1].num3==u.same_station&&s[s.length-1].num4==u.rate_info&&s[s.length-1].num5==u.rent_minute?s[s.length-1].num6+=u.times:s.push({num1:u.city,num2:u.SxPSArea,num3:u.same_station,num4:u.rate_info,num5:u.rent_minute,num6:u.times})}),f.value=[...s],g.value=!1,z(f.value,E,"yb2騎乘時間查詢")}catch(d){console.log(d)}},F=()=>{if(p.value==="請選擇")return y("請選擇系統別");if(k.value=="請選擇")return y("請選擇城市");if(x.value.length===0)return y("請選擇項目");if(_.value){if(!v.value)return y("請選擇結束日期")}else return y("請選擇開始日期");T()};return(d,i)=>(t(),o("div",Q,[h(e(G),{active:g.value,"onUpdate:active":i[0]||(i[0]=n=>g.value=n),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),W,c("form",{class:q(["row mx-0",{"report-header":!e(V),"report-header-dark":e(V)}])},[c("div",X,[Y,c("div",Z,[S(c("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":i[1]||(i[1]=n=>p.value=n),onChange:i[2]||(i[2]=n=>k.value="請選擇")},se,544),[[N,p.value]])])]),c("div",ae,[le,c("div",ne,[S(c("select",{class:"form-select form-select-sm","aria-label":"car","onUpdate:modelValue":i[3]||(i[3]=n=>k.value=n)},[ue,p.value==="2.0"?(t(),o(C,{key:0},[e(l).includes(2)?(t(),o("option",ie,"台北市")):a("",!0),e(l).includes(3)?(t(),o("option",ce,"新北市")):a("",!0),e(l).includes(4)?(t(),o("option",de,"桃園市")):a("",!0),e(l).includes(5)?(t(),o("option",re,"新竹市")):a("",!0),e(l).includes(6)?(t(),o("option",me,"新竹縣")):a("",!0),e(l).includes(20)?(t(),o("option",_e,"竹科")):a("",!0),e(l).includes(7)?(t(),o("option",ve,"苗栗縣")):a("",!0),e(l).includes(8)?(t(),o("option",pe,"台中市")):a("",!0),e(l).includes(12)?(t(),o("option",he,"嘉義市")):a("",!0),e(l).includes(13)?(t(),o("option",ye,"嘉義縣")):a("",!0),e(l).includes(14)?(t(),o("option",fe,"台南市")):a("",!0),e(l).includes(15)?(t(),o("option",ke,"高雄市")):a("",!0),e(l).includes(16)?(t(),o("option",ge,"屏東縣")):a("",!0),e(l).includes(19)?(t(),o("option",xe,"台東縣")):a("",!0)],64)):p.value==="2.0E"?(t(),o(C,{key:1},[e(l).includes(2)?(t(),o("option",be,"台北市")):a("",!0),e(l).includes(3)?(t(),o("option",De,"新北市")):a("",!0),e(l).includes(4)?(t(),o("option",we,"桃園市")):a("",!0),e(l).includes(5)?(t(),o("option",Se,"新竹市")):a("",!0),e(l).includes(6)?(t(),o("option",Ve,"新竹縣")):a("",!0),e(l).includes(20)?(t(),o("option",Ee,"竹科")):a("",!0),e(l).includes(7)?(t(),o("option",He,"苗栗縣")):a("",!0),e(l).includes(8)?(t(),o("option",Ne,"台中市")):a("",!0),e(l).includes(12)?(t(),o("option",Ce,"嘉義市")):a("",!0),e(l).includes(13)?(t(),o("option",Ue,"嘉義縣")):a("",!0),e(l).includes(14)?(t(),o("option",$e,"台南市")):a("",!0),e(l).includes(15)?(t(),o("option",Me,"高雄市")):a("",!0),e(l).includes(16)?(t(),o("option",ze,"屏東縣")):a("",!0),e(l).includes(19)?(t(),o("option",Ae,"台東縣")):a("",!0)],64)):a("",!0)],512),[[N,k.value]])])]),Be,c("div",Pe,[h(e(I),{class:"px-0",value:x.value,"onUpdate:value":i[4]||(i[4]=n=>x.value=n),placeholder:"請選擇",multiple:"",options:L,"max-tag-count":1,size:"medium"},null,8,["value"])]),c("div",Le,[h(e(U),{class:"px-0","formatted-value":_.value,"onUpdate:formattedValue":i[5]||(i[5]=n=>_.value=n),type:"date",actions:null,"is-date-disabled":A,"update-value-on-close":"",placeholder:"開始日期","value-format":"yyyy-MM-dd"},null,8,["formatted-value"])]),c("div",Te,[h(e(U),{class:"px-0","formatted-value":v.value,"onUpdate:formattedValue":i[6]||(i[6]=n=>v.value=n),type:"date",actions:null,"is-date-disabled":B,"update-value-on-close":"",placeholder:"結束日期","value-format":"yyyy-MM-dd"},null,8,["formatted-value"])]),c("div",Fe,[c("button",{type:"button",class:"btn btn-info text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:P}," 清空日期 "),c("button",{type:"button",class:"btn btn-success text-light mt-3 mt-md-0 col-md-auto mx-md-2",onClick:F}," 搜尋 "),h(K,{class:"btn btn-primary text-light mt-3 mt-md-0 col-md-auto mx-md-2",data:e(b),name:e(D),header:e(w)},null,8,["data","name","header"])])],2),S(h(e(O),{ref_key:"dataTable",ref:M,data:f.value,columns:E,size:"small",pagination:{pageSize:17},"max-height":600,"scroll-x":500,bordered:!1,"single-line":!1,striped:""},null,8,["data"]),[[R,f.value.length>0]])]))}};export{Oe as default};
